2021-12-09 13:55:31.945934 (MainThread): Running with dbt=0.21.0
2021-12-09 13:55:31.950796 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'waresix_dbt'
2021-12-09 13:55:31.950886 (MainThread): No profile "waresix_dbt" found, continuing with no target
2021-12-09 13:55:31.979095 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-09 13:55:31.980359 (MainThread): Tracking: do not track
2021-12-09 13:55:31.997320 (MainThread): Warning: No packages were found in packages.yml
2021-12-09 13:55:31.997840 (MainThread): Flushing usage events
2021-12-09 13:56:11.778950 (MainThread): Running with dbt=0.21.0
2021-12-09 13:56:11.871169 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-09 13:56:11.871608 (MainThread): Tracking: tracking
2021-12-09 13:56:11.884983 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530a8e0>]}
2021-12-09 13:56:11.885734 (MainThread): Warning: No packages were found in packages.yml
2021-12-09 13:56:11.886039 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530a8e0>]}
2021-12-09 13:56:11.886240 (MainThread): Flushing usage events
2021-12-09 13:56:23.631981 (MainThread): Running with dbt=0.21.0
2021-12-09 13:56:23.718322 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-12-09 13:56:23.719179 (MainThread): Tracking: tracking
2021-12-09 13:56:23.732591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053128b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053126a0>]}
2021-12-09 13:56:23.746057 (MainThread): Partial parsing not enabled
2021-12-09 13:56:23.771055 (MainThread): Parsing macros/catalog.sql
2021-12-09 13:56:23.775088 (MainThread): Parsing macros/relations.sql
2021-12-09 13:56:23.776523 (MainThread): Parsing macros/adapters.sql
2021-12-09 13:56:23.800240 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-09 13:56:23.801990 (MainThread): Parsing macros/core.sql
2021-12-09 13:56:23.805866 (MainThread): Parsing macros/materializations/test.sql
2021-12-09 13:56:23.813308 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-09 13:56:23.823320 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-09 13:56:23.825014 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-09 13:56:23.843834 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-09 13:56:23.877883 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-09 13:56:23.901674 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-09 13:56:23.903588 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-09 13:56:23.914884 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-09 13:56:23.935849 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-09 13:56:23.950115 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-09 13:56:23.958631 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-09 13:56:23.966320 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-09 13:56:23.970466 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-09 13:56:23.971961 (MainThread): Parsing macros/etc/query.sql
2021-12-09 13:56:23.972917 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-09 13:56:23.974442 (MainThread): Parsing macros/etc/datetime.sql
2021-12-09 13:56:23.983261 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-09 13:56:23.985052 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-09 13:56:23.987494 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-09 13:56:23.989069 (MainThread): Parsing macros/adapters/common.sql
2021-12-09 13:56:24.051819 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-09 13:56:24.053708 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-09 13:56:24.055021 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-09 13:56:24.056481 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-09 13:56:24.256049 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-09 13:56:24.269551 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-09 13:56:24.304121 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:56:24.308512 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:56:24.312391 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:56:24.361171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.363218 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.365484 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.367710 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.370262 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.379723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.389772 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.390054 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.391674 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.393378 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.395300 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.397017 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.398641 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.404520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.406195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.407882 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.409676 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.415762 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.416283 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.417932 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.419608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.425637 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.425896 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:24.441987 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '561ebf60-c7c3-4c4a-b162-4cfd37859264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547b0d0>]}
2021-12-09 13:56:24.449568 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-09 13:56:24.450170 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '561ebf60-c7c3-4c4a-b162-4cfd37859264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547bf10>]}
2021-12-09 13:56:24.450460 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-09 13:56:24.453670 (MainThread): 
2021-12-09 13:56:24.454038 (MainThread): Acquiring new postgres connection "master".
2021-12-09 13:56:24.454905 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-09 13:56:24.464221 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-09 13:56:24.464376 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-09 13:56:24.464487 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-09 13:56:24.643169 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.18 seconds
2021-12-09 13:56:24.644833 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-09 13:56:24.646499 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-09 13:56:24.653080 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-09 13:56:24.653272 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-09 13:56:24.653425 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-09 13:56:24.665448 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:56:24.665658 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-09 13:56:24.665788 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-09 13:56:24.670770 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.00 seconds
2021-12-09 13:56:24.672008 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-09 13:56:24.674071 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-09 13:56:24.678729 (MainThread): Using postgres connection "master".
2021-12-09 13:56:24.678943 (MainThread): On master: BEGIN
2021-12-09 13:56:24.679072 (MainThread): Opening a new connection, currently in state init
2021-12-09 13:56:24.690651 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:56:24.690886 (MainThread): Using postgres connection "master".
2021-12-09 13:56:24.691007 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-09 13:56:25.131376 (MainThread): SQL status: SELECT 0 in 0.44 seconds
2021-12-09 13:56:25.132784 (MainThread): On master: ROLLBACK
2021-12-09 13:56:25.134368 (MainThread): Using postgres connection "master".
2021-12-09 13:56:25.134529 (MainThread): On master: BEGIN
2021-12-09 13:56:25.137337 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-12-09 13:56:25.137535 (MainThread): On master: COMMIT
2021-12-09 13:56:25.137658 (MainThread): Using postgres connection "master".
2021-12-09 13:56:25.137781 (MainThread): On master: COMMIT
2021-12-09 13:56:25.138881 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:56:25.139065 (MainThread): On master: Close
2021-12-09 13:56:25.139419 (MainThread): 20:56:25 | Concurrency: 1 threads (target='dev')
2021-12-09 13:56:25.139583 (MainThread): 20:56:25 | 
2021-12-09 13:56:25.141728 (Thread-1): Began running node seed.waresix_dbt.raw_customers
2021-12-09 13:56:25.142109 (Thread-1): 20:56:25 | 1 of 3 START seed file dbt_local.raw_customers....................... [RUN]
2021-12-09 13:56:25.142483 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_customers".
2021-12-09 13:56:25.142700 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.183067 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.183353 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.183508 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.183784 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-09 13:56:25.183898 (Thread-1): On seed.waresix_dbt.raw_customers: BEGIN
2021-12-09 13:56:25.184006 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:56:25.193230 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:56:25.193443 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-09 13:56:25.193559 (Thread-1): On seed.waresix_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_customers"} */

    create table "postgres"."dbt_local"."raw_customers" (id integer,first_name text,last_name text)
  
2021-12-09 13:56:25.227078 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-12-09 13:56:25.276892 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-09 13:56:25.277099 (Thread-1): On seed.waresix_dbt.raw_customers: 
          insert into "postgres"."dbt_local"."raw_customers" (id, first_name, last_name) values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
2021-12-09 13:56:25.281943 (Thread-1): SQL status: INSERT 0 100 in 0.00 seconds
2021-12-09 13:56:25.286385 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_customers"
2021-12-09 13:56:25.296664 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-09 13:56:25.296822 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-09 13:56:25.296940 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-09 13:56:25.300299 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:56:25.300899 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.301087 (Thread-1): On seed.waresix_dbt.raw_customers: Close
2021-12-09 13:56:25.301562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561ebf60-c7c3-4c4a-b162-4cfd37859264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547b0d0>]}
2021-12-09 13:56:25.302000 (Thread-1): 20:56:25 | 1 of 3 OK loaded seed file dbt_local.raw_customers................... [INSERT 100 in 0.16s]
2021-12-09 13:56:25.302239 (Thread-1): Finished running node seed.waresix_dbt.raw_customers
2021-12-09 13:56:25.302480 (Thread-1): Began running node seed.waresix_dbt.raw_orders
2021-12-09 13:56:25.302854 (Thread-1): 20:56:25 | 2 of 3 START seed file dbt_local.raw_orders.......................... [RUN]
2021-12-09 13:56:25.303179 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_orders".
2021-12-09 13:56:25.303354 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.310945 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.311333 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.311480 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.311613 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.311840 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-09 13:56:25.311946 (Thread-1): On seed.waresix_dbt.raw_orders: BEGIN
2021-12-09 13:56:25.312049 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:56:25.321237 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:56:25.321455 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-09 13:56:25.321572 (Thread-1): On seed.waresix_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_orders"} */

    create table "postgres"."dbt_local"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-12-09 13:56:25.332859 (Thread-1): SQL status: CREATE TABLE in 0.01 seconds
2021-12-09 13:56:25.380098 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-09 13:56:25.380315 (Thread-1): On seed.waresix_dbt.raw_orders: 
          insert into "postgres"."dbt_local"."raw_orders" (id, user_id, order_date, status) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
2021-12-09 13:56:25.383823 (Thread-1): SQL status: INSERT 0 99 in 0.00 seconds
2021-12-09 13:56:25.384248 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_orders"
2021-12-09 13:56:25.385966 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-09 13:56:25.386094 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-09 13:56:25.386193 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-09 13:56:25.389722 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:56:25.390282 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.390459 (Thread-1): On seed.waresix_dbt.raw_orders: Close
2021-12-09 13:56:25.390827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561ebf60-c7c3-4c4a-b162-4cfd37859264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c4040>]}
2021-12-09 13:56:25.391102 (Thread-1): 20:56:25 | 2 of 3 OK loaded seed file dbt_local.raw_orders...................... [INSERT 99 in 0.09s]
2021-12-09 13:56:25.391265 (Thread-1): Finished running node seed.waresix_dbt.raw_orders
2021-12-09 13:56:25.391431 (Thread-1): Began running node seed.waresix_dbt.raw_payments
2021-12-09 13:56:25.391776 (Thread-1): 20:56:25 | 3 of 3 START seed file dbt_local.raw_payments........................ [RUN]
2021-12-09 13:56:25.392088 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_payments".
2021-12-09 13:56:25.392231 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.398831 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.399261 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.399407 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.399756 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:56:25.400015 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-09 13:56:25.400125 (Thread-1): On seed.waresix_dbt.raw_payments: BEGIN
2021-12-09 13:56:25.400232 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:56:25.408905 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:56:25.410180 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-09 13:56:25.411138 (Thread-1): On seed.waresix_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_payments"} */

    create table "postgres"."dbt_local"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-12-09 13:56:25.423676 (Thread-1): SQL status: CREATE TABLE in 0.01 seconds
2021-12-09 13:56:25.474673 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-09 13:56:25.474874 (Thread-1): On seed.waresix_dbt.raw_payments: 
          insert into "postgres"."dbt_local"."raw_payments" (id, order_id, payment_method, amount) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
2021-12-09 13:56:25.478695 (Thread-1): SQL status: INSERT 0 113 in 0.00 seconds
2021-12-09 13:56:25.479149 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_payments"
2021-12-09 13:56:25.480823 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-09 13:56:25.480953 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-09 13:56:25.481053 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-09 13:56:25.484025 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:56:25.484547 (Thread-1): finished collecting timing info
2021-12-09 13:56:25.484716 (Thread-1): On seed.waresix_dbt.raw_payments: Close
2021-12-09 13:56:25.485085 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561ebf60-c7c3-4c4a-b162-4cfd37859264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b53d0>]}
2021-12-09 13:56:25.485357 (Thread-1): 20:56:25 | 3 of 3 OK loaded seed file dbt_local.raw_payments.................... [INSERT 113 in 0.09s]
2021-12-09 13:56:25.485515 (Thread-1): Finished running node seed.waresix_dbt.raw_payments
2021-12-09 13:56:25.486602 (MainThread): Acquiring new postgres connection "master".
2021-12-09 13:56:25.486804 (MainThread): Using postgres connection "master".
2021-12-09 13:56:25.486913 (MainThread): On master: BEGIN
2021-12-09 13:56:25.487017 (MainThread): Opening a new connection, currently in state closed
2021-12-09 13:56:25.503156 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-12-09 13:56:25.503392 (MainThread): On master: COMMIT
2021-12-09 13:56:25.503511 (MainThread): Using postgres connection "master".
2021-12-09 13:56:25.503614 (MainThread): On master: COMMIT
2021-12-09 13:56:25.504795 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:56:25.504977 (MainThread): On master: Close
2021-12-09 13:56:25.505466 (MainThread): 20:56:25 | 
2021-12-09 13:56:25.505804 (MainThread): 20:56:25 | Finished running 3 seeds in 1.05s.
2021-12-09 13:56:25.506266 (MainThread): Connection 'master' was properly closed.
2021-12-09 13:56:25.507033 (MainThread): Connection 'seed.waresix_dbt.raw_payments' was properly closed.
2021-12-09 13:56:25.517423 (MainThread): 
2021-12-09 13:56:25.517644 (MainThread): Completed successfully
2021-12-09 13:56:25.517785 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-09 13:56:25.517976 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054385b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f09d0>]}
2021-12-09 13:56:25.518566 (MainThread): Flushing usage events
2021-12-09 13:57:39.968171 (MainThread): Running with dbt=0.21.0
2021-12-09 13:57:40.058129 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-09 13:57:40.061210 (MainThread): Tracking: tracking
2021-12-09 13:57:40.088151 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e28f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e43b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e59580>]}
2021-12-09 13:57:40.104306 (MainThread): Partial parsing not enabled
2021-12-09 13:57:40.125338 (MainThread): Parsing macros/catalog.sql
2021-12-09 13:57:40.130032 (MainThread): Parsing macros/relations.sql
2021-12-09 13:57:40.131667 (MainThread): Parsing macros/adapters.sql
2021-12-09 13:57:40.166347 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-09 13:57:40.169070 (MainThread): Parsing macros/core.sql
2021-12-09 13:57:40.175942 (MainThread): Parsing macros/materializations/test.sql
2021-12-09 13:57:40.189546 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-09 13:57:40.207027 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-09 13:57:40.209063 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-09 13:57:40.234726 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-09 13:57:40.273862 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-09 13:57:40.301497 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-09 13:57:40.303574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-09 13:57:40.315617 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-09 13:57:40.338419 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-09 13:57:40.355087 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-09 13:57:40.364046 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-09 13:57:40.372547 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-09 13:57:40.377364 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-09 13:57:40.379175 (MainThread): Parsing macros/etc/query.sql
2021-12-09 13:57:40.380264 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-09 13:57:40.381928 (MainThread): Parsing macros/etc/datetime.sql
2021-12-09 13:57:40.391951 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-09 13:57:40.394011 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-09 13:57:40.396721 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-09 13:57:40.398457 (MainThread): Parsing macros/adapters/common.sql
2021-12-09 13:57:40.462058 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-09 13:57:40.464070 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-09 13:57:40.465459 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-09 13:57:40.467017 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-09 13:57:40.669694 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:40.683949 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:40.714388 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:40.718843 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:40.722953 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:40.777454 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.779388 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.781445 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.783595 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.785627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.794256 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.804689 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.804988 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.806678 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.808520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.810585 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.812488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.814410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.820651 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.822480 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.824293 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.826391 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.832420 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.832935 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.834663 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.836520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.842485 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.842774 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-09 13:57:40.860876 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39400>]}
2021-12-09 13:57:40.868665 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-09 13:57:40.869269 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39460>]}
2021-12-09 13:57:40.869518 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-09 13:57:40.872969 (MainThread): 
2021-12-09 13:57:40.873291 (MainThread): Acquiring new postgres connection "master".
2021-12-09 13:57:40.874208 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-09 13:57:40.883744 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-09 13:57:40.883914 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-09 13:57:40.884027 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-09 13:57:41.280287 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.40 seconds
2021-12-09 13:57:41.281689 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-09 13:57:41.283194 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-09 13:57:41.289972 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-09 13:57:41.290172 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-09 13:57:41.290312 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-09 13:57:41.302278 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.302469 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-09 13:57:41.302582 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-09 13:57:41.307601 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2021-12-09 13:57:41.308827 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-09 13:57:41.310164 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-09 13:57:41.314720 (MainThread): Using postgres connection "master".
2021-12-09 13:57:41.314889 (MainThread): On master: BEGIN
2021-12-09 13:57:41.315002 (MainThread): Opening a new connection, currently in state init
2021-12-09 13:57:41.324583 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.324770 (MainThread): Using postgres connection "master".
2021-12-09 13:57:41.324883 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-09 13:57:41.788939 (MainThread): SQL status: SELECT 0 in 0.46 seconds
2021-12-09 13:57:41.790434 (MainThread): On master: ROLLBACK
2021-12-09 13:57:41.791781 (MainThread): Using postgres connection "master".
2021-12-09 13:57:41.791953 (MainThread): On master: BEGIN
2021-12-09 13:57:41.794933 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-12-09 13:57:41.795129 (MainThread): On master: COMMIT
2021-12-09 13:57:41.795254 (MainThread): Using postgres connection "master".
2021-12-09 13:57:41.795361 (MainThread): On master: COMMIT
2021-12-09 13:57:41.796535 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:41.796737 (MainThread): On master: Close
2021-12-09 13:57:41.797072 (MainThread): 20:57:41 | Concurrency: 1 threads (target='dev')
2021-12-09 13:57:41.797228 (MainThread): 20:57:41 | 
2021-12-09 13:57:41.799054 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-09 13:57:41.799360 (Thread-1): 20:57:41 | 1 of 5 START view model dbt_local.stg_customers...................... [RUN]
2021-12-09 13:57:41.799697 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.799909 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-09 13:57:41.802602 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-09 13:57:41.803229 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.830337 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-09 13:57:41.830993 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.831137 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-09 13:57:41.831250 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:57:41.842864 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.843062 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.843212 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */

  create view "postgres"."dbt_local"."stg_customers__dbt_tmp" as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );

2021-12-09 13:57:41.856413 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-12-09 13:57:41.862263 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.862438 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-09 13:57:41.867508 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-09 13:57:41.873994 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-09 13:57:41.874166 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.874274 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-09 13:57:41.877102 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:41.881632 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-09 13:57:41.881795 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop view if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-09 13:57:41.883910 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-12-09 13:57:41.884991 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.885172 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-09 13:57:41.885550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106064ee0>]}
2021-12-09 13:57:41.885892 (Thread-1): 20:57:41 | 1 of 5 OK created view model dbt_local.stg_customers................. [CREATE VIEW in 0.09s]
2021-12-09 13:57:41.886051 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-09 13:57:41.886206 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-09 13:57:41.886579 (Thread-1): 20:57:41 | 2 of 5 START view model dbt_local.stg_orders......................... [RUN]
2021-12-09 13:57:41.887021 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.887310 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-09 13:57:41.889600 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-09 13:57:41.890004 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.892158 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-09 13:57:41.892575 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.892704 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-09 13:57:41.892815 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:57:41.902000 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.902199 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.902326 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */

  create view "postgres"."dbt_local"."stg_orders__dbt_tmp" as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );

2021-12-09 13:57:41.904910 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-12-09 13:57:41.907869 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.908163 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-09 13:57:41.909725 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-09 13:57:41.910800 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-09 13:57:41.910947 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.911126 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-09 13:57:41.914054 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:41.915645 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-09 13:57:41.915811 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop view if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-09 13:57:41.917414 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-12-09 13:57:41.918508 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.918693 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-09 13:57:41.919048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514c4c0>]}
2021-12-09 13:57:41.919382 (Thread-1): 20:57:41 | 2 of 5 OK created view model dbt_local.stg_orders.................... [CREATE VIEW in 0.03s]
2021-12-09 13:57:41.919539 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-09 13:57:41.919693 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-09 13:57:41.920037 (Thread-1): 20:57:41 | 3 of 5 START view model dbt_local.stg_payments....................... [RUN]
2021-12-09 13:57:41.920381 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.920539 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-09 13:57:41.922863 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-09 13:57:41.923302 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.925359 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-09 13:57:41.925791 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.925914 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-09 13:57:41.926021 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:57:41.935528 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.935726 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.935844 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */

  create view "postgres"."dbt_local"."stg_payments__dbt_tmp" as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );

2021-12-09 13:57:41.941669 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-12-09 13:57:41.943727 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.943884 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-09 13:57:41.945619 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-09 13:57:41.947301 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-09 13:57:41.947592 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.947756 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-09 13:57:41.949635 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:41.952126 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-09 13:57:41.952288 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop view if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-09 13:57:41.954046 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-12-09 13:57:41.955118 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.955307 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-09 13:57:41.955691 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d4070>]}
2021-12-09 13:57:41.956166 (Thread-1): 20:57:41 | 3 of 5 OK created view model dbt_local.stg_payments.................. [CREATE VIEW in 0.04s]
2021-12-09 13:57:41.956344 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-09 13:57:41.957116 (Thread-1): Began running node model.waresix_dbt.customers
2021-12-09 13:57:41.957482 (Thread-1): 20:57:41 | 4 of 5 START view model dbt_local.customers.......................... [RUN]
2021-12-09 13:57:41.957907 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.958092 (Thread-1): Compiling model.waresix_dbt.customers
2021-12-09 13:57:41.961424 (Thread-1): Writing injected SQL for node "model.waresix_dbt.customers"
2021-12-09 13:57:41.961843 (Thread-1): finished collecting timing info
2021-12-09 13:57:41.964604 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.customers"
2021-12-09 13:57:41.965156 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.965300 (Thread-1): On model.waresix_dbt.customers: BEGIN
2021-12-09 13:57:41.965415 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:57:41.976718 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:41.976917 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.977027 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */

  create view "postgres"."dbt_local"."customers__dbt_tmp" as (
    with customers as (

    select * from "postgres"."dbt_local"."stg_customers"

),

orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );

2021-12-09 13:57:41.990157 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-12-09 13:57:41.992428 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.992591 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
alter table "postgres"."dbt_local"."customers__dbt_tmp" rename to "customers"
2021-12-09 13:57:41.994234 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-09 13:57:41.995401 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-09 13:57:41.995566 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.995693 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-09 13:57:41.998271 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:41.999722 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-09 13:57:41.999880 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
drop view if exists "postgres"."dbt_local"."customers__dbt_backup" cascade
2021-12-09 13:57:42.001406 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-12-09 13:57:42.002648 (Thread-1): finished collecting timing info
2021-12-09 13:57:42.002846 (Thread-1): On model.waresix_dbt.customers: Close
2021-12-09 13:57:42.003243 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060be910>]}
2021-12-09 13:57:42.003856 (Thread-1): 20:57:42 | 4 of 5 OK created view model dbt_local.customers..................... [CREATE VIEW in 0.05s]
2021-12-09 13:57:42.004062 (Thread-1): Finished running node model.waresix_dbt.customers
2021-12-09 13:57:42.004310 (Thread-1): Began running node model.waresix_dbt.orders
2021-12-09 13:57:42.004669 (Thread-1): 20:57:42 | 5 of 5 START view model dbt_local.orders............................. [RUN]
2021-12-09 13:57:42.005024 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.005183 (Thread-1): Compiling model.waresix_dbt.orders
2021-12-09 13:57:42.010822 (Thread-1): Writing injected SQL for node "model.waresix_dbt.orders"
2021-12-09 13:57:42.011948 (Thread-1): finished collecting timing info
2021-12-09 13:57:42.015193 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.orders"
2021-12-09 13:57:42.015909 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.016128 (Thread-1): On model.waresix_dbt.orders: BEGIN
2021-12-09 13:57:42.016295 (Thread-1): Opening a new connection, currently in state closed
2021-12-09 13:57:42.028370 (Thread-1): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:42.028568 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.028682 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */

  create view "postgres"."dbt_local"."orders__dbt_tmp" as (
    

with orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );

2021-12-09 13:57:42.035744 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2021-12-09 13:57:42.038019 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.038181 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
alter table "postgres"."dbt_local"."orders__dbt_tmp" rename to "orders"
2021-12-09 13:57:42.040576 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-09 13:57:42.041849 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-09 13:57:42.042017 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.042125 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-09 13:57:42.044754 (Thread-1): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:42.046214 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-09 13:57:42.046363 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
drop view if exists "postgres"."dbt_local"."orders__dbt_backup" cascade
2021-12-09 13:57:42.047553 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-12-09 13:57:42.048660 (Thread-1): finished collecting timing info
2021-12-09 13:57:42.049029 (Thread-1): On model.waresix_dbt.orders: Close
2021-12-09 13:57:42.049516 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69409cd-2694-4d9c-8ceb-937bab337201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cf1f0>]}
2021-12-09 13:57:42.049864 (Thread-1): 20:57:42 | 5 of 5 OK created view model dbt_local.orders........................ [CREATE VIEW in 0.04s]
2021-12-09 13:57:42.050025 (Thread-1): Finished running node model.waresix_dbt.orders
2021-12-09 13:57:42.050949 (MainThread): Acquiring new postgres connection "master".
2021-12-09 13:57:42.051145 (MainThread): Using postgres connection "master".
2021-12-09 13:57:42.051257 (MainThread): On master: BEGIN
2021-12-09 13:57:42.051364 (MainThread): Opening a new connection, currently in state closed
2021-12-09 13:57:42.060970 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-09 13:57:42.061176 (MainThread): On master: COMMIT
2021-12-09 13:57:42.061299 (MainThread): Using postgres connection "master".
2021-12-09 13:57:42.061404 (MainThread): On master: COMMIT
2021-12-09 13:57:42.062667 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-09 13:57:42.062868 (MainThread): On master: Close
2021-12-09 13:57:42.063255 (MainThread): 20:57:42 | 
2021-12-09 13:57:42.063476 (MainThread): 20:57:42 | Finished running 5 view models in 1.19s.
2021-12-09 13:57:42.063695 (MainThread): Connection 'master' was properly closed.
2021-12-09 13:57:42.063851 (MainThread): Connection 'model.waresix_dbt.orders' was properly closed.
2021-12-09 13:57:42.071587 (MainThread): 
2021-12-09 13:57:42.071773 (MainThread): Completed successfully
2021-12-09 13:57:42.072002 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-09 13:57:42.072419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e28f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e59580>]}
2021-12-09 13:57:42.072700 (MainThread): Flushing usage events
2021-12-10 01:49:04.815407 (MainThread): Running with dbt=0.21.0
2021-12-10 01:49:05.061915 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 01:49:05.065153 (MainThread): Tracking: tracking
2021-12-10 01:49:05.107850 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c450d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c473a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c489460>]}
2021-12-10 01:49:05.145756 (MainThread): Partial parsing not enabled
2021-12-10 01:49:05.208332 (MainThread): Parsing macros/catalog.sql
2021-12-10 01:49:05.218907 (MainThread): Parsing macros/relations.sql
2021-12-10 01:49:05.223559 (MainThread): Parsing macros/adapters.sql
2021-12-10 01:49:05.303451 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 01:49:05.308788 (MainThread): Parsing macros/core.sql
2021-12-10 01:49:05.321124 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 01:49:05.347056 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 01:49:05.379353 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 01:49:05.384976 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 01:49:05.454906 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 01:49:05.648665 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 01:49:05.749099 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 01:49:05.756702 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 01:49:05.794046 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 01:49:05.861434 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 01:49:05.907410 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 01:49:05.932947 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 01:49:05.956650 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 01:49:05.970362 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 01:49:05.976105 (MainThread): Parsing macros/etc/query.sql
2021-12-10 01:49:05.979669 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 01:49:05.985478 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 01:49:06.014460 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 01:49:06.021493 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 01:49:06.030817 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 01:49:06.035763 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 01:49:06.229931 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 01:49:06.235121 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 01:49:06.238983 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 01:49:06.243603 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 01:49:06.969376 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:07.012363 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:07.094933 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:07.106975 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:07.117706 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:07.274056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.279665 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.286155 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.292057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.297350 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.324079 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.355202 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.356513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.362252 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.367567 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.373658 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.379061 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.384350 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.406124 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.411471 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.417016 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.422585 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.441714 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.442523 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.448195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.453534 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.471205 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.474051 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:49:07.526071 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c437eb0>]}
2021-12-10 01:49:07.546922 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 01:49:07.548744 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5d2eb0>]}
2021-12-10 01:49:07.549605 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 01:49:07.564757 (MainThread): 
2021-12-10 01:49:07.565886 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:49:07.569007 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 01:49:07.617046 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 01:49:07.617708 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 01:49:07.618188 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 01:49:08.147815 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.53 seconds
2021-12-10 01:49:08.151303 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 01:49:08.155990 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 01:49:08.174362 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:49:08.174818 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 01:49:08.175155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 01:49:08.228339 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:49:08.228838 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:49:08.229159 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 01:49:08.266493 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.04 seconds
2021-12-10 01:49:08.270238 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 01:49:08.273721 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 01:49:08.287115 (MainThread): Using postgres connection "master".
2021-12-10 01:49:08.287572 (MainThread): On master: BEGIN
2021-12-10 01:49:08.287904 (MainThread): Opening a new connection, currently in state init
2021-12-10 01:49:08.318301 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:49:08.318812 (MainThread): Using postgres connection "master".
2021-12-10 01:49:08.319145 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 01:49:10.604284 (MainThread): SQL status: SELECT 8 in 2.28 seconds
2021-12-10 01:49:10.608134 (MainThread): On master: ROLLBACK
2021-12-10 01:49:10.613396 (MainThread): Using postgres connection "master".
2021-12-10 01:49:10.613854 (MainThread): On master: BEGIN
2021-12-10 01:49:10.621200 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 01:49:10.621685 (MainThread): On master: COMMIT
2021-12-10 01:49:10.622039 (MainThread): Using postgres connection "master".
2021-12-10 01:49:10.622339 (MainThread): On master: COMMIT
2021-12-10 01:49:10.627037 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 01:49:10.627618 (MainThread): On master: Close
2021-12-10 01:49:10.628621 (MainThread): 08:49:10 | Concurrency: 1 threads (target='dev')
2021-12-10 01:49:10.629148 (MainThread): 08:49:10 | 
2021-12-10 01:49:10.637298 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-10 01:49:10.638180 (Thread-1): 08:49:10 | 1 of 5 START table model dbt_local.stg_customers..................... [RUN]
2021-12-10 01:49:10.639163 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.639802 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-10 01:49:10.654318 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 01:49:10.656832 (Thread-1): finished collecting timing info
2021-12-10 01:49:10.757407 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 01:49:10.759221 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.759910 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-10 01:49:10.760381 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:49:10.801985 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:49:10.802540 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.802885 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */


  create  table "postgres"."dbt_local"."stg_customers__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
2021-12-10 01:49:10.900358 (Thread-1): SQL status: SELECT 100 in 0.10 seconds
2021-12-10 01:49:10.917443 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.917888 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers" rename to "stg_customers__dbt_backup"
2021-12-10 01:49:10.928150 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 01:49:10.933904 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.934492 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-10 01:49:10.939354 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:49:10.971551 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 01:49:10.972032 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.972367 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 01:49:10.984981 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:10.997091 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:49:10.997497 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop view if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-10 01:49:11.051177 (Thread-1): SQL status: DROP VIEW in 0.05 seconds
2021-12-10 01:49:11.054044 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.054519 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-10 01:49:11.055527 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66daf0>]}
2021-12-10 01:49:11.056591 (Thread-1): 08:49:11 | 1 of 5 OK created table model dbt_local.stg_customers................ [SELECT 100 in 0.42s]
2021-12-10 01:49:11.057181 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-10 01:49:11.057673 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-10 01:49:11.058699 (Thread-1): 08:49:11 | 2 of 5 START table model dbt_local.stg_orders........................ [RUN]
2021-12-10 01:49:11.059635 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.060175 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-10 01:49:11.068198 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 01:49:11.069697 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.077304 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 01:49:11.078764 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.080023 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-10 01:49:11.081711 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:49:11.128001 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:49:11.128496 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.128823 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */


  create  table "postgres"."dbt_local"."stg_orders__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
2021-12-10 01:49:11.148290 (Thread-1): SQL status: SELECT 99 in 0.02 seconds
2021-12-10 01:49:11.154009 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.154402 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders" rename to "stg_orders__dbt_backup"
2021-12-10 01:49:11.159028 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:49:11.164855 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.165278 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-10 01:49:11.170026 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:49:11.173265 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 01:49:11.173692 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.174024 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 01:49:11.188045 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:11.194819 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:49:11.195267 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop view if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-10 01:49:11.214612 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2021-12-10 01:49:11.217651 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.218168 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-10 01:49:11.219648 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7257f0>]}
2021-12-10 01:49:11.220940 (Thread-1): 08:49:11 | 2 of 5 OK created table model dbt_local.stg_orders................... [SELECT 99 in 0.16s]
2021-12-10 01:49:11.221404 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-10 01:49:11.221959 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-10 01:49:11.223190 (Thread-1): 08:49:11 | 3 of 5 START table model dbt_local.stg_payments...................... [RUN]
2021-12-10 01:49:11.224291 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.225339 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-10 01:49:11.239485 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 01:49:11.241700 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.252480 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 01:49:11.256344 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.257027 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-10 01:49:11.257435 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:49:11.289029 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:49:11.289566 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.289898 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */


  create  table "postgres"."dbt_local"."stg_payments__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
2021-12-10 01:49:11.314373 (Thread-1): SQL status: SELECT 113 in 0.02 seconds
2021-12-10 01:49:11.320607 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.321052 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments" rename to "stg_payments__dbt_backup"
2021-12-10 01:49:11.326311 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:49:11.331772 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.332180 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-10 01:49:11.337994 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 01:49:11.341401 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 01:49:11.341856 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.342204 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 01:49:11.351606 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:11.355539 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:49:11.355906 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop view if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-10 01:49:11.362617 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2021-12-10 01:49:11.365446 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.365925 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-10 01:49:11.367133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c72d6a0>]}
2021-12-10 01:49:11.368136 (Thread-1): 08:49:11 | 3 of 5 OK created table model dbt_local.stg_payments................. [SELECT 113 in 0.14s]
2021-12-10 01:49:11.368592 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-10 01:49:11.370186 (Thread-1): Began running node model.waresix_dbt.customers
2021-12-10 01:49:11.371393 (Thread-1): 08:49:11 | 4 of 5 START table model dbt_local.customers......................... [RUN]
2021-12-10 01:49:11.372745 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.373207 (Thread-1): Compiling model.waresix_dbt.customers
2021-12-10 01:49:11.381435 (Thread-1): Writing injected SQL for node "model.waresix_dbt.customers"
2021-12-10 01:49:11.382716 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.392431 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.customers"
2021-12-10 01:49:11.393750 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.394132 (Thread-1): On model.waresix_dbt.customers: BEGIN
2021-12-10 01:49:11.394457 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:49:11.431399 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:49:11.432095 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.432644 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */


  create  table "postgres"."dbt_local"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "postgres"."dbt_local"."stg_customers"

),

orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
2021-12-10 01:49:11.464393 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-12-10 01:49:11.470812 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.471260 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
alter table "postgres"."dbt_local"."customers__dbt_tmp" rename to "customers"
2021-12-10 01:49:11.477814 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 01:49:11.481064 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 01:49:11.481450 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.481760 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 01:49:11.496251 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:11.500051 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:49:11.500420 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
drop table if exists "postgres"."dbt_local"."customers__dbt_backup" cascade
2021-12-10 01:49:11.508061 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 01:49:11.511063 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.511573 (Thread-1): On model.waresix_dbt.customers: Close
2021-12-10 01:49:11.512528 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c73f820>]}
2021-12-10 01:49:11.513519 (Thread-1): 08:49:11 | 4 of 5 OK created table model dbt_local.customers.................... [SELECT 100 in 0.14s]
2021-12-10 01:49:11.513987 (Thread-1): Finished running node model.waresix_dbt.customers
2021-12-10 01:49:11.514459 (Thread-1): Began running node model.waresix_dbt.orders
2021-12-10 01:49:11.515425 (Thread-1): 08:49:11 | 5 of 5 START table model dbt_local.orders............................ [RUN]
2021-12-10 01:49:11.516320 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.516734 (Thread-1): Compiling model.waresix_dbt.orders
2021-12-10 01:49:11.530031 (Thread-1): Writing injected SQL for node "model.waresix_dbt.orders"
2021-12-10 01:49:11.531441 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.538393 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.orders"
2021-12-10 01:49:11.542441 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.542916 (Thread-1): On model.waresix_dbt.orders: BEGIN
2021-12-10 01:49:11.543259 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:49:11.579144 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:49:11.579651 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.579978 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */


  create  table "postgres"."dbt_local"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
2021-12-10 01:49:11.606554 (Thread-1): SQL status: SELECT 99 in 0.03 seconds
2021-12-10 01:49:11.612876 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.613327 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
alter table "postgres"."dbt_local"."orders__dbt_tmp" rename to "orders"
2021-12-10 01:49:11.618043 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:49:11.621320 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 01:49:11.621717 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.622032 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 01:49:11.636626 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:11.640743 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:49:11.641211 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
drop table if exists "postgres"."dbt_local"."orders__dbt_backup" cascade
2021-12-10 01:49:11.646258 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 01:49:11.649109 (Thread-1): finished collecting timing info
2021-12-10 01:49:11.649606 (Thread-1): On model.waresix_dbt.orders: Close
2021-12-10 01:49:11.650954 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cc16aa-d3f4-46ca-a426-9f3ddadc294f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7257f0>]}
2021-12-10 01:49:11.652178 (Thread-1): 08:49:11 | 5 of 5 OK created table model dbt_local.orders....................... [SELECT 99 in 0.13s]
2021-12-10 01:49:11.652801 (Thread-1): Finished running node model.waresix_dbt.orders
2021-12-10 01:49:11.658349 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:49:11.659549 (MainThread): Using postgres connection "master".
2021-12-10 01:49:11.660199 (MainThread): On master: BEGIN
2021-12-10 01:49:11.660865 (MainThread): Opening a new connection, currently in state closed
2021-12-10 01:49:11.737837 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-10 01:49:11.739296 (MainThread): On master: COMMIT
2021-12-10 01:49:11.739950 (MainThread): Using postgres connection "master".
2021-12-10 01:49:11.740407 (MainThread): On master: COMMIT
2021-12-10 01:49:11.750181 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:49:11.752804 (MainThread): On master: Close
2021-12-10 01:49:11.756065 (MainThread): 08:49:11 | 
2021-12-10 01:49:11.757470 (MainThread): 08:49:11 | Finished running 5 table models in 4.19s.
2021-12-10 01:49:11.758410 (MainThread): Connection 'master' was properly closed.
2021-12-10 01:49:11.759014 (MainThread): Connection 'model.waresix_dbt.orders' was properly closed.
2021-12-10 01:49:11.802305 (MainThread): 
2021-12-10 01:49:11.805023 (MainThread): Completed successfully
2021-12-10 01:49:11.806830 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-10 01:49:11.809120 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c437eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7294f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7299d0>]}
2021-12-10 01:49:11.810416 (MainThread): Flushing usage events
2021-12-10 01:50:59.971872 (MainThread): Running with dbt=0.21.0
2021-12-10 01:51:00.215363 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=False, warn_error=False, which='seed', write_json=True)
2021-12-10 01:51:00.218781 (MainThread): Tracking: tracking
2021-12-10 01:51:00.255855 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11343af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11344d6a0>]}
2021-12-10 01:51:00.291512 (MainThread): Partial parsing not enabled
2021-12-10 01:51:00.354302 (MainThread): Parsing macros/catalog.sql
2021-12-10 01:51:00.364891 (MainThread): Parsing macros/relations.sql
2021-12-10 01:51:00.369152 (MainThread): Parsing macros/adapters.sql
2021-12-10 01:51:00.442366 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 01:51:00.447758 (MainThread): Parsing macros/core.sql
2021-12-10 01:51:00.460021 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 01:51:00.487797 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 01:51:00.531508 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 01:51:00.539509 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 01:51:00.646142 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 01:51:00.787579 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 01:51:00.867470 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 01:51:00.873066 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 01:51:00.907823 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 01:51:00.976922 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 01:51:01.028786 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 01:51:01.058159 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 01:51:01.082015 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 01:51:01.094961 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 01:51:01.100362 (MainThread): Parsing macros/etc/query.sql
2021-12-10 01:51:01.103473 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 01:51:01.108197 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 01:51:01.136553 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 01:51:01.142944 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 01:51:01.152310 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 01:51:01.157762 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 01:51:01.340790 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 01:51:01.346162 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 01:51:01.350141 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 01:51:01.354837 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 01:51:02.006400 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:02.053316 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:02.127313 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:02.138541 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:02.149188 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:02.308315 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.314435 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.320987 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.326720 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.332161 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.357120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.389426 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.390292 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.395443 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.401307 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.407663 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.413106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.418769 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.437185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.443118 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.448911 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.454865 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.472834 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.474375 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.479449 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.485273 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.504017 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.504880 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:02.559009 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d9fc0ab-d58c-49c0-b0e9-bd3b2a07006d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133eef10>]}
2021-12-10 01:51:02.583028 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 01:51:02.584885 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d9fc0ab-d58c-49c0-b0e9-bd3b2a07006d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133fb0a0>]}
2021-12-10 01:51:02.585816 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 01:51:02.605289 (MainThread): 
2021-12-10 01:51:02.608603 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:51:02.613320 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 01:51:02.681554 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 01:51:02.682474 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 01:51:02.683462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 01:51:03.065224 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.38 seconds
2021-12-10 01:51:03.068978 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 01:51:03.071390 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 01:51:03.072939 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 01:51:03.073537 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."dbt_local""
2021-12-10 01:51:03.090213 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 01:51:03.090747 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: BEGIN
2021-12-10 01:51:03.091104 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-10 01:51:03.126144 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:51:03.126819 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 01:51:03.127204 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "create_postgres_dbt_local"} */
create schema if not exists "dbt_local"
2021-12-10 01:51:03.142385 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.01 seconds
2021-12-10 01:51:03.144735 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 01:51:03.145380 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 01:51:03.145735 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 01:51:03.153300 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:03.153935 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: Close
2021-12-10 01:51:03.158990 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:03.176395 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:03.176869 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 01:51:03.177212 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 01:51:03.223020 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:51:03.223706 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:03.224058 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 01:51:03.236618 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2021-12-10 01:51:03.239731 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 01:51:03.244407 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 01:51:03.263690 (MainThread): Using postgres connection "master".
2021-12-10 01:51:03.264163 (MainThread): On master: BEGIN
2021-12-10 01:51:03.264509 (MainThread): Opening a new connection, currently in state init
2021-12-10 01:51:03.299483 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:51:03.300139 (MainThread): Using postgres connection "master".
2021-12-10 01:51:03.300481 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 01:51:04.890829 (MainThread): SQL status: SELECT 0 in 1.59 seconds
2021-12-10 01:51:04.894771 (MainThread): On master: ROLLBACK
2021-12-10 01:51:04.900934 (MainThread): Using postgres connection "master".
2021-12-10 01:51:04.901412 (MainThread): On master: BEGIN
2021-12-10 01:51:04.914587 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 01:51:04.915183 (MainThread): On master: COMMIT
2021-12-10 01:51:04.915575 (MainThread): Using postgres connection "master".
2021-12-10 01:51:04.916327 (MainThread): On master: COMMIT
2021-12-10 01:51:04.920163 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 01:51:04.920755 (MainThread): On master: Close
2021-12-10 01:51:04.921962 (MainThread): 08:51:04 | Concurrency: 1 threads (target='dev')
2021-12-10 01:51:04.922432 (MainThread): 08:51:04 | 
2021-12-10 01:51:04.929626 (Thread-1): Began running node seed.waresix_dbt.raw_customers
2021-12-10 01:51:04.930762 (Thread-1): 08:51:04 | 1 of 3 START seed file dbt_local.raw_customers....................... [RUN]
2021-12-10 01:51:04.932060 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 01:51:04.932604 (Thread-1): finished collecting timing info
2021-12-10 01:51:05.098129 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.100090 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.100912 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.101775 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 01:51:05.102156 (Thread-1): On seed.waresix_dbt.raw_customers: BEGIN
2021-12-10 01:51:05.102511 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:05.147924 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:51:05.148636 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 01:51:05.149325 (Thread-1): On seed.waresix_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_customers"} */

    create table "postgres"."dbt_local"."raw_customers" (id integer,first_name text,last_name text)
  
2021-12-10 01:51:05.187668 (Thread-1): SQL status: CREATE TABLE in 0.04 seconds
2021-12-10 01:51:05.393650 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 01:51:05.394135 (Thread-1): On seed.waresix_dbt.raw_customers: 
          insert into "postgres"."dbt_local"."raw_customers" (id, first_name, last_name) values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
2021-12-10 01:51:05.403381 (Thread-1): SQL status: INSERT 0 100 in 0.01 seconds
2021-12-10 01:51:05.417049 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_customers"
2021-12-10 01:51:05.455587 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 01:51:05.456334 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 01:51:05.457240 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 01:51:05.473213 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 01:51:05.475512 (Thread-1): finished collecting timing info
2021-12-10 01:51:05.476417 (Thread-1): On seed.waresix_dbt.raw_customers: Close
2021-12-10 01:51:05.478107 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d9fc0ab-d58c-49c0-b0e9-bd3b2a07006d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11363ea00>]}
2021-12-10 01:51:05.479427 (Thread-1): 08:51:05 | 1 of 3 OK loaded seed file dbt_local.raw_customers................... [INSERT 100 in 0.55s]
2021-12-10 01:51:05.480375 (Thread-1): Finished running node seed.waresix_dbt.raw_customers
2021-12-10 01:51:05.481139 (Thread-1): Began running node seed.waresix_dbt.raw_orders
2021-12-10 01:51:05.482503 (Thread-1): 08:51:05 | 2 of 3 START seed file dbt_local.raw_orders.......................... [RUN]
2021-12-10 01:51:05.483989 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 01:51:05.484490 (Thread-1): finished collecting timing info
2021-12-10 01:51:05.526689 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.528835 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.529524 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.530460 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.531493 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 01:51:05.531866 (Thread-1): On seed.waresix_dbt.raw_orders: BEGIN
2021-12-10 01:51:05.532233 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:05.600987 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 01:51:05.601529 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 01:51:05.601868 (Thread-1): On seed.waresix_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_orders"} */

    create table "postgres"."dbt_local"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-12-10 01:51:05.618965 (Thread-1): SQL status: CREATE TABLE in 0.02 seconds
2021-12-10 01:51:05.866758 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 01:51:05.867458 (Thread-1): On seed.waresix_dbt.raw_orders: 
          insert into "postgres"."dbt_local"."raw_orders" (id, user_id, order_date, status) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
2021-12-10 01:51:05.877784 (Thread-1): SQL status: INSERT 0 99 in 0.01 seconds
2021-12-10 01:51:05.879197 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_orders"
2021-12-10 01:51:05.885142 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 01:51:05.885937 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 01:51:05.886775 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 01:51:05.895795 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:05.897492 (Thread-1): finished collecting timing info
2021-12-10 01:51:05.898495 (Thread-1): On seed.waresix_dbt.raw_orders: Close
2021-12-10 01:51:05.900318 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d9fc0ab-d58c-49c0-b0e9-bd3b2a07006d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11368e220>]}
2021-12-10 01:51:05.901356 (Thread-1): 08:51:05 | 2 of 3 OK loaded seed file dbt_local.raw_orders...................... [INSERT 99 in 0.42s]
2021-12-10 01:51:05.901896 (Thread-1): Finished running node seed.waresix_dbt.raw_orders
2021-12-10 01:51:05.902846 (Thread-1): Began running node seed.waresix_dbt.raw_payments
2021-12-10 01:51:05.904223 (Thread-1): 08:51:05 | 3 of 3 START seed file dbt_local.raw_payments........................ [RUN]
2021-12-10 01:51:05.906957 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 01:51:05.908223 (Thread-1): finished collecting timing info
2021-12-10 01:51:05.948193 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.951701 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.953297 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.955655 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:05.957560 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 01:51:05.958144 (Thread-1): On seed.waresix_dbt.raw_payments: BEGIN
2021-12-10 01:51:05.958807 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:05.999538 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:51:06.000076 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 01:51:06.000422 (Thread-1): On seed.waresix_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_payments"} */

    create table "postgres"."dbt_local"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-12-10 01:51:06.027604 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-12-10 01:51:06.197017 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 01:51:06.197508 (Thread-1): On seed.waresix_dbt.raw_payments: 
          insert into "postgres"."dbt_local"."raw_payments" (id, order_id, payment_method, amount) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
2021-12-10 01:51:06.205496 (Thread-1): SQL status: INSERT 0 113 in 0.01 seconds
2021-12-10 01:51:06.206489 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_payments"
2021-12-10 01:51:06.210570 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 01:51:06.210984 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 01:51:06.211312 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 01:51:06.227806 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 01:51:06.229372 (Thread-1): finished collecting timing info
2021-12-10 01:51:06.229881 (Thread-1): On seed.waresix_dbt.raw_payments: Close
2021-12-10 01:51:06.230876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d9fc0ab-d58c-49c0-b0e9-bd3b2a07006d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113696640>]}
2021-12-10 01:51:06.231542 (Thread-1): 08:51:06 | 3 of 3 OK loaded seed file dbt_local.raw_payments.................... [INSERT 113 in 0.32s]
2021-12-10 01:51:06.231964 (Thread-1): Finished running node seed.waresix_dbt.raw_payments
2021-12-10 01:51:06.235576 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:51:06.236365 (MainThread): Using postgres connection "master".
2021-12-10 01:51:06.237056 (MainThread): On master: BEGIN
2021-12-10 01:51:06.238043 (MainThread): Opening a new connection, currently in state closed
2021-12-10 01:51:06.286815 (MainThread): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:51:06.287372 (MainThread): On master: COMMIT
2021-12-10 01:51:06.288244 (MainThread): Using postgres connection "master".
2021-12-10 01:51:06.289049 (MainThread): On master: COMMIT
2021-12-10 01:51:06.293235 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 01:51:06.293947 (MainThread): On master: Close
2021-12-10 01:51:06.295300 (MainThread): 08:51:06 | 
2021-12-10 01:51:06.295846 (MainThread): 08:51:06 | Finished running 3 seeds in 3.69s.
2021-12-10 01:51:06.296486 (MainThread): Connection 'master' was properly closed.
2021-12-10 01:51:06.297387 (MainThread): Connection 'seed.waresix_dbt.raw_payments' was properly closed.
2021-12-10 01:51:06.329162 (MainThread): 
2021-12-10 01:51:06.329675 (MainThread): Completed successfully
2021-12-10 01:51:06.330104 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 01:51:06.330657 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11357afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134585b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135715b0>]}
2021-12-10 01:51:06.331251 (MainThread): Flushing usage events
2021-12-10 01:51:21.890905 (MainThread): Running with dbt=0.21.0
2021-12-10 01:51:22.096178 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 01:51:22.098647 (MainThread): Tracking: tracking
2021-12-10 01:51:22.124520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f01bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f03eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0534f0>]}
2021-12-10 01:51:22.166525 (MainThread): Partial parsing not enabled
2021-12-10 01:51:22.227365 (MainThread): Parsing macros/catalog.sql
2021-12-10 01:51:22.241283 (MainThread): Parsing macros/relations.sql
2021-12-10 01:51:22.249366 (MainThread): Parsing macros/adapters.sql
2021-12-10 01:51:22.330896 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 01:51:22.337402 (MainThread): Parsing macros/core.sql
2021-12-10 01:51:22.350878 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 01:51:22.376570 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 01:51:22.414364 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 01:51:22.420111 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 01:51:22.474712 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 01:51:22.578223 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 01:51:22.650620 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 01:51:22.656074 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 01:51:22.688217 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 01:51:22.751705 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 01:51:22.795334 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 01:51:22.820639 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 01:51:22.843307 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 01:51:22.855404 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 01:51:22.860306 (MainThread): Parsing macros/etc/query.sql
2021-12-10 01:51:22.863252 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 01:51:22.867905 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 01:51:22.895319 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 01:51:22.901162 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 01:51:22.908867 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 01:51:22.913806 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 01:51:23.089133 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 01:51:23.094578 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 01:51:23.098290 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 01:51:23.102423 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 01:51:23.718607 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:23.760061 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:23.828623 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:23.839013 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:23.849195 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:23.996053 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.001318 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.006937 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.012577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.017881 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.042652 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.072039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.073237 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.078271 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.083360 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.088993 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.094291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.099511 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.117092 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.122368 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.127782 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.133340 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.150847 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.151631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.157657 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.163190 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.179137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.182196 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 01:51:24.234488 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f029430>]}
2021-12-10 01:51:24.262824 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 01:51:24.265273 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1b3910>]}
2021-12-10 01:51:24.266241 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 01:51:24.277795 (MainThread): 
2021-12-10 01:51:24.278842 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:51:24.283152 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 01:51:24.328738 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 01:51:24.329370 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 01:51:24.329761 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 01:51:24.517645 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.19 seconds
2021-12-10 01:51:24.521550 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 01:51:24.526965 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:24.544829 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:24.545279 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 01:51:24.545603 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 01:51:24.575496 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:51:24.575992 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 01:51:24.576302 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 01:51:24.587475 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-12-10 01:51:24.590685 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 01:51:24.595441 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 01:51:24.608497 (MainThread): Using postgres connection "master".
2021-12-10 01:51:24.608954 (MainThread): On master: BEGIN
2021-12-10 01:51:24.609273 (MainThread): Opening a new connection, currently in state init
2021-12-10 01:51:24.643658 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:51:24.644161 (MainThread): Using postgres connection "master".
2021-12-10 01:51:24.644484 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 01:51:26.223342 (MainThread): SQL status: SELECT 0 in 1.58 seconds
2021-12-10 01:51:26.226807 (MainThread): On master: ROLLBACK
2021-12-10 01:51:26.232082 (MainThread): Using postgres connection "master".
2021-12-10 01:51:26.232560 (MainThread): On master: BEGIN
2021-12-10 01:51:26.242287 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 01:51:26.242822 (MainThread): On master: COMMIT
2021-12-10 01:51:26.243168 (MainThread): Using postgres connection "master".
2021-12-10 01:51:26.243463 (MainThread): On master: COMMIT
2021-12-10 01:51:26.247598 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 01:51:26.248140 (MainThread): On master: Close
2021-12-10 01:51:26.249867 (MainThread): 08:51:26 | Concurrency: 1 threads (target='dev')
2021-12-10 01:51:26.250424 (MainThread): 08:51:26 | 
2021-12-10 01:51:26.255224 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-10 01:51:26.256124 (Thread-1): 08:51:26 | 1 of 5 START table model dbt_local.stg_customers..................... [RUN]
2021-12-10 01:51:26.257351 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.257904 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-10 01:51:26.266047 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 01:51:26.267962 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.374886 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 01:51:26.376173 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.376831 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-10 01:51:26.377570 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:26.429275 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:51:26.429800 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.430129 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */


  create  table "postgres"."dbt_local"."stg_customers__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
2021-12-10 01:51:26.456716 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-12-10 01:51:26.474515 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.474997 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-10 01:51:26.482465 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 01:51:26.515360 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 01:51:26.515863 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.516267 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 01:51:26.524601 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:26.538271 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 01:51:26.538907 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop table if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-10 01:51:26.544780 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 01:51:26.548118 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.548672 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-10 01:51:26.549734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f289ca0>]}
2021-12-10 01:51:26.550669 (Thread-1): 08:51:26 | 1 of 5 OK created table model dbt_local.stg_customers................ [SELECT 100 in 0.29s]
2021-12-10 01:51:26.551129 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-10 01:51:26.551778 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-10 01:51:26.552764 (Thread-1): 08:51:26 | 2 of 5 START table model dbt_local.stg_orders........................ [RUN]
2021-12-10 01:51:26.553678 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.554125 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-10 01:51:26.560825 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 01:51:26.565039 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.573214 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 01:51:26.575443 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.575865 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-10 01:51:26.576169 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:26.619951 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:51:26.620451 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.620767 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */


  create  table "postgres"."dbt_local"."stg_orders__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
2021-12-10 01:51:26.638720 (Thread-1): SQL status: SELECT 99 in 0.02 seconds
2021-12-10 01:51:26.644188 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.644577 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-10 01:51:26.654974 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 01:51:26.658683 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 01:51:26.659092 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.659400 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 01:51:26.671569 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:26.675609 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 01:51:26.676024 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop table if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-10 01:51:26.684365 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 01:51:26.687235 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.687729 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-10 01:51:26.688672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f6460>]}
2021-12-10 01:51:26.689519 (Thread-1): 08:51:26 | 2 of 5 OK created table model dbt_local.stg_orders................... [SELECT 99 in 0.14s]
2021-12-10 01:51:26.689952 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-10 01:51:26.690461 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-10 01:51:26.691473 (Thread-1): 08:51:26 | 3 of 5 START table model dbt_local.stg_payments...................... [RUN]
2021-12-10 01:51:26.692304 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.692719 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-10 01:51:26.699604 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 01:51:26.700736 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.712372 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 01:51:26.714038 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.714367 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-10 01:51:26.714672 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:26.762763 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 01:51:26.763279 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.763604 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */


  create  table "postgres"."dbt_local"."stg_payments__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
2021-12-10 01:51:26.779197 (Thread-1): SQL status: SELECT 113 in 0.02 seconds
2021-12-10 01:51:26.784789 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.785218 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-10 01:51:26.789299 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:51:26.793022 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 01:51:26.793432 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.793749 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 01:51:26.806536 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:26.810390 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 01:51:26.810751 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop table if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-10 01:51:26.815044 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 01:51:26.818054 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.818567 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-10 01:51:26.819633 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f226fa0>]}
2021-12-10 01:51:26.820563 (Thread-1): 08:51:26 | 3 of 5 OK created table model dbt_local.stg_payments................. [SELECT 113 in 0.13s]
2021-12-10 01:51:26.821105 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-10 01:51:26.822746 (Thread-1): Began running node model.waresix_dbt.customers
2021-12-10 01:51:26.824030 (Thread-1): 08:51:26 | 4 of 5 START table model dbt_local.customers......................... [RUN]
2021-12-10 01:51:26.825171 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.825643 (Thread-1): Compiling model.waresix_dbt.customers
2021-12-10 01:51:26.836959 (Thread-1): Writing injected SQL for node "model.waresix_dbt.customers"
2021-12-10 01:51:26.838835 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.846099 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.customers"
2021-12-10 01:51:26.847634 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.848252 (Thread-1): On model.waresix_dbt.customers: BEGIN
2021-12-10 01:51:26.848808 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:26.881138 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-12-10 01:51:26.881655 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.881982 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */


  create  table "postgres"."dbt_local"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "postgres"."dbt_local"."stg_customers"

),

orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
2021-12-10 01:51:26.906367 (Thread-1): SQL status: SELECT 100 in 0.02 seconds
2021-12-10 01:51:26.912064 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.912481 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
alter table "postgres"."dbt_local"."customers__dbt_tmp" rename to "customers"
2021-12-10 01:51:26.917133 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:51:26.920305 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 01:51:26.920680 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.920981 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 01:51:26.937429 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 01:51:26.941297 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 01:51:26.941672 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
drop table if exists "postgres"."dbt_local"."customers__dbt_backup" cascade
2021-12-10 01:51:26.945442 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 01:51:26.948288 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.948889 (Thread-1): On model.waresix_dbt.customers: Close
2021-12-10 01:51:26.950265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2d16d0>]}
2021-12-10 01:51:26.951201 (Thread-1): 08:51:26 | 4 of 5 OK created table model dbt_local.customers.................... [SELECT 100 in 0.13s]
2021-12-10 01:51:26.951643 (Thread-1): Finished running node model.waresix_dbt.customers
2021-12-10 01:51:26.952112 (Thread-1): Began running node model.waresix_dbt.orders
2021-12-10 01:51:26.953351 (Thread-1): 08:51:26 | 5 of 5 START table model dbt_local.orders............................ [RUN]
2021-12-10 01:51:26.954247 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:26.954655 (Thread-1): Compiling model.waresix_dbt.orders
2021-12-10 01:51:26.970901 (Thread-1): Writing injected SQL for node "model.waresix_dbt.orders"
2021-12-10 01:51:26.972989 (Thread-1): finished collecting timing info
2021-12-10 01:51:26.979697 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.orders"
2021-12-10 01:51:26.981918 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:26.983042 (Thread-1): On model.waresix_dbt.orders: BEGIN
2021-12-10 01:51:26.984429 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 01:51:27.023554 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:51:27.024063 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:27.024392 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */


  create  table "postgres"."dbt_local"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
2021-12-10 01:51:27.055413 (Thread-1): SQL status: SELECT 99 in 0.03 seconds
2021-12-10 01:51:27.060760 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:27.061169 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
alter table "postgres"."dbt_local"."orders__dbt_tmp" rename to "orders"
2021-12-10 01:51:27.065713 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 01:51:27.068991 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 01:51:27.069376 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:27.069672 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 01:51:27.078882 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:27.083146 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 01:51:27.083559 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
drop table if exists "postgres"."dbt_local"."orders__dbt_backup" cascade
2021-12-10 01:51:27.089653 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 01:51:27.092500 (Thread-1): finished collecting timing info
2021-12-10 01:51:27.092957 (Thread-1): On model.waresix_dbt.orders: Close
2021-12-10 01:51:27.093876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30515cc1-8c28-4a16-bc88-9de50698ec25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2f6460>]}
2021-12-10 01:51:27.094702 (Thread-1): 08:51:27 | 5 of 5 OK created table model dbt_local.orders....................... [SELECT 99 in 0.14s]
2021-12-10 01:51:27.095142 (Thread-1): Finished running node model.waresix_dbt.orders
2021-12-10 01:51:27.097771 (MainThread): Acquiring new postgres connection "master".
2021-12-10 01:51:27.098277 (MainThread): Using postgres connection "master".
2021-12-10 01:51:27.098593 (MainThread): On master: BEGIN
2021-12-10 01:51:27.098904 (MainThread): Opening a new connection, currently in state closed
2021-12-10 01:51:27.135369 (MainThread): SQL status: BEGIN in 0.04 seconds
2021-12-10 01:51:27.135965 (MainThread): On master: COMMIT
2021-12-10 01:51:27.136311 (MainThread): Using postgres connection "master".
2021-12-10 01:51:27.136652 (MainThread): On master: COMMIT
2021-12-10 01:51:27.142989 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 01:51:27.143500 (MainThread): On master: Close
2021-12-10 01:51:27.144428 (MainThread): 08:51:27 | 
2021-12-10 01:51:27.144918 (MainThread): 08:51:27 | Finished running 5 table models in 2.87s.
2021-12-10 01:51:27.145566 (MainThread): Connection 'master' was properly closed.
2021-12-10 01:51:27.145986 (MainThread): Connection 'model.waresix_dbt.orders' was properly closed.
2021-12-10 01:51:27.161845 (MainThread): 
2021-12-10 01:51:27.162336 (MainThread): Completed successfully
2021-12-10 01:51:27.162739 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-10 01:51:27.163265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2fcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f029430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f029790>]}
2021-12-10 01:51:27.163903 (MainThread): Flushing usage events
2021-12-10 02:23:40.761566 (MainThread): Running with dbt=0.21.0
2021-12-10 02:23:41.057013 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-10 02:23:41.059462 (MainThread): Tracking: tracking
2021-12-10 02:23:41.100152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040dbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040eacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ea970>]}
2021-12-10 02:23:41.102167 (MainThread): Warning: No packages were found in packages.yml
2021-12-10 02:23:41.103091 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040dbfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040eacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ea970>]}
2021-12-10 02:23:41.104033 (MainThread): Flushing usage events
2021-12-10 02:25:12.555581 (MainThread): Running with dbt=0.21.0
2021-12-10 02:25:12.879625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-12-10 02:25:12.883932 (MainThread): Tracking: tracking
2021-12-10 02:25:12.924495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111358d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111394490>]}
2021-12-10 02:25:12.966796 (MainThread): Partial parsing not enabled
2021-12-10 02:25:13.039157 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:25:13.054596 (MainThread): Parsing macros/relations.sql
2021-12-10 02:25:13.059163 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:25:13.163658 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:25:13.169306 (MainThread): Parsing macros/core.sql
2021-12-10 02:25:13.184789 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:25:13.208645 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:25:13.242391 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:25:13.247980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:25:13.307298 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:25:13.422199 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:25:13.508113 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:25:13.514639 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:25:13.566988 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:25:13.665213 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:25:13.723956 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:25:13.753937 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:25:13.779794 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:25:13.793563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:25:13.798317 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:25:13.801569 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:25:13.806934 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:25:13.836198 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:25:13.842574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:25:13.850442 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:25:13.855974 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:25:14.043170 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:25:14.048520 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:25:14.052496 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:25:14.057002 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:25:14.898513 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:25:14.949144 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:25:15.033833 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:25:15.048719 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:25:15.061998 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:25:15.244442 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.251652 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.257842 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.264898 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.272377 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.306390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.351348 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.352231 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.358691 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.366259 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.375574 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.390707 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.412715 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.447714 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.454182 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.459627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.466523 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.485838 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.487434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.494150 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.500627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.524474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.525715 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:15.613829 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c6b7cc-dac2-472f-bc7c-e42e9f5b93ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111368e20>]}
2021-12-10 02:25:15.686605 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 02:25:15.692739 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3c6b7cc-dac2-472f-bc7c-e42e9f5b93ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113687c0>]}
2021-12-10 02:25:15.694444 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 02:25:15.741476 (MainThread): 
2021-12-10 02:25:15.743876 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:25:15.749831 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 02:25:15.807268 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 02:25:15.808170 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 02:25:15.808887 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 02:25:16.208750 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.40 seconds
2021-12-10 02:25:16.212869 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 02:25:16.215950 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 02:25:16.217164 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 02:25:16.218298 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."dbt_local""
2021-12-10 02:25:16.250986 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 02:25:16.251588 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: BEGIN
2021-12-10 02:25:16.252064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-10 02:25:16.294420 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:25:16.294954 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 02:25:16.295291 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "create_postgres_dbt_local"} */
create schema if not exists "dbt_local"
2021-12-10 02:25:16.303028 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.01 seconds
2021-12-10 02:25:16.305562 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 02:25:16.305977 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 02:25:16.306285 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 02:25:16.315384 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:25:16.316256 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: Close
2021-12-10 02:25:16.323000 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 02:25:16.353605 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:25:16.354493 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 02:25:16.354868 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 02:25:16.455859 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.10 seconds
2021-12-10 02:25:16.456711 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:25:16.457262 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 02:25:16.480421 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-12-10 02:25:16.486646 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 02:25:16.496704 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 02:25:16.527308 (MainThread): Using postgres connection "master".
2021-12-10 02:25:16.530701 (MainThread): On master: BEGIN
2021-12-10 02:25:16.533908 (MainThread): Opening a new connection, currently in state init
2021-12-10 02:25:16.575931 (MainThread): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:25:16.576441 (MainThread): Using postgres connection "master".
2021-12-10 02:25:16.576894 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 02:25:20.068020 (MainThread): SQL status: SELECT 0 in 3.49 seconds
2021-12-10 02:25:20.074068 (MainThread): On master: ROLLBACK
2021-12-10 02:25:20.083262 (MainThread): Using postgres connection "master".
2021-12-10 02:25:20.083934 (MainThread): On master: BEGIN
2021-12-10 02:25:20.096388 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 02:25:20.097002 (MainThread): On master: COMMIT
2021-12-10 02:25:20.097356 (MainThread): Using postgres connection "master".
2021-12-10 02:25:20.098091 (MainThread): On master: COMMIT
2021-12-10 02:25:20.106121 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:25:20.106756 (MainThread): On master: Close
2021-12-10 02:25:20.108231 (MainThread): 09:25:20 | Concurrency: 1 threads (target='dev')
2021-12-10 02:25:20.109259 (MainThread): 09:25:20 | 
2021-12-10 02:25:20.121270 (Thread-1): Began running node seed.waresix_dbt.raw_customers
2021-12-10 02:25:20.122738 (Thread-1): 09:25:20 | 1 of 3 START seed file dbt_local.raw_customers....................... [RUN]
2021-12-10 02:25:20.124350 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 02:25:20.126246 (Thread-1): finished collecting timing info
2021-12-10 02:25:20.431510 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.432579 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.433572 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.434792 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 02:25:20.435293 (Thread-1): On seed.waresix_dbt.raw_customers: BEGIN
2021-12-10 02:25:20.435868 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:25:20.492506 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 02:25:20.493771 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 02:25:20.494156 (Thread-1): On seed.waresix_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_customers"} */

    create table "postgres"."dbt_local"."raw_customers" (id integer,first_name text,last_name text)
  
2021-12-10 02:25:20.528976 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-12-10 02:25:20.721276 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 02:25:20.721751 (Thread-1): On seed.waresix_dbt.raw_customers: 
          insert into "postgres"."dbt_local"."raw_customers" (id, first_name, last_name) values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
2021-12-10 02:25:20.730345 (Thread-1): SQL status: INSERT 0 100 in 0.01 seconds
2021-12-10 02:25:20.745042 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_customers"
2021-12-10 02:25:20.780615 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 02:25:20.781425 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 02:25:20.781768 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 02:25:20.790440 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:25:20.792044 (Thread-1): finished collecting timing info
2021-12-10 02:25:20.792542 (Thread-1): On seed.waresix_dbt.raw_customers: Close
2021-12-10 02:25:20.793981 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c6b7cc-dac2-472f-bc7c-e42e9f5b93ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115799a0>]}
2021-12-10 02:25:20.795166 (Thread-1): 09:25:20 | 1 of 3 OK loaded seed file dbt_local.raw_customers................... [INSERT 100 in 0.67s]
2021-12-10 02:25:20.795889 (Thread-1): Finished running node seed.waresix_dbt.raw_customers
2021-12-10 02:25:20.796492 (Thread-1): Began running node seed.waresix_dbt.raw_orders
2021-12-10 02:25:20.797527 (Thread-1): 09:25:20 | 2 of 3 START seed file dbt_local.raw_orders.......................... [RUN]
2021-12-10 02:25:20.798431 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 02:25:20.798849 (Thread-1): finished collecting timing info
2021-12-10 02:25:20.851641 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.853228 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.854119 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.854573 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:20.855492 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 02:25:20.856041 (Thread-1): On seed.waresix_dbt.raw_orders: BEGIN
2021-12-10 02:25:20.856389 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:25:20.892128 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:25:20.893154 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 02:25:20.893575 (Thread-1): On seed.waresix_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_orders"} */

    create table "postgres"."dbt_local"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-12-10 02:25:20.910467 (Thread-1): SQL status: CREATE TABLE in 0.02 seconds
2021-12-10 02:25:21.147237 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 02:25:21.148275 (Thread-1): On seed.waresix_dbt.raw_orders: 
          insert into "postgres"."dbt_local"."raw_orders" (id, user_id, order_date, status) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
2021-12-10 02:25:21.163249 (Thread-1): SQL status: INSERT 0 99 in 0.01 seconds
2021-12-10 02:25:21.164814 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_orders"
2021-12-10 02:25:21.172271 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 02:25:21.172953 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 02:25:21.173664 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 02:25:21.186312 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:25:21.188451 (Thread-1): finished collecting timing info
2021-12-10 02:25:21.189283 (Thread-1): On seed.waresix_dbt.raw_orders: Close
2021-12-10 02:25:21.191198 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c6b7cc-dac2-472f-bc7c-e42e9f5b93ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111563100>]}
2021-12-10 02:25:21.193816 (Thread-1): 09:25:21 | 2 of 3 OK loaded seed file dbt_local.raw_orders...................... [INSERT 99 in 0.39s]
2021-12-10 02:25:21.195245 (Thread-1): Finished running node seed.waresix_dbt.raw_orders
2021-12-10 02:25:21.196577 (Thread-1): Began running node seed.waresix_dbt.raw_payments
2021-12-10 02:25:21.198115 (Thread-1): 09:25:21 | 3 of 3 START seed file dbt_local.raw_payments........................ [RUN]
2021-12-10 02:25:21.202412 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 02:25:21.203317 (Thread-1): finished collecting timing info
2021-12-10 02:25:21.247221 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:21.248846 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:21.249838 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:21.254471 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:25:21.255977 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 02:25:21.256431 (Thread-1): On seed.waresix_dbt.raw_payments: BEGIN
2021-12-10 02:25:21.256805 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:25:21.325205 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:25:21.325803 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 02:25:21.326149 (Thread-1): On seed.waresix_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_payments"} */

    create table "postgres"."dbt_local"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-12-10 02:25:21.356878 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-12-10 02:25:21.547033 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 02:25:21.547610 (Thread-1): On seed.waresix_dbt.raw_payments: 
          insert into "postgres"."dbt_local"."raw_payments" (id, order_id, payment_method, amount) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
2021-12-10 02:25:21.556096 (Thread-1): SQL status: INSERT 0 113 in 0.01 seconds
2021-12-10 02:25:21.557237 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_payments"
2021-12-10 02:25:21.561745 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 02:25:21.562364 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 02:25:21.562832 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 02:25:21.570956 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:25:21.572647 (Thread-1): finished collecting timing info
2021-12-10 02:25:21.573499 (Thread-1): On seed.waresix_dbt.raw_payments: Close
2021-12-10 02:25:21.574566 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c6b7cc-dac2-472f-bc7c-e42e9f5b93ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115700a0>]}
2021-12-10 02:25:21.575278 (Thread-1): 09:25:21 | 3 of 3 OK loaded seed file dbt_local.raw_payments.................... [INSERT 113 in 0.38s]
2021-12-10 02:25:21.575821 (Thread-1): Finished running node seed.waresix_dbt.raw_payments
2021-12-10 02:25:21.580711 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:25:21.585123 (MainThread): Using postgres connection "master".
2021-12-10 02:25:21.586079 (MainThread): On master: BEGIN
2021-12-10 02:25:21.586571 (MainThread): Opening a new connection, currently in state closed
2021-12-10 02:25:21.638140 (MainThread): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:25:21.638702 (MainThread): On master: COMMIT
2021-12-10 02:25:21.639058 (MainThread): Using postgres connection "master".
2021-12-10 02:25:21.639362 (MainThread): On master: COMMIT
2021-12-10 02:25:21.643742 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 02:25:21.644286 (MainThread): On master: Close
2021-12-10 02:25:21.645192 (MainThread): 09:25:21 | 
2021-12-10 02:25:21.645638 (MainThread): 09:25:21 | Finished running 3 seeds in 5.90s.
2021-12-10 02:25:21.646246 (MainThread): Connection 'master' was properly closed.
2021-12-10 02:25:21.646953 (MainThread): Connection 'seed.waresix_dbt.raw_payments' was properly closed.
2021-12-10 02:25:21.670258 (MainThread): 
2021-12-10 02:25:21.671008 (MainThread): Completed successfully
2021-12-10 02:25:21.671600 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 02:25:21.672350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113587f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a95e0>]}
2021-12-10 02:25:21.673147 (MainThread): Flushing usage events
2021-12-10 02:36:24.969479 (MainThread): Running with dbt=0.21.0
2021-12-10 02:36:25.287863 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 02:36:25.290975 (MainThread): Tracking: tracking
2021-12-10 02:36:25.329777 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f81820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fba550>]}
2021-12-10 02:36:25.368674 (MainThread): Partial parsing not enabled
2021-12-10 02:36:25.435297 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:36:25.448682 (MainThread): Parsing macros/relations.sql
2021-12-10 02:36:25.453823 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:36:25.543823 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:36:25.549707 (MainThread): Parsing macros/core.sql
2021-12-10 02:36:25.562557 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:36:25.587142 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:36:25.620951 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:36:25.628038 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:36:25.691528 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:36:25.809188 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:36:25.895377 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:36:25.901028 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:36:25.938714 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:36:26.031658 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:36:26.109796 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:36:26.160006 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:36:26.189272 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:36:26.206677 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:36:26.212088 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:36:26.215810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:36:26.222779 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:36:26.256344 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:36:26.264700 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:36:26.274128 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:36:26.279890 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:36:26.465770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:36:26.471155 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:36:26.475521 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:36:26.480218 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:36:27.169128 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:36:27.219651 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:36:27.302489 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:36:27.314525 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:36:27.325462 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:36:27.477524 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.483209 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.488913 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.495107 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.500263 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.527120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.565105 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.565943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.571323 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.577471 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.584148 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.589460 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.595283 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.613509 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.619069 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.625267 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.631564 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.653006 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.653838 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.659511 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.664969 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.681354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.684474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:36:27.690768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f86fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107103370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107103dc0>]}
2021-12-10 02:36:27.691624 (MainThread): Flushing usage events
2021-12-10 02:36:29.052877 (MainThread): Connection 'model.waresix_dbt.stg_orders' was properly closed.
2021-12-10 02:36:29.053396 (MainThread): Encountered an error:
2021-12-10 02:36:29.053816 (MainThread): Compilation Error in model orders (models/orders.sql)
  Documentation for 'model.waresix_dbt.orders' depends on doc 'orders_status'  which was not found
2021-12-10 02:36:29.179929 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 356, in load
    self.process_docs(self.root_project)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 735, in process_docs
    _process_docs_for_node(ctx, node)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 919, in _process_docs_for_node
    column.description = get_rendered(column.description, context)
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/Library/Python/3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/Library/Python/3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/Library/Python/3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/Library/Python/3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.8/site-packages/dbt/context/docs.py", line 73, in doc
    doc_target_not_found(self.node, doc_name, doc_package_name)
  File "/Library/Python/3.8/site-packages/dbt/exceptions.py", line 524, in doc_target_not_found
    raise_compiler_error(msg, model)
  File "/Library/Python/3.8/site-packages/dbt/exceptions.py", line 444, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model orders (models/orders.sql)
  Documentation for 'model.waresix_dbt.orders' depends on doc 'orders_status'  which was not found

2021-12-10 02:38:20.965872 (MainThread): Running with dbt=0.21.0
2021-12-10 02:38:21.343426 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 02:38:21.347039 (MainThread): Tracking: tracking
2021-12-10 02:38:21.409397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c220b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c236580>]}
2021-12-10 02:38:21.458371 (MainThread): Partial parsing not enabled
2021-12-10 02:38:21.534564 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:38:21.545770 (MainThread): Parsing macros/relations.sql
2021-12-10 02:38:21.550985 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:38:21.646540 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:38:21.652770 (MainThread): Parsing macros/core.sql
2021-12-10 02:38:21.665875 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:38:21.691843 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:38:21.725636 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:38:21.732046 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:38:21.801270 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:38:21.913155 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:38:21.998817 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:38:22.011859 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:38:22.064134 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:38:22.164112 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:38:22.248251 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:38:22.286350 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:38:22.325040 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:38:22.353096 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:38:22.362059 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:38:22.371308 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:38:22.404527 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:38:22.484697 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:38:22.492827 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:38:22.503898 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:38:22.518729 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:38:22.866854 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:38:22.873279 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:38:22.878610 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:38:22.884185 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:38:23.642752 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:23.687453 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:23.776241 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:23.811298 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:23.854820 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:24.137465 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.147028 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.161409 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.168281 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.177497 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.233673 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.306365 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.309750 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.317431 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.325110 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.335123 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.344063 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.351927 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.384329 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.392934 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.403977 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.413190 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.436474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.438295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.447274 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.455191 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.476943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.477976 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:38:24.540322 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2de910>]}
2021-12-10 02:38:24.563092 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 02:38:24.564471 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c301d30>]}
2021-12-10 02:38:24.565151 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 02:38:24.575669 (MainThread): 
2021-12-10 02:38:24.576666 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:38:24.581561 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 02:38:24.627709 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 02:38:24.628169 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 02:38:24.628518 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 02:38:24.940558 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.31 seconds
2021-12-10 02:38:24.944316 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 02:38:24.950336 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 02:38:24.977358 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:38:24.977820 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 02:38:24.978159 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 02:38:25.019071 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:38:25.019952 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:38:25.020543 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 02:38:25.037075 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.02 seconds
2021-12-10 02:38:25.040459 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 02:38:25.044630 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 02:38:25.059171 (MainThread): Using postgres connection "master".
2021-12-10 02:38:25.059702 (MainThread): On master: BEGIN
2021-12-10 02:38:25.060338 (MainThread): Opening a new connection, currently in state init
2021-12-10 02:38:25.094614 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:38:25.095140 (MainThread): Using postgres connection "master".
2021-12-10 02:38:25.095460 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 02:38:27.051616 (MainThread): SQL status: SELECT 0 in 1.96 seconds
2021-12-10 02:38:27.055194 (MainThread): On master: ROLLBACK
2021-12-10 02:38:27.063904 (MainThread): Using postgres connection "master".
2021-12-10 02:38:27.064392 (MainThread): On master: BEGIN
2021-12-10 02:38:27.074414 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 02:38:27.074966 (MainThread): On master: COMMIT
2021-12-10 02:38:27.075323 (MainThread): Using postgres connection "master".
2021-12-10 02:38:27.075633 (MainThread): On master: COMMIT
2021-12-10 02:38:27.081647 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:38:27.082237 (MainThread): On master: Close
2021-12-10 02:38:27.083349 (MainThread): 09:38:27 | Concurrency: 1 threads (target='dev')
2021-12-10 02:38:27.083829 (MainThread): 09:38:27 | 
2021-12-10 02:38:27.088816 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-10 02:38:27.090086 (Thread-1): 09:38:27 | 1 of 5 START table model dbt_local.stg_customers..................... [RUN]
2021-12-10 02:38:27.094074 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.094623 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-10 02:38:27.105115 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 02:38:27.112332 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.214354 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 02:38:27.215969 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.216354 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-10 02:38:27.216679 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:38:27.254162 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:38:27.254675 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.255004 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */


  create  table "postgres"."dbt_local"."stg_customers__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
2021-12-10 02:38:27.286913 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-12-10 02:38:27.314192 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.314678 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-10 02:38:27.321181 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 02:38:27.353698 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 02:38:27.354200 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.354535 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 02:38:27.372847 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 02:38:27.396499 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:38:27.396999 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop table if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-10 02:38:27.404332 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 02:38:27.409214 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.410598 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-10 02:38:27.412784 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c441f70>]}
2021-12-10 02:38:27.414308 (Thread-1): 09:38:27 | 1 of 5 OK created table model dbt_local.stg_customers................ [SELECT 100 in 0.32s]
2021-12-10 02:38:27.415252 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-10 02:38:27.416016 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-10 02:38:27.416971 (Thread-1): 09:38:27 | 2 of 5 START table model dbt_local.stg_orders........................ [RUN]
2021-12-10 02:38:27.418565 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.420034 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-10 02:38:27.436948 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 02:38:27.439062 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.463319 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 02:38:27.467383 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.468083 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-10 02:38:27.468668 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:38:27.605010 (Thread-1): SQL status: BEGIN in 0.14 seconds
2021-12-10 02:38:27.605731 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.606291 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */


  create  table "postgres"."dbt_local"."stg_orders__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
2021-12-10 02:38:27.702215 (Thread-1): SQL status: SELECT 99 in 0.10 seconds
2021-12-10 02:38:27.711055 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.711738 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-10 02:38:27.724991 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 02:38:27.730404 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 02:38:27.731234 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.731852 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 02:38:27.742628 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:38:27.749951 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:38:27.750999 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop table if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-10 02:38:27.756222 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 02:38:27.759969 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.760773 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-10 02:38:27.762434 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b611df0>]}
2021-12-10 02:38:27.763732 (Thread-1): 09:38:27 | 2 of 5 OK created table model dbt_local.stg_orders................... [SELECT 99 in 0.34s]
2021-12-10 02:38:27.764312 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-10 02:38:27.765170 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-10 02:38:27.766565 (Thread-1): 09:38:27 | 3 of 5 START table model dbt_local.stg_payments...................... [RUN]
2021-12-10 02:38:27.767568 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.768194 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-10 02:38:27.776979 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 02:38:27.778222 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.791675 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 02:38:27.796481 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.797286 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-10 02:38:27.798018 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:38:27.858483 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 02:38:27.859376 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.860316 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */


  create  table "postgres"."dbt_local"."stg_payments__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
2021-12-10 02:38:27.888437 (Thread-1): SQL status: SELECT 113 in 0.03 seconds
2021-12-10 02:38:27.897044 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.897486 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-10 02:38:27.906819 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 02:38:27.911686 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 02:38:27.912152 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.912524 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 02:38:27.920658 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:38:27.929090 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:38:27.929905 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop table if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-10 02:38:27.935025 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 02:38:27.937903 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.938396 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-10 02:38:27.940200 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4ab4c0>]}
2021-12-10 02:38:27.941650 (Thread-1): 09:38:27 | 3 of 5 OK created table model dbt_local.stg_payments................. [SELECT 113 in 0.17s]
2021-12-10 02:38:27.942728 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-10 02:38:27.945670 (Thread-1): Began running node model.waresix_dbt.customers
2021-12-10 02:38:27.946463 (Thread-1): 09:38:27 | 4 of 5 START table model dbt_local.customers......................... [RUN]
2021-12-10 02:38:27.947395 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:27.947875 (Thread-1): Compiling model.waresix_dbt.customers
2021-12-10 02:38:27.969028 (Thread-1): Writing injected SQL for node "model.waresix_dbt.customers"
2021-12-10 02:38:27.970996 (Thread-1): finished collecting timing info
2021-12-10 02:38:27.983904 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.customers"
2021-12-10 02:38:27.989097 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:27.989957 (Thread-1): On model.waresix_dbt.customers: BEGIN
2021-12-10 02:38:27.991712 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:38:28.032055 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:38:28.032618 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:28.033041 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */


  create  table "postgres"."dbt_local"."customers__dbt_tmp"
  as (
    with customers as (

    select * from "postgres"."dbt_local"."stg_customers"

),

orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

customer_orders as (

        select
        customer_id,

        min(order_date) as first_order,
        max(order_date) as most_recent_order,
        count(order_id) as number_of_orders
    from orders

    group by customer_id

),

customer_payments as (

    select
        orders.customer_id,
        sum(amount) as total_amount

    from payments

    left join orders on
         payments.order_id = orders.order_id

    group by orders.customer_id

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order,
        customer_orders.most_recent_order,
        customer_orders.number_of_orders,
        customer_payments.total_amount as customer_lifetime_value

    from customers

    left join customer_orders
        on customers.customer_id = customer_orders.customer_id

    left join customer_payments
        on  customers.customer_id = customer_payments.customer_id

)

select * from final
  );
2021-12-10 02:38:28.054813 (Thread-1): SQL status: SELECT 100 in 0.02 seconds
2021-12-10 02:38:28.060884 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:28.061523 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
alter table "postgres"."dbt_local"."customers__dbt_tmp" rename to "customers"
2021-12-10 02:38:28.066170 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:38:28.070454 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 02:38:28.071018 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:28.071454 (Thread-1): On model.waresix_dbt.customers: COMMIT
2021-12-10 02:38:28.087126 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 02:38:28.091827 (Thread-1): Using postgres connection "model.waresix_dbt.customers".
2021-12-10 02:38:28.092272 (Thread-1): On model.waresix_dbt.customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.customers"} */
drop table if exists "postgres"."dbt_local"."customers__dbt_backup" cascade
2021-12-10 02:38:28.099461 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 02:38:28.103852 (Thread-1): finished collecting timing info
2021-12-10 02:38:28.104417 (Thread-1): On model.waresix_dbt.customers: Close
2021-12-10 02:38:28.105537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c44ab80>]}
2021-12-10 02:38:28.106418 (Thread-1): 09:38:28 | 4 of 5 OK created table model dbt_local.customers.................... [SELECT 100 in 0.16s]
2021-12-10 02:38:28.106929 (Thread-1): Finished running node model.waresix_dbt.customers
2021-12-10 02:38:28.107678 (Thread-1): Began running node model.waresix_dbt.orders
2021-12-10 02:38:28.108937 (Thread-1): 09:38:28 | 5 of 5 START table model dbt_local.orders............................ [RUN]
2021-12-10 02:38:28.110419 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.110883 (Thread-1): Compiling model.waresix_dbt.orders
2021-12-10 02:38:28.132894 (Thread-1): Writing injected SQL for node "model.waresix_dbt.orders"
2021-12-10 02:38:28.134687 (Thread-1): finished collecting timing info
2021-12-10 02:38:28.150957 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.orders"
2021-12-10 02:38:28.152326 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.153036 (Thread-1): On model.waresix_dbt.orders: BEGIN
2021-12-10 02:38:28.153617 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:38:28.193111 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:38:28.193763 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.194145 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */


  create  table "postgres"."dbt_local"."orders__dbt_tmp"
  as (
    

with orders as (

    select * from "postgres"."dbt_local"."stg_orders"

),

payments as (

    select * from "postgres"."dbt_local"."stg_payments"

),

order_payments as (

    select
        order_id,

        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,
        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,
        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,
        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,
        sum(amount) as total_amount

    from payments

    group by order_id

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        orders.status,

        order_payments.credit_card_amount,

        order_payments.coupon_amount,

        order_payments.bank_transfer_amount,

        order_payments.gift_card_amount,

        order_payments.total_amount as amount

    from orders


    left join order_payments
        on orders.order_id = order_payments.order_id

)

select * from final
  );
2021-12-10 02:38:28.222437 (Thread-1): SQL status: SELECT 99 in 0.03 seconds
2021-12-10 02:38:28.227920 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.228333 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
alter table "postgres"."dbt_local"."orders__dbt_tmp" rename to "orders"
2021-12-10 02:38:28.233181 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:38:28.236668 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 02:38:28.237094 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.237413 (Thread-1): On model.waresix_dbt.orders: COMMIT
2021-12-10 02:38:28.251359 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:38:28.256207 (Thread-1): Using postgres connection "model.waresix_dbt.orders".
2021-12-10 02:38:28.256784 (Thread-1): On model.waresix_dbt.orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.orders"} */
drop table if exists "postgres"."dbt_local"."orders__dbt_backup" cascade
2021-12-10 02:38:28.261940 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 02:38:28.265003 (Thread-1): finished collecting timing info
2021-12-10 02:38:28.265503 (Thread-1): On model.waresix_dbt.orders: Close
2021-12-10 02:38:28.266851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4c6c7c-831b-4faf-8cf9-9ca1afa1e383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c468880>]}
2021-12-10 02:38:28.267992 (Thread-1): 09:38:28 | 5 of 5 OK created table model dbt_local.orders....................... [SELECT 99 in 0.16s]
2021-12-10 02:38:28.268567 (Thread-1): Finished running node model.waresix_dbt.orders
2021-12-10 02:38:28.272328 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:38:28.272908 (MainThread): Using postgres connection "master".
2021-12-10 02:38:28.273267 (MainThread): On master: BEGIN
2021-12-10 02:38:28.273586 (MainThread): Opening a new connection, currently in state closed
2021-12-10 02:38:28.319396 (MainThread): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:38:28.320108 (MainThread): On master: COMMIT
2021-12-10 02:38:28.320649 (MainThread): Using postgres connection "master".
2021-12-10 02:38:28.320975 (MainThread): On master: COMMIT
2021-12-10 02:38:28.324986 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 02:38:28.325660 (MainThread): On master: Close
2021-12-10 02:38:28.326612 (MainThread): 09:38:28 | 
2021-12-10 02:38:28.327066 (MainThread): 09:38:28 | Finished running 5 table models in 3.75s.
2021-12-10 02:38:28.327448 (MainThread): Connection 'master' was properly closed.
2021-12-10 02:38:28.327762 (MainThread): Connection 'model.waresix_dbt.orders' was properly closed.
2021-12-10 02:38:28.350071 (MainThread): 
2021-12-10 02:38:28.351043 (MainThread): Completed successfully
2021-12-10 02:38:28.351491 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-12-10 02:38:28.352184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2694c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c24ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c352f10>]}
2021-12-10 02:38:28.352768 (MainThread): Flushing usage events
2021-12-10 02:39:38.696146 (MainThread): Running with dbt=0.21.0
2021-12-10 02:39:39.086441 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-10 02:39:39.090338 (MainThread): Tracking: tracking
2021-12-10 02:39:39.150568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065edd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106625520>]}
2021-12-10 02:39:39.195463 (MainThread): Partial parsing not enabled
2021-12-10 02:39:39.286070 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:39:39.298045 (MainThread): Parsing macros/relations.sql
2021-12-10 02:39:39.303240 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:39:39.421121 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:39:39.426588 (MainThread): Parsing macros/core.sql
2021-12-10 02:39:39.445152 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:39:39.475111 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:39:39.510715 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:39:39.516131 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:39:39.580972 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:39:39.695128 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:39:39.784763 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:39:39.791372 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:39:39.835741 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:39:39.947747 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:39:40.022415 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:39:40.072618 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:39:40.112740 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:39:40.137167 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:39:40.144826 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:39:40.149710 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:39:40.155132 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:39:40.189813 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:39:40.198055 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:39:40.207777 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:39:40.214366 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:39:40.454312 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:39:40.464422 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:39:40.469942 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:39:40.475581 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:39:41.294865 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:39:41.351259 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:39:41.443736 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:39:41.459551 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:39:41.473091 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:39:41.662456 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.670489 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.677286 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.684740 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.691450 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.719881 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.761317 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.762109 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.770685 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.778243 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.784995 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.791882 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.797865 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.816975 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.822872 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.829823 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.837183 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.856963 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.859468 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.866926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.873713 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.903647 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.904791 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:39:41.991586 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537c1e45-2110-45ba-814f-e05768fb52ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e2250>]}
2021-12-10 02:39:42.021092 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 02:39:42.022944 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537c1e45-2110-45ba-814f-e05768fb52ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d52b0>]}
2021-12-10 02:39:42.024313 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 02:39:42.052682 (MainThread): 
2021-12-10 02:39:42.054233 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:39:42.066134 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 02:39:42.183034 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:39:42.183755 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 02:39:42.184652 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-10 02:39:42.427172 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.24 seconds
2021-12-10 02:39:42.428527 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:39:42.429852 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 02:39:42.447978 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.02 seconds
2021-12-10 02:39:42.452127 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 02:39:42.456303 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 02:39:42.477535 (MainThread): Using postgres connection "master".
2021-12-10 02:39:42.478147 (MainThread): On master: BEGIN
2021-12-10 02:39:42.478672 (MainThread): Opening a new connection, currently in state init
2021-12-10 02:39:42.511063 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:39:42.511588 (MainThread): Using postgres connection "master".
2021-12-10 02:39:42.511924 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 02:39:44.703951 (MainThread): SQL status: SELECT 0 in 2.19 seconds
2021-12-10 02:39:44.706940 (MainThread): On master: ROLLBACK
2021-12-10 02:39:44.711871 (MainThread): On master: Close
2021-12-10 02:39:44.712962 (MainThread): 09:39:44 | Concurrency: 1 threads (target='dev')
2021-12-10 02:39:44.713476 (MainThread): 09:39:44 | 
2021-12-10 02:39:44.725373 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:39:44.727495 (Thread-1): 09:39:44 | 1 of 20 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-12-10 02:39:44.731275 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:39:44.732345 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:39:44.783216 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 02:39:44.786939 (Thread-1): finished collecting timing info
2021-12-10 02:39:44.839746 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 02:39:44.841510 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:39:44.842169 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
2021-12-10 02:39:44.842585 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:44.875369 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:39:44.876082 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:39:44.876574 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-12-10 02:39:44.890644 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:44.896913 (Thread-1): finished collecting timing info
2021-12-10 02:39:44.897541 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
2021-12-10 02:39:44.902763 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
2021-12-10 02:39:44.904047 (Thread-1): 09:39:44 | 1 of 20 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 0.17s]
2021-12-10 02:39:44.904544 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:39:44.905059 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:39:44.906083 (Thread-1): 09:39:44 | 2 of 20 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [RUN]
2021-12-10 02:39:44.907325 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:39:44.908266 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:39:44.946626 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 02:39:44.948887 (Thread-1): finished collecting timing info
2021-12-10 02:39:44.958087 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 02:39:44.962734 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:39:44.964953 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
2021-12-10 02:39:44.965951 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.005815 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:39:45.006338 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:39:45.006970 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
2021-12-10 02:39:45.018044 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.023486 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.024043 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
2021-12-10 02:39:45.028208 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
2021-12-10 02:39:45.031029 (Thread-1): 09:39:45 | 2 of 20 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [PASS in 0.12s]
2021-12-10 02:39:45.031991 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:39:45.032696 (Thread-1): Began running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:39:45.033338 (Thread-1): 09:39:45 | 3 of 20 START test not_null_stg_customers_customer_id................ [RUN]
2021-12-10 02:39:45.034958 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:39:45.035631 (Thread-1): Compiling test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:39:45.065035 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 02:39:45.066767 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.075889 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 02:39:45.077903 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:39:45.078776 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
2021-12-10 02:39:45.081451 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.165220 (Thread-1): SQL status: BEGIN in 0.08 seconds
2021-12-10 02:39:45.165755 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:39:45.166209 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:45.174319 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.180414 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.181303 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
2021-12-10 02:39:45.185240 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-10 02:39:45.186915 (Thread-1): 09:39:45 | 3 of 20 PASS not_null_stg_customers_customer_id...................... [PASS in 0.15s]
2021-12-10 02:39:45.188060 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:39:45.189472 (Thread-1): Began running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:39:45.190626 (Thread-1): 09:39:45 | 4 of 20 START test not_null_stg_orders_order_id...................... [RUN]
2021-12-10 02:39:45.192034 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:39:45.192775 (Thread-1): Compiling test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:39:45.206932 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 02:39:45.209389 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.221278 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 02:39:45.222925 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:39:45.223428 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
2021-12-10 02:39:45.223749 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.287211 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 02:39:45.288221 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:39:45.289109 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:45.295946 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.301394 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.301981 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
2021-12-10 02:39:45.306270 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
2021-12-10 02:39:45.308303 (Thread-1): 09:39:45 | 4 of 20 PASS not_null_stg_orders_order_id............................ [PASS in 0.12s]
2021-12-10 02:39:45.309579 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:39:45.310284 (Thread-1): Began running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:39:45.311221 (Thread-1): 09:39:45 | 5 of 20 START test not_null_stg_payments_payment_id.................. [RUN]
2021-12-10 02:39:45.312417 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:39:45.312849 (Thread-1): Compiling test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:39:45.339320 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 02:39:45.340864 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.351229 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 02:39:45.352878 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:39:45.353306 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: BEGIN
2021-12-10 02:39:45.353747 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.406281 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:39:45.406876 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:39:45.407241 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:45.420044 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.424266 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.424874 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
2021-12-10 02:39:45.431713 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: Close
2021-12-10 02:39:45.433887 (Thread-1): 09:39:45 | 5 of 20 PASS not_null_stg_payments_payment_id........................ [PASS in 0.12s]
2021-12-10 02:39:45.435473 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:39:45.436928 (Thread-1): Began running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:39:45.438316 (Thread-1): 09:39:45 | 6 of 20 START test unique_stg_customers_customer_id.................. [RUN]
2021-12-10 02:39:45.440221 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:39:45.440996 (Thread-1): Compiling test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:39:45.487314 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 02:39:45.492015 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.499548 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 02:39:45.501344 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:39:45.501893 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
2021-12-10 02:39:45.502240 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.572959 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:39:45.573477 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:39:45.573830 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:39:45.590064 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-12-10 02:39:45.594341 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.594881 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
2021-12-10 02:39:45.600722 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: Close
2021-12-10 02:39:45.602053 (Thread-1): 09:39:45 | 6 of 20 PASS unique_stg_customers_customer_id........................ [PASS in 0.16s]
2021-12-10 02:39:45.602549 (Thread-1): Finished running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:39:45.603014 (Thread-1): Began running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:39:45.603689 (Thread-1): 09:39:45 | 7 of 20 START test unique_stg_orders_order_id........................ [RUN]
2021-12-10 02:39:45.606046 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:39:45.606923 (Thread-1): Compiling test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:39:45.623280 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 02:39:45.624839 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.633854 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 02:39:45.635335 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:39:45.635784 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
2021-12-10 02:39:45.636504 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.685192 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:39:45.685878 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:39:45.686470 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:39:45.694701 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.698359 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.699033 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
2021-12-10 02:39:45.704370 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: Close
2021-12-10 02:39:45.705596 (Thread-1): 09:39:45 | 7 of 20 PASS unique_stg_orders_order_id.............................. [PASS in 0.10s]
2021-12-10 02:39:45.706062 (Thread-1): Finished running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:39:45.706529 (Thread-1): Began running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:39:45.707213 (Thread-1): 09:39:45 | 8 of 20 START test unique_stg_payments_payment_id.................... [RUN]
2021-12-10 02:39:45.708544 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:39:45.709037 (Thread-1): Compiling test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:39:45.723001 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 02:39:45.724353 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.735623 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 02:39:45.737568 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:39:45.738087 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: BEGIN
2021-12-10 02:39:45.738546 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.780219 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:39:45.781041 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:39:45.781519 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:39:45.788575 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.793019 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.793559 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: ROLLBACK
2021-12-10 02:39:45.797231 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: Close
2021-12-10 02:39:45.799787 (Thread-1): 09:39:45 | 8 of 20 PASS unique_stg_payments_payment_id.......................... [PASS in 0.09s]
2021-12-10 02:39:45.800494 (Thread-1): Finished running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:39:45.802826 (Thread-1): Began running node test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
2021-12-10 02:39:45.803607 (Thread-1): 09:39:45 | 9 of 20 START test accepted_values_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-12-10 02:39:45.805096 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3".
2021-12-10 02:39:45.807717 (Thread-1): Compiling test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
2021-12-10 02:39:45.843942 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
2021-12-10 02:39:45.851142 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.862648 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"
2021-12-10 02:39:45.864450 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3".
2021-12-10 02:39:45.865066 (Thread-1): On test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: BEGIN
2021-12-10 02:39:45.865627 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:45.923537 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 02:39:45.924402 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3".
2021-12-10 02:39:45.924957 (Thread-1): On test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-12-10 02:39:45.934909 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:45.941581 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.942597 (Thread-1): On test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: ROLLBACK
2021-12-10 02:39:45.947326 (Thread-1): On test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3: Close
2021-12-10 02:39:45.949275 (Thread-1): 09:39:45 | 9 of 20 PASS accepted_values_orders_status__placed__shipped__completed__return_pending__returned [PASS in 0.14s]
2021-12-10 02:39:45.950226 (Thread-1): Finished running node test.waresix_dbt.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3
2021-12-10 02:39:45.951122 (Thread-1): Began running node test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d
2021-12-10 02:39:45.952186 (Thread-1): 09:39:45 | 10 of 20 START test not_null_customers_customer_id................... [RUN]
2021-12-10 02:39:45.953335 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d".
2021-12-10 02:39:45.953985 (Thread-1): Compiling test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d
2021-12-10 02:39:45.973892 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d"
2021-12-10 02:39:45.975908 (Thread-1): finished collecting timing info
2021-12-10 02:39:45.984349 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d"
2021-12-10 02:39:45.985619 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d".
2021-12-10 02:39:45.986282 (Thread-1): On test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d: BEGIN
2021-12-10 02:39:45.986611 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:46.036005 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:39:46.036501 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d".
2021-12-10 02:39:46.036871 (Thread-1): On test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."customers"
where customer_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:46.045682 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:46.050953 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.051667 (Thread-1): On test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
2021-12-10 02:39:46.057179 (Thread-1): On test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d: Close
2021-12-10 02:39:46.059534 (Thread-1): 09:39:46 | 10 of 20 PASS not_null_customers_customer_id......................... [PASS in 0.11s]
2021-12-10 02:39:46.084259 (Thread-1): Finished running node test.waresix_dbt.not_null_customers_customer_id.5c9bf9911d
2021-12-10 02:39:46.101291 (Thread-1): Began running node test.waresix_dbt.not_null_orders_amount.106140f9fd
2021-12-10 02:39:46.142842 (Thread-1): 09:39:46 | 11 of 20 START test not_null_orders_amount........................... [RUN]
2021-12-10 02:39:46.144973 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_amount.106140f9fd".
2021-12-10 02:39:46.145787 (Thread-1): Compiling test.waresix_dbt.not_null_orders_amount.106140f9fd
2021-12-10 02:39:46.206640 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_amount.106140f9fd"
2021-12-10 02:39:46.212371 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.221445 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_amount.106140f9fd"
2021-12-10 02:39:46.256257 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_amount.106140f9fd".
2021-12-10 02:39:46.264532 (Thread-1): On test.waresix_dbt.not_null_orders_amount.106140f9fd: BEGIN
2021-12-10 02:39:46.266648 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:46.365762 (Thread-1): SQL status: BEGIN in 0.10 seconds
2021-12-10 02:39:46.366869 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_amount.106140f9fd".
2021-12-10 02:39:46.367754 (Thread-1): On test.waresix_dbt.not_null_orders_amount.106140f9fd: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_amount.106140f9fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where amount is null



      
    ) dbt_internal_test
2021-12-10 02:39:46.383919 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:46.394565 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.395337 (Thread-1): On test.waresix_dbt.not_null_orders_amount.106140f9fd: ROLLBACK
2021-12-10 02:39:46.428609 (Thread-1): On test.waresix_dbt.not_null_orders_amount.106140f9fd: Close
2021-12-10 02:39:46.431191 (Thread-1): 09:39:46 | 11 of 20 PASS not_null_orders_amount................................. [PASS in 0.29s]
2021-12-10 02:39:46.432891 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_amount.106140f9fd
2021-12-10 02:39:46.435481 (Thread-1): Began running node test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49
2021-12-10 02:39:46.436511 (Thread-1): 09:39:46 | 12 of 20 START test not_null_orders_bank_transfer_amount............. [RUN]
2021-12-10 02:39:46.440519 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49".
2021-12-10 02:39:46.441475 (Thread-1): Compiling test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49
2021-12-10 02:39:46.462858 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49"
2021-12-10 02:39:46.465503 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.475333 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49"
2021-12-10 02:39:46.478452 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49".
2021-12-10 02:39:46.479799 (Thread-1): On test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49: BEGIN
2021-12-10 02:39:46.480282 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:46.562740 (Thread-1): SQL status: BEGIN in 0.08 seconds
2021-12-10 02:39:46.563556 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49".
2021-12-10 02:39:46.564196 (Thread-1): On test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where bank_transfer_amount is null



      
    ) dbt_internal_test
2021-12-10 02:39:46.573891 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:46.581499 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.582270 (Thread-1): On test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49: ROLLBACK
2021-12-10 02:39:46.591669 (Thread-1): On test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49: Close
2021-12-10 02:39:46.593545 (Thread-1): 09:39:46 | 12 of 20 PASS not_null_orders_bank_transfer_amount................... [PASS in 0.15s]
2021-12-10 02:39:46.594312 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_bank_transfer_amount.7743500c49
2021-12-10 02:39:46.595016 (Thread-1): Began running node test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625
2021-12-10 02:39:46.596091 (Thread-1): 09:39:46 | 13 of 20 START test not_null_orders_coupon_amount.................... [RUN]
2021-12-10 02:39:46.597541 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625".
2021-12-10 02:39:46.598174 (Thread-1): Compiling test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625
2021-12-10 02:39:46.626478 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625"
2021-12-10 02:39:46.628464 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.642373 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625"
2021-12-10 02:39:46.646509 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625".
2021-12-10 02:39:46.647124 (Thread-1): On test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625: BEGIN
2021-12-10 02:39:46.647641 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:46.720289 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:39:46.721219 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625".
2021-12-10 02:39:46.721785 (Thread-1): On test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where coupon_amount is null



      
    ) dbt_internal_test
2021-12-10 02:39:46.732814 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:46.739483 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.740767 (Thread-1): On test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625: ROLLBACK
2021-12-10 02:39:46.747165 (Thread-1): On test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625: Close
2021-12-10 02:39:46.750064 (Thread-1): 09:39:46 | 13 of 20 PASS not_null_orders_coupon_amount.......................... [PASS in 0.15s]
2021-12-10 02:39:46.751017 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_coupon_amount.ab90c90625
2021-12-10 02:39:46.752157 (Thread-1): Began running node test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59
2021-12-10 02:39:46.753295 (Thread-1): 09:39:46 | 14 of 20 START test not_null_orders_credit_card_amount............... [RUN]
2021-12-10 02:39:46.760347 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59".
2021-12-10 02:39:46.761616 (Thread-1): Compiling test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59
2021-12-10 02:39:46.783362 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59"
2021-12-10 02:39:46.784851 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.794337 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59"
2021-12-10 02:39:46.800133 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59".
2021-12-10 02:39:46.801241 (Thread-1): On test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59: BEGIN
2021-12-10 02:39:46.801828 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:46.887058 (Thread-1): SQL status: BEGIN in 0.09 seconds
2021-12-10 02:39:46.887925 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59".
2021-12-10 02:39:46.888680 (Thread-1): On test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where credit_card_amount is null



      
    ) dbt_internal_test
2021-12-10 02:39:46.901776 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:46.908059 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.909316 (Thread-1): On test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59: ROLLBACK
2021-12-10 02:39:46.917139 (Thread-1): On test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59: Close
2021-12-10 02:39:46.919143 (Thread-1): 09:39:46 | 14 of 20 PASS not_null_orders_credit_card_amount..................... [PASS in 0.16s]
2021-12-10 02:39:46.919896 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_credit_card_amount.d3ca593b59
2021-12-10 02:39:46.920593 (Thread-1): Began running node test.waresix_dbt.not_null_orders_customer_id.c5f02694af
2021-12-10 02:39:46.921676 (Thread-1): 09:39:46 | 15 of 20 START test not_null_orders_customer_id...................... [RUN]
2021-12-10 02:39:46.923214 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_customer_id.c5f02694af".
2021-12-10 02:39:46.923856 (Thread-1): Compiling test.waresix_dbt.not_null_orders_customer_id.c5f02694af
2021-12-10 02:39:46.945961 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_customer_id.c5f02694af"
2021-12-10 02:39:46.949858 (Thread-1): finished collecting timing info
2021-12-10 02:39:46.959973 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_customer_id.c5f02694af"
2021-12-10 02:39:46.965638 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_customer_id.c5f02694af".
2021-12-10 02:39:46.966658 (Thread-1): On test.waresix_dbt.not_null_orders_customer_id.c5f02694af: BEGIN
2021-12-10 02:39:46.967322 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.033102 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:39:47.033944 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_customer_id.c5f02694af".
2021-12-10 02:39:47.034515 (Thread-1): On test.waresix_dbt.not_null_orders_customer_id.c5f02694af: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_customer_id.c5f02694af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where customer_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:47.045485 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.051649 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.052529 (Thread-1): On test.waresix_dbt.not_null_orders_customer_id.c5f02694af: ROLLBACK
2021-12-10 02:39:47.057049 (Thread-1): On test.waresix_dbt.not_null_orders_customer_id.c5f02694af: Close
2021-12-10 02:39:47.058558 (Thread-1): 09:39:47 | 15 of 20 PASS not_null_orders_customer_id............................ [PASS in 0.14s]
2021-12-10 02:39:47.059326 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_customer_id.c5f02694af
2021-12-10 02:39:47.060098 (Thread-1): Began running node test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a
2021-12-10 02:39:47.061442 (Thread-1): 09:39:47 | 16 of 20 START test not_null_orders_gift_card_amount................. [RUN]
2021-12-10 02:39:47.063177 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a".
2021-12-10 02:39:47.063729 (Thread-1): Compiling test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a
2021-12-10 02:39:47.081370 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a"
2021-12-10 02:39:47.084100 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.100185 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a"
2021-12-10 02:39:47.103313 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a".
2021-12-10 02:39:47.104268 (Thread-1): On test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a: BEGIN
2021-12-10 02:39:47.105382 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.167804 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 02:39:47.168504 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a".
2021-12-10 02:39:47.169016 (Thread-1): On test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where gift_card_amount is null



      
    ) dbt_internal_test
2021-12-10 02:39:47.177985 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.184601 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.185479 (Thread-1): On test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a: ROLLBACK
2021-12-10 02:39:47.192033 (Thread-1): On test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a: Close
2021-12-10 02:39:47.194425 (Thread-1): 09:39:47 | 16 of 20 PASS not_null_orders_gift_card_amount....................... [PASS in 0.13s]
2021-12-10 02:39:47.195894 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_gift_card_amount.413a0d2d7a
2021-12-10 02:39:47.196912 (Thread-1): Began running node test.waresix_dbt.not_null_orders_order_id.cf6c17daed
2021-12-10 02:39:47.199071 (Thread-1): 09:39:47 | 17 of 20 START test not_null_orders_order_id......................... [RUN]
2021-12-10 02:39:47.200391 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_orders_order_id.cf6c17daed".
2021-12-10 02:39:47.201738 (Thread-1): Compiling test.waresix_dbt.not_null_orders_order_id.cf6c17daed
2021-12-10 02:39:47.222802 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_orders_order_id.cf6c17daed"
2021-12-10 02:39:47.224941 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.235961 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_orders_order_id.cf6c17daed"
2021-12-10 02:39:47.237254 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_order_id.cf6c17daed".
2021-12-10 02:39:47.237649 (Thread-1): On test.waresix_dbt.not_null_orders_order_id.cf6c17daed: BEGIN
2021-12-10 02:39:47.238075 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.306769 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:39:47.307612 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_orders_order_id.cf6c17daed".
2021-12-10 02:39:47.308678 (Thread-1): On test.waresix_dbt.not_null_orders_order_id.cf6c17daed: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_orders_order_id.cf6c17daed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."orders"
where order_id is null



      
    ) dbt_internal_test
2021-12-10 02:39:47.320567 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.328279 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.330079 (Thread-1): On test.waresix_dbt.not_null_orders_order_id.cf6c17daed: ROLLBACK
2021-12-10 02:39:47.338827 (Thread-1): On test.waresix_dbt.not_null_orders_order_id.cf6c17daed: Close
2021-12-10 02:39:47.340485 (Thread-1): 09:39:47 | 17 of 20 PASS not_null_orders_order_id............................... [PASS in 0.14s]
2021-12-10 02:39:47.341079 (Thread-1): Finished running node test.waresix_dbt.not_null_orders_order_id.cf6c17daed
2021-12-10 02:39:47.342414 (Thread-1): Began running node test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
2021-12-10 02:39:47.343977 (Thread-1): 09:39:47 | 18 of 20 START test relationships_orders_customer_id__customer_id__ref_customers_ [RUN]
2021-12-10 02:39:47.345820 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2".
2021-12-10 02:39:47.346774 (Thread-1): Compiling test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
2021-12-10 02:39:47.382379 (Thread-1): Writing injected SQL for node "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
2021-12-10 02:39:47.384293 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.392488 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"
2021-12-10 02:39:47.394468 (Thread-1): Using postgres connection "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2".
2021-12-10 02:39:47.395319 (Thread-1): On test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: BEGIN
2021-12-10 02:39:47.396381 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.471649 (Thread-1): SQL status: BEGIN in 0.08 seconds
2021-12-10 02:39:47.472734 (Thread-1): Using postgres connection "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2".
2021-12-10 02:39:47.473623 (Thread-1): On test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "postgres"."dbt_local"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "postgres"."dbt_local"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2021-12-10 02:39:47.487505 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.493174 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.493992 (Thread-1): On test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: ROLLBACK
2021-12-10 02:39:47.501969 (Thread-1): On test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2: Close
2021-12-10 02:39:47.504384 (Thread-1): 09:39:47 | 18 of 20 PASS relationships_orders_customer_id__customer_id__ref_customers_ [PASS in 0.16s]
2021-12-10 02:39:47.505757 (Thread-1): Finished running node test.waresix_dbt.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2
2021-12-10 02:39:47.506755 (Thread-1): Began running node test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1
2021-12-10 02:39:47.508254 (Thread-1): 09:39:47 | 19 of 20 START test unique_customers_customer_id..................... [RUN]
2021-12-10 02:39:47.511808 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1".
2021-12-10 02:39:47.512815 (Thread-1): Compiling test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1
2021-12-10 02:39:47.536850 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1"
2021-12-10 02:39:47.538644 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.550859 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1"
2021-12-10 02:39:47.552817 (Thread-1): Using postgres connection "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1".
2021-12-10 02:39:47.553445 (Thread-1): On test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1: BEGIN
2021-12-10 02:39:47.553993 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.607942 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:39:47.610044 (Thread-1): Using postgres connection "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1".
2021-12-10 02:39:47.610731 (Thread-1): On test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:39:47.623342 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.630551 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.631479 (Thread-1): On test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
2021-12-10 02:39:47.636309 (Thread-1): On test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1: Close
2021-12-10 02:39:47.637945 (Thread-1): 09:39:47 | 19 of 20 PASS unique_customers_customer_id........................... [PASS in 0.13s]
2021-12-10 02:39:47.638929 (Thread-1): Finished running node test.waresix_dbt.unique_customers_customer_id.c5af1ff4b1
2021-12-10 02:39:47.639700 (Thread-1): Began running node test.waresix_dbt.unique_orders_order_id.fed79b3a6e
2021-12-10 02:39:47.640802 (Thread-1): 09:39:47 | 20 of 20 START test unique_orders_order_id........................... [RUN]
2021-12-10 02:39:47.641865 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_orders_order_id.fed79b3a6e".
2021-12-10 02:39:47.642487 (Thread-1): Compiling test.waresix_dbt.unique_orders_order_id.fed79b3a6e
2021-12-10 02:39:47.664978 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_orders_order_id.fed79b3a6e"
2021-12-10 02:39:47.666348 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.674686 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_orders_order_id.fed79b3a6e"
2021-12-10 02:39:47.676318 (Thread-1): Using postgres connection "test.waresix_dbt.unique_orders_order_id.fed79b3a6e".
2021-12-10 02:39:47.677027 (Thread-1): On test.waresix_dbt.unique_orders_order_id.fed79b3a6e: BEGIN
2021-12-10 02:39:47.677648 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:39:47.730599 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:39:47.731520 (Thread-1): Using postgres connection "test.waresix_dbt.unique_orders_order_id.fed79b3a6e".
2021-12-10 02:39:47.732242 (Thread-1): On test.waresix_dbt.unique_orders_order_id.fed79b3a6e: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_orders_order_id.fed79b3a6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:39:47.741325 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:39:47.751957 (Thread-1): finished collecting timing info
2021-12-10 02:39:47.752693 (Thread-1): On test.waresix_dbt.unique_orders_order_id.fed79b3a6e: ROLLBACK
2021-12-10 02:39:47.757389 (Thread-1): On test.waresix_dbt.unique_orders_order_id.fed79b3a6e: Close
2021-12-10 02:39:47.760018 (Thread-1): 09:39:47 | 20 of 20 PASS unique_orders_order_id................................. [PASS in 0.12s]
2021-12-10 02:39:47.761183 (Thread-1): Finished running node test.waresix_dbt.unique_orders_order_id.fed79b3a6e
2021-12-10 02:39:47.765286 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:39:47.766712 (MainThread): 09:39:47 | 
2021-12-10 02:39:47.767575 (MainThread): 09:39:47 | Finished running 20 tests in 5.71s.
2021-12-10 02:39:47.768322 (MainThread): Connection 'master' was properly closed.
2021-12-10 02:39:47.768868 (MainThread): Connection 'test.waresix_dbt.unique_orders_order_id.fed79b3a6e' was properly closed.
2021-12-10 02:39:47.802894 (MainThread): 
2021-12-10 02:39:47.803766 (MainThread): Completed successfully
2021-12-10 02:39:47.804821 (MainThread): 
Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
2021-12-10 02:39:47.805760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106748fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106625a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106740610>]}
2021-12-10 02:39:47.806857 (MainThread): Flushing usage events
2021-12-10 02:43:29.385885 (MainThread): Running with dbt=0.21.0
2021-12-10 02:43:29.747400 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:stg'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 02:43:29.751313 (MainThread): Tracking: tracking
2021-12-10 02:43:29.815463 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e22040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5c4f0>]}
2021-12-10 02:43:29.875841 (MainThread): Partial parsing not enabled
2021-12-10 02:43:29.984967 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:43:29.996885 (MainThread): Parsing macros/relations.sql
2021-12-10 02:43:30.001435 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:43:30.090144 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:43:30.096910 (MainThread): Parsing macros/core.sql
2021-12-10 02:43:30.115311 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:43:30.141222 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:43:30.180650 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:43:30.186115 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:43:30.253859 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:43:30.368866 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:43:30.473402 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:43:30.479894 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:43:30.516848 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:43:30.592289 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:43:30.651229 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:43:30.697014 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:43:30.730986 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:43:30.753586 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:43:30.766042 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:43:30.773964 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:43:30.784930 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:43:30.826837 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:43:30.837644 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:43:30.850511 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:43:30.857588 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:43:31.168142 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:43:31.174795 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:43:31.179479 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:43:31.184482 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:43:31.937003 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:43:32.179668 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:43:32.284593 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:32.299442 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:32.311554 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:32.533567 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.540861 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.548663 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.555973 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.563244 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.599203 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.635816 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.636755 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.643233 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.649516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.656717 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.662952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.669125 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.690442 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.696940 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.705513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.714708 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.747390 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.749878 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.760644 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.771254 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.810026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.811271 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:43:32.942568 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddafd826-1cea-4f72-bd36-06a3b6bbe80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb70d0>]}
2021-12-10 02:43:32.997026 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 02:43:33.001910 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddafd826-1cea-4f72-bd36-06a3b6bbe80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb7c10>]}
2021-12-10 02:43:33.004929 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 02:43:33.075756 (MainThread): 
2021-12-10 02:43:33.081598 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:43:33.088512 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 02:43:33.156669 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 02:43:33.157365 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 02:43:33.157907 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 02:43:33.414847 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.26 seconds
2021-12-10 02:43:33.422688 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 02:43:33.431621 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 02:43:33.458999 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:43:33.459568 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 02:43:33.460042 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 02:43:33.499547 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:43:33.500064 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:43:33.500393 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 02:43:33.512902 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-12-10 02:43:33.516609 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 02:43:33.520872 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 02:43:33.539452 (MainThread): Using postgres connection "master".
2021-12-10 02:43:33.539916 (MainThread): On master: BEGIN
2021-12-10 02:43:33.540264 (MainThread): Opening a new connection, currently in state init
2021-12-10 02:43:33.572391 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:43:33.572893 (MainThread): Using postgres connection "master".
2021-12-10 02:43:33.573314 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 02:43:36.832316 (MainThread): SQL status: SELECT 0 in 3.26 seconds
2021-12-10 02:43:36.838303 (MainThread): On master: ROLLBACK
2021-12-10 02:43:36.845773 (MainThread): Using postgres connection "master".
2021-12-10 02:43:36.847008 (MainThread): On master: BEGIN
2021-12-10 02:43:36.864255 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-12-10 02:43:36.864947 (MainThread): On master: COMMIT
2021-12-10 02:43:36.865324 (MainThread): Using postgres connection "master".
2021-12-10 02:43:36.865642 (MainThread): On master: COMMIT
2021-12-10 02:43:36.871616 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:43:36.872212 (MainThread): On master: Close
2021-12-10 02:43:36.873373 (MainThread): 09:43:36 | Concurrency: 1 threads (target='dev')
2021-12-10 02:43:36.874271 (MainThread): 09:43:36 | 
2021-12-10 02:43:36.880085 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-10 02:43:36.880943 (Thread-1): 09:43:36 | 1 of 3 START table model dbt_local.stg_customers..................... [RUN]
2021-12-10 02:43:36.881825 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:36.882251 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-10 02:43:36.893865 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 02:43:36.897371 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.005667 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 02:43:37.007717 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.008528 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-10 02:43:37.009151 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:43:37.058267 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:43:37.058967 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.059541 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */


  create  table "postgres"."dbt_local"."stg_customers__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
2021-12-10 02:43:37.089827 (Thread-1): SQL status: SELECT 100 in 0.03 seconds
2021-12-10 02:43:37.119933 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.120679 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers" rename to "stg_customers__dbt_backup"
2021-12-10 02:43:37.126388 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 02:43:37.136865 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.137548 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-10 02:43:37.142958 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:43:37.190827 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 02:43:37.191336 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.191722 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 02:43:37.201972 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:43:37.216952 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:43:37.217465 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop table if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-10 02:43:37.233442 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-12-10 02:43:37.239349 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.240397 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-10 02:43:37.242753 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddafd826-1cea-4f72-bd36-06a3b6bbe80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108034dc0>]}
2021-12-10 02:43:37.245012 (Thread-1): 09:43:37 | 1 of 3 OK created table model dbt_local.stg_customers................ [SELECT 100 in 0.36s]
2021-12-10 02:43:37.245733 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-10 02:43:37.246637 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-10 02:43:37.248139 (Thread-1): 09:43:37 | 2 of 3 START table model dbt_local.stg_orders........................ [RUN]
2021-12-10 02:43:37.249589 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.250396 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-10 02:43:37.265434 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 02:43:37.270405 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.286333 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 02:43:37.289912 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.291022 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-10 02:43:37.292729 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:43:37.324533 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:43:37.325048 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.325380 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */


  create  table "postgres"."dbt_local"."stg_orders__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
2021-12-10 02:43:37.351347 (Thread-1): SQL status: SELECT 99 in 0.03 seconds
2021-12-10 02:43:37.357353 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.357879 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders" rename to "stg_orders__dbt_backup"
2021-12-10 02:43:37.362605 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:43:37.369195 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.369790 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-10 02:43:37.374908 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:43:37.378460 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 02:43:37.378918 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.379233 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 02:43:37.396000 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 02:43:37.402719 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:43:37.403236 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop table if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-10 02:43:37.412504 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 02:43:37.415561 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.416062 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-10 02:43:37.416991 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddafd826-1cea-4f72-bd36-06a3b6bbe80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ebca0>]}
2021-12-10 02:43:37.418457 (Thread-1): 09:43:37 | 2 of 3 OK created table model dbt_local.stg_orders................... [SELECT 99 in 0.17s]
2021-12-10 02:43:37.419005 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-10 02:43:37.419463 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-10 02:43:37.420086 (Thread-1): 09:43:37 | 3 of 3 START table model dbt_local.stg_payments...................... [RUN]
2021-12-10 02:43:37.420913 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.421313 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-10 02:43:37.431641 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 02:43:37.433226 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.442049 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 02:43:37.443528 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.444119 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-10 02:43:37.444673 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:43:37.513918 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:43:37.514644 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.515065 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */


  create  table "postgres"."dbt_local"."stg_payments__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
2021-12-10 02:43:37.535845 (Thread-1): SQL status: SELECT 113 in 0.02 seconds
2021-12-10 02:43:37.542343 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.542782 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments" rename to "stg_payments__dbt_backup"
2021-12-10 02:43:37.549108 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 02:43:37.556319 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.556752 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-10 02:43:37.561655 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-12-10 02:43:37.565384 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 02:43:37.565919 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.566270 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 02:43:37.579925 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:43:37.584069 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:43:37.584535 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop table if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-10 02:43:37.603817 (Thread-1): SQL status: DROP TABLE in 0.02 seconds
2021-12-10 02:43:37.610740 (Thread-1): finished collecting timing info
2021-12-10 02:43:37.611744 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-10 02:43:37.613933 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ddafd826-1cea-4f72-bd36-06a3b6bbe80a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f02b0>]}
2021-12-10 02:43:37.615368 (Thread-1): 09:43:37 | 3 of 3 OK created table model dbt_local.stg_payments................. [SELECT 113 in 0.19s]
2021-12-10 02:43:37.616361 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-10 02:43:37.620456 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:43:37.621389 (MainThread): Using postgres connection "master".
2021-12-10 02:43:37.622012 (MainThread): On master: BEGIN
2021-12-10 02:43:37.622854 (MainThread): Opening a new connection, currently in state closed
2021-12-10 02:43:37.706078 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-10 02:43:37.706645 (MainThread): On master: COMMIT
2021-12-10 02:43:37.707282 (MainThread): Using postgres connection "master".
2021-12-10 02:43:37.708308 (MainThread): On master: COMMIT
2021-12-10 02:43:37.714885 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 02:43:37.715520 (MainThread): On master: Close
2021-12-10 02:43:37.716552 (MainThread): 09:43:37 | 
2021-12-10 02:43:37.717001 (MainThread): 09:43:37 | Finished running 3 table models in 4.64s.
2021-12-10 02:43:37.717553 (MainThread): Connection 'master' was properly closed.
2021-12-10 02:43:37.718268 (MainThread): Connection 'model.waresix_dbt.stg_payments' was properly closed.
2021-12-10 02:43:37.748717 (MainThread): 
2021-12-10 02:43:37.750184 (MainThread): Completed successfully
2021-12-10 02:43:37.752070 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 02:43:37.754105 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f755e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e73ac0>]}
2021-12-10 02:43:37.756006 (MainThread): Flushing usage events
2021-12-10 02:44:17.482856 (MainThread): Running with dbt=0.21.0
2021-12-10 02:44:17.735915 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['tag:stg'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-10 02:44:17.738927 (MainThread): Tracking: tracking
2021-12-10 02:44:17.771219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111289af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a04f0>]}
2021-12-10 02:44:17.811243 (MainThread): Partial parsing not enabled
2021-12-10 02:44:17.870849 (MainThread): Parsing macros/catalog.sql
2021-12-10 02:44:17.881585 (MainThread): Parsing macros/relations.sql
2021-12-10 02:44:17.885956 (MainThread): Parsing macros/adapters.sql
2021-12-10 02:44:17.959763 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 02:44:17.965061 (MainThread): Parsing macros/core.sql
2021-12-10 02:44:17.978170 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 02:44:18.002483 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 02:44:18.038044 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 02:44:18.043616 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 02:44:18.102246 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 02:44:18.277579 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 02:44:18.420088 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 02:44:18.429123 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 02:44:18.484139 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 02:44:18.576464 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 02:44:18.625555 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 02:44:18.653544 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 02:44:18.678026 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 02:44:18.691192 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 02:44:18.696227 (MainThread): Parsing macros/etc/query.sql
2021-12-10 02:44:18.699481 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 02:44:18.704421 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 02:44:18.734281 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 02:44:18.740732 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 02:44:18.749134 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 02:44:18.754260 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 02:44:18.945956 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 02:44:18.951509 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 02:44:18.955528 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 02:44:18.959837 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 02:44:19.650775 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 02:44:19.692800 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 02:44:19.765049 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 02:44:19.776857 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 02:44:19.789934 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 02:44:19.944639 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:19.950296 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:19.956099 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:19.962204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:19.968126 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:19.994786 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.025547 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.026373 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.031620 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.039187 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.045560 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.053700 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.059982 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.081217 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.087186 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.092755 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.099057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.118243 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.119781 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.125095 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.130833 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.149499 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.150305 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 02:44:20.202013 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fb791c1-5f3b-4814-972f-5e6afeabe4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126dc40>]}
2021-12-10 02:44:20.223564 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 02:44:20.225060 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fb791c1-5f3b-4814-972f-5e6afeabe4c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126dcd0>]}
2021-12-10 02:44:20.225753 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 02:44:20.236167 (MainThread): 
2021-12-10 02:44:20.237270 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:44:20.240515 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 02:44:20.279719 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:44:20.280288 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 02:44:20.281656 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-10 02:44:20.588581 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-10 02:44:20.589414 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 02:44:20.590110 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 02:44:20.602936 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2021-12-10 02:44:20.607128 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 02:44:20.610297 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 02:44:20.625183 (MainThread): Using postgres connection "master".
2021-12-10 02:44:20.625634 (MainThread): On master: BEGIN
2021-12-10 02:44:20.625979 (MainThread): Opening a new connection, currently in state init
2021-12-10 02:44:20.655301 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:44:20.655811 (MainThread): Using postgres connection "master".
2021-12-10 02:44:20.656271 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 02:44:22.879035 (MainThread): SQL status: SELECT 0 in 2.22 seconds
2021-12-10 02:44:22.882123 (MainThread): On master: ROLLBACK
2021-12-10 02:44:22.887426 (MainThread): On master: Close
2021-12-10 02:44:22.888499 (MainThread): 09:44:22 | Concurrency: 1 threads (target='dev')
2021-12-10 02:44:22.888980 (MainThread): 09:44:22 | 
2021-12-10 02:44:22.902166 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:44:22.903256 (Thread-1): 09:44:22 | 1 of 8 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-12-10 02:44:22.904909 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:44:22.906228 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:44:22.959487 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 02:44:22.960644 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.012410 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 02:44:23.015755 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:44:23.016214 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
2021-12-10 02:44:23.017114 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.044904 (Thread-1): SQL status: BEGIN in 0.03 seconds
2021-12-10 02:44:23.045427 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 02:44:23.045764 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-12-10 02:44:23.053952 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.059922 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.060478 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
2021-12-10 02:44:23.064416 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
2021-12-10 02:44:23.065562 (Thread-1): 09:44:23 | 1 of 8 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 0.16s]
2021-12-10 02:44:23.066566 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 02:44:23.067520 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:44:23.068336 (Thread-1): 09:44:23 | 2 of 8 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [RUN]
2021-12-10 02:44:23.069452 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:44:23.070040 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:44:23.091321 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 02:44:23.093819 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.102429 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 02:44:23.104349 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:44:23.104878 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
2021-12-10 02:44:23.105213 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.198575 (Thread-1): SQL status: BEGIN in 0.09 seconds
2021-12-10 02:44:23.199952 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 02:44:23.201736 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
2021-12-10 02:44:23.221517 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2021-12-10 02:44:23.228899 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.230395 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
2021-12-10 02:44:23.240346 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
2021-12-10 02:44:23.242802 (Thread-1): 09:44:23 | 2 of 8 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [PASS in 0.17s]
2021-12-10 02:44:23.243742 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 02:44:23.245087 (Thread-1): Began running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:44:23.246415 (Thread-1): 09:44:23 | 3 of 8 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-10 02:44:23.247806 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:44:23.248626 (Thread-1): Compiling test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:44:23.295473 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 02:44:23.298812 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.309887 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 02:44:23.312533 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:44:23.313169 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
2021-12-10 02:44:23.313704 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.365243 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:44:23.365766 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 02:44:23.366301 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
2021-12-10 02:44:23.373121 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.376696 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.377274 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
2021-12-10 02:44:23.384209 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-10 02:44:23.385940 (Thread-1): 09:44:23 | 3 of 8 PASS not_null_stg_customers_customer_id....................... [PASS in 0.14s]
2021-12-10 02:44:23.387553 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 02:44:23.388873 (Thread-1): Began running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:44:23.390380 (Thread-1): 09:44:23 | 4 of 8 START test not_null_stg_orders_order_id....................... [RUN]
2021-12-10 02:44:23.393688 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:44:23.396021 (Thread-1): Compiling test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:44:23.422657 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 02:44:23.424252 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.465643 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 02:44:23.469362 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:44:23.469974 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
2021-12-10 02:44:23.470490 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.587717 (Thread-1): SQL status: BEGIN in 0.12 seconds
2021-12-10 02:44:23.588530 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 02:44:23.589229 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
2021-12-10 02:44:23.598566 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.603954 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.604802 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
2021-12-10 02:44:23.613172 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
2021-12-10 02:44:23.615265 (Thread-1): 09:44:23 | 4 of 8 PASS not_null_stg_orders_order_id............................. [PASS in 0.22s]
2021-12-10 02:44:23.616022 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 02:44:23.616931 (Thread-1): Began running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:44:23.618188 (Thread-1): 09:44:23 | 5 of 8 START test not_null_stg_payments_payment_id................... [RUN]
2021-12-10 02:44:23.619548 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:44:23.620012 (Thread-1): Compiling test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:44:23.638793 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 02:44:23.640225 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.652665 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 02:44:23.654882 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:44:23.655506 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: BEGIN
2021-12-10 02:44:23.657251 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.724581 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 02:44:23.725145 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 02:44:23.725502 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
2021-12-10 02:44:23.733518 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.739952 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.740503 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
2021-12-10 02:44:23.746352 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: Close
2021-12-10 02:44:23.748598 (Thread-1): 09:44:23 | 5 of 8 PASS not_null_stg_payments_payment_id......................... [PASS in 0.13s]
2021-12-10 02:44:23.749576 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 02:44:23.750626 (Thread-1): Began running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:44:23.751687 (Thread-1): 09:44:23 | 6 of 8 START test unique_stg_customers_customer_id................... [RUN]
2021-12-10 02:44:23.753552 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:44:23.754348 (Thread-1): Compiling test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:44:23.791949 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 02:44:23.794200 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.804719 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 02:44:23.806538 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:44:23.807513 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
2021-12-10 02:44:23.807900 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.852525 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 02:44:23.853204 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 02:44:23.853547 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:44:23.862950 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.867110 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.867676 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
2021-12-10 02:44:23.872225 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: Close
2021-12-10 02:44:23.873890 (Thread-1): 09:44:23 | 6 of 8 PASS unique_stg_customers_customer_id......................... [PASS in 0.12s]
2021-12-10 02:44:23.874426 (Thread-1): Finished running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 02:44:23.875617 (Thread-1): Began running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:44:23.876453 (Thread-1): 09:44:23 | 7 of 8 START test unique_stg_orders_order_id......................... [RUN]
2021-12-10 02:44:23.877615 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:44:23.878072 (Thread-1): Compiling test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:44:23.887286 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 02:44:23.888927 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.898316 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 02:44:23.900760 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:44:23.901223 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
2021-12-10 02:44:23.901681 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:23.952392 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:44:23.952980 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 02:44:23.953504 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:44:23.966021 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:23.970825 (Thread-1): finished collecting timing info
2021-12-10 02:44:23.971384 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
2021-12-10 02:44:23.977513 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: Close
2021-12-10 02:44:23.978828 (Thread-1): 09:44:23 | 7 of 8 PASS unique_stg_orders_order_id............................... [PASS in 0.10s]
2021-12-10 02:44:23.979540 (Thread-1): Finished running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 02:44:23.980134 (Thread-1): Began running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:44:23.981102 (Thread-1): 09:44:23 | 8 of 8 START test unique_stg_payments_payment_id..................... [RUN]
2021-12-10 02:44:23.982542 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:44:23.983258 (Thread-1): Compiling test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:44:23.997689 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 02:44:24.001510 (Thread-1): finished collecting timing info
2021-12-10 02:44:24.010326 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 02:44:24.014154 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:44:24.017966 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: BEGIN
2021-12-10 02:44:24.018490 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 02:44:24.071639 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 02:44:24.072137 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 02:44:24.072470 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 02:44:24.080650 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 02:44:24.085159 (Thread-1): finished collecting timing info
2021-12-10 02:44:24.085696 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: ROLLBACK
2021-12-10 02:44:24.089685 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: Close
2021-12-10 02:44:24.091171 (Thread-1): 09:44:24 | 8 of 8 PASS unique_stg_payments_payment_id........................... [PASS in 0.11s]
2021-12-10 02:44:24.092096 (Thread-1): Finished running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 02:44:24.096191 (MainThread): Acquiring new postgres connection "master".
2021-12-10 02:44:24.097621 (MainThread): 09:44:24 | 
2021-12-10 02:44:24.098091 (MainThread): 09:44:24 | Finished running 8 tests in 3.86s.
2021-12-10 02:44:24.098511 (MainThread): Connection 'master' was properly closed.
2021-12-10 02:44:24.099006 (MainThread): Connection 'test.waresix_dbt.unique_stg_payments_payment_id.3744510712' was properly closed.
2021-12-10 02:44:24.125484 (MainThread): 
2021-12-10 02:44:24.126055 (MainThread): Completed successfully
2021-12-10 02:44:24.126919 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-10 02:44:24.127608 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112b8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b9640>]}
2021-12-10 02:44:24.128215 (MainThread): Flushing usage events
2021-12-10 08:14:37.244876 (MainThread): Running with dbt=0.21.0
2021-12-10 08:14:38.197586 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-12-10 08:14:38.203906 (MainThread): Tracking: tracking
2021-12-10 08:14:38.306443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a04a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a17430>]}
2021-12-10 08:14:38.389029 (MainThread): Partial parsing not enabled
2021-12-10 08:14:38.492078 (MainThread): Parsing macros/catalog.sql
2021-12-10 08:14:38.510082 (MainThread): Parsing macros/relations.sql
2021-12-10 08:14:38.517580 (MainThread): Parsing macros/adapters.sql
2021-12-10 08:14:38.824662 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 08:14:38.842632 (MainThread): Parsing macros/core.sql
2021-12-10 08:14:38.913382 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 08:14:39.047110 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 08:14:39.261442 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 08:14:39.282965 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 08:14:39.787575 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 08:14:40.454588 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 08:14:40.795434 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 08:14:40.812886 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 08:14:40.998099 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 08:14:41.352584 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 08:14:41.784409 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 08:14:41.866358 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 08:14:41.931875 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 08:14:41.976067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 08:14:41.987937 (MainThread): Parsing macros/etc/query.sql
2021-12-10 08:14:41.993716 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 08:14:42.007687 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 08:14:42.083816 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 08:14:42.100520 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 08:14:42.118823 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 08:14:42.148111 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 08:14:42.816492 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 08:14:42.886931 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 08:14:42.902653 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 08:14:42.912034 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 08:14:44.956604 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 08:14:45.158848 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 08:14:45.759264 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:14:45.807117 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:14:45.828420 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:14:46.279182 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.289297 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.301753 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.310452 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.321742 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.408780 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.481029 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.482154 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.492308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.502473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.514747 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.523447 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.541169 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.583731 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.593328 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.630379 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.665289 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.725749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.727372 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.752820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.796120 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.898260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:46.905220 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:14:47.222484 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07a4df94-ac77-4f8c-b22d-04aa08c900f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0b130>]}
2021-12-10 08:14:47.303335 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 08:14:47.307517 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07a4df94-ac77-4f8c-b22d-04aa08c900f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b5c970>]}
2021-12-10 08:14:47.310476 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 08:14:47.344778 (MainThread): 
2021-12-10 08:14:47.346214 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:14:47.367178 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 08:14:47.476615 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 08:14:47.477369 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 08:14:47.479423 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 08:14:49.162077 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 1.68 seconds
2021-12-10 08:14:49.169746 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 08:14:49.176336 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 08:14:49.210234 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:14:49.210922 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 08:14:49.211460 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 08:14:49.319223 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.11 seconds
2021-12-10 08:14:49.320101 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:14:49.320597 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 08:14:49.404990 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.08 seconds
2021-12-10 08:14:49.410632 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 08:14:49.424663 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 08:14:49.448634 (MainThread): Using postgres connection "master".
2021-12-10 08:14:49.449309 (MainThread): On master: BEGIN
2021-12-10 08:14:49.449856 (MainThread): Opening a new connection, currently in state init
2021-12-10 08:14:49.526807 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-10 08:14:49.528420 (MainThread): Using postgres connection "master".
2021-12-10 08:14:49.529236 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 08:14:54.320914 (MainThread): SQL status: SELECT 0 in 4.79 seconds
2021-12-10 08:14:54.324308 (MainThread): On master: ROLLBACK
2021-12-10 08:14:54.333097 (MainThread): Using postgres connection "master".
2021-12-10 08:14:54.333801 (MainThread): On master: BEGIN
2021-12-10 08:14:54.351902 (MainThread): SQL status: BEGIN in 0.02 seconds
2021-12-10 08:14:54.352710 (MainThread): On master: COMMIT
2021-12-10 08:14:54.353085 (MainThread): Using postgres connection "master".
2021-12-10 08:14:54.353401 (MainThread): On master: COMMIT
2021-12-10 08:14:54.360370 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:14:54.361286 (MainThread): On master: Close
2021-12-10 08:14:54.362553 (MainThread): 15:14:54 | Concurrency: 1 threads (target='dev')
2021-12-10 08:14:54.363079 (MainThread): 15:14:54 | 
2021-12-10 08:14:54.382355 (Thread-1): Began running node seed.waresix_dbt.raw_customers
2021-12-10 08:14:54.383902 (Thread-1): 15:14:54 | 1 of 3 START seed file dbt_local.raw_customers....................... [RUN]
2021-12-10 08:14:54.385530 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:14:54.386267 (Thread-1): finished collecting timing info
2021-12-10 08:14:55.106403 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:14:55.107261 (Thread-1): On seed.waresix_dbt.raw_customers: BEGIN
2021-12-10 08:14:55.108005 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:14:55.262384 (Thread-1): SQL status: BEGIN in 0.15 seconds
2021-12-10 08:14:55.263134 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:14:55.263763 (Thread-1): On seed.waresix_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_customers"} */
truncate table "postgres"."dbt_local"."raw_customers"
2021-12-10 08:14:55.334604 (Thread-1): SQL status: TRUNCATE TABLE in 0.07 seconds
2021-12-10 08:14:55.753533 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:14:55.754236 (Thread-1): On seed.waresix_dbt.raw_customers: 
          insert into "postgres"."dbt_local"."raw_customers" (id, first_name, last_name) values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
2021-12-10 08:14:55.783604 (Thread-1): SQL status: INSERT 0 100 in 0.03 seconds
2021-12-10 08:14:55.816235 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_customers"
2021-12-10 08:14:55.904192 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 08:14:55.904890 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:14:55.905428 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 08:14:55.966384 (Thread-1): SQL status: COMMIT in 0.06 seconds
2021-12-10 08:14:55.981396 (Thread-1): finished collecting timing info
2021-12-10 08:14:55.982393 (Thread-1): On seed.waresix_dbt.raw_customers: Close
2021-12-10 08:14:55.985430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a4df94-ac77-4f8c-b22d-04aa08c900f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c86e20>]}
2021-12-10 08:14:55.990346 (Thread-1): 15:14:55 | 1 of 3 OK loaded seed file dbt_local.raw_customers................... [INSERT 100 in 1.60s]
2021-12-10 08:14:55.995461 (Thread-1): Finished running node seed.waresix_dbt.raw_customers
2021-12-10 08:14:55.997386 (Thread-1): Began running node seed.waresix_dbt.raw_orders
2021-12-10 08:14:56.003519 (Thread-1): 15:14:56 | 2 of 3 START seed file dbt_local.raw_orders.......................... [RUN]
2021-12-10 08:14:56.006915 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:14:56.010390 (Thread-1): finished collecting timing info
2021-12-10 08:14:56.289430 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:14:56.290120 (Thread-1): On seed.waresix_dbt.raw_orders: BEGIN
2021-12-10 08:14:56.290714 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:14:56.382860 (Thread-1): SQL status: BEGIN in 0.09 seconds
2021-12-10 08:14:56.384912 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:14:56.385643 (Thread-1): On seed.waresix_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_orders"} */
truncate table "postgres"."dbt_local"."raw_orders"
2021-12-10 08:14:56.420697 (Thread-1): SQL status: TRUNCATE TABLE in 0.03 seconds
2021-12-10 08:14:56.939103 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:14:56.940800 (Thread-1): On seed.waresix_dbt.raw_orders: 
          insert into "postgres"."dbt_local"."raw_orders" (id, user_id, order_date, status) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
2021-12-10 08:14:56.965314 (Thread-1): SQL status: INSERT 0 99 in 0.02 seconds
2021-12-10 08:14:56.967093 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_orders"
2021-12-10 08:14:56.975373 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 08:14:56.977096 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:14:56.978543 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 08:14:56.993733 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:14:56.995586 (Thread-1): finished collecting timing info
2021-12-10 08:14:56.996479 (Thread-1): On seed.waresix_dbt.raw_orders: Close
2021-12-10 08:14:56.998266 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a4df94-ac77-4f8c-b22d-04aa08c900f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc2e20>]}
2021-12-10 08:14:57.000131 (Thread-1): 15:14:56 | 2 of 3 OK loaded seed file dbt_local.raw_orders...................... [INSERT 99 in 0.99s]
2021-12-10 08:14:57.001318 (Thread-1): Finished running node seed.waresix_dbt.raw_orders
2021-12-10 08:14:57.002951 (Thread-1): Began running node seed.waresix_dbt.raw_payments
2021-12-10 08:14:57.004851 (Thread-1): 15:14:57 | 3 of 3 START seed file dbt_local.raw_payments........................ [RUN]
2021-12-10 08:14:57.006356 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:14:57.006995 (Thread-1): finished collecting timing info
2021-12-10 08:14:57.089140 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:14:57.089788 (Thread-1): On seed.waresix_dbt.raw_payments: BEGIN
2021-12-10 08:14:57.090592 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:14:57.158603 (Thread-1): SQL status: BEGIN in 0.07 seconds
2021-12-10 08:14:57.159295 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:14:57.159795 (Thread-1): On seed.waresix_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_payments"} */
truncate table "postgres"."dbt_local"."raw_payments"
2021-12-10 08:14:57.184568 (Thread-1): SQL status: TRUNCATE TABLE in 0.02 seconds
2021-12-10 08:14:57.444128 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:14:57.444786 (Thread-1): On seed.waresix_dbt.raw_payments: 
          insert into "postgres"."dbt_local"."raw_payments" (id, order_id, payment_method, amount) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
2021-12-10 08:14:57.498934 (Thread-1): SQL status: INSERT 0 113 in 0.05 seconds
2021-12-10 08:14:57.500720 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_payments"
2021-12-10 08:14:57.518406 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 08:14:57.519922 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:14:57.521592 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 08:14:57.567174 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-10 08:14:57.573140 (Thread-1): finished collecting timing info
2021-12-10 08:14:57.574575 (Thread-1): On seed.waresix_dbt.raw_payments: Close
2021-12-10 08:14:57.577159 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07a4df94-ac77-4f8c-b22d-04aa08c900f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9d790>]}
2021-12-10 08:14:57.587959 (Thread-1): 15:14:57 | 3 of 3 OK loaded seed file dbt_local.raw_payments.................... [INSERT 113 in 0.57s]
2021-12-10 08:14:57.589432 (Thread-1): Finished running node seed.waresix_dbt.raw_payments
2021-12-10 08:14:57.603915 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:14:57.605266 (MainThread): Using postgres connection "master".
2021-12-10 08:14:57.606100 (MainThread): On master: BEGIN
2021-12-10 08:14:57.606734 (MainThread): Opening a new connection, currently in state closed
2021-12-10 08:14:57.755415 (MainThread): SQL status: BEGIN in 0.15 seconds
2021-12-10 08:14:57.756509 (MainThread): On master: COMMIT
2021-12-10 08:14:57.757118 (MainThread): Using postgres connection "master".
2021-12-10 08:14:57.758200 (MainThread): On master: COMMIT
2021-12-10 08:14:57.768193 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:14:57.768979 (MainThread): On master: Close
2021-12-10 08:14:57.770832 (MainThread): 15:14:57 | 
2021-12-10 08:14:57.771921 (MainThread): 15:14:57 | Finished running 3 seeds in 10.42s.
2021-12-10 08:14:57.772529 (MainThread): Connection 'master' was properly closed.
2021-12-10 08:14:57.773109 (MainThread): Connection 'seed.waresix_dbt.raw_payments' was properly closed.
2021-12-10 08:14:57.808609 (MainThread): 
2021-12-10 08:14:57.809734 (MainThread): Completed successfully
2021-12-10 08:14:57.810451 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 08:14:57.811392 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0b610>]}
2021-12-10 08:14:57.812897 (MainThread): Flushing usage events
2021-12-10 08:16:27.238446 (MainThread): Running with dbt=0.21.0
2021-12-10 08:16:27.745389 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='seed', select=None, selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-12-10 08:16:27.751126 (MainThread): Tracking: tracking
2021-12-10 08:16:27.915746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d72f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d74ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d762490>]}
2021-12-10 08:16:27.981242 (MainThread): Partial parsing not enabled
2021-12-10 08:16:28.093176 (MainThread): Parsing macros/catalog.sql
2021-12-10 08:16:28.111729 (MainThread): Parsing macros/relations.sql
2021-12-10 08:16:28.120390 (MainThread): Parsing macros/adapters.sql
2021-12-10 08:16:28.348974 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 08:16:28.359087 (MainThread): Parsing macros/core.sql
2021-12-10 08:16:28.382550 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 08:16:28.427101 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 08:16:28.505841 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 08:16:28.513941 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 08:16:28.600663 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 08:16:28.787863 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 08:16:28.921295 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 08:16:28.930028 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 08:16:28.977057 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 08:16:29.079086 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 08:16:29.153592 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 08:16:29.207136 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 08:16:29.264319 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 08:16:29.302432 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 08:16:29.324035 (MainThread): Parsing macros/etc/query.sql
2021-12-10 08:16:29.345029 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 08:16:29.354489 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 08:16:29.413011 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 08:16:29.429343 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 08:16:29.459662 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 08:16:29.469754 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 08:16:29.776653 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 08:16:29.785220 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 08:16:29.791255 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 08:16:29.797050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 08:16:30.779827 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 08:16:30.862878 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 08:16:30.983086 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:16:30.998686 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:16:31.012714 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:16:31.762081 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:31.782794 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:31.823913 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:31.850019 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:31.875711 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:31.985133 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.094341 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.096066 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.116033 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.142624 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.166680 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.178593 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.191642 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.214187 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.220636 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.231425 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.242992 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.274354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.275958 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.286676 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.300694 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.340523 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.349742 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:32.478256 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e740ba-cc62-421a-be87-27313f70deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d702ac0>]}
2021-12-10 08:16:32.507581 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 08:16:32.509658 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e740ba-cc62-421a-be87-27313f70deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d85b940>]}
2021-12-10 08:16:32.511147 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 08:16:32.537080 (MainThread): 
2021-12-10 08:16:32.540860 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:16:32.549422 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 08:16:32.626834 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 08:16:32.628502 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 08:16:32.629138 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 08:16:32.966245 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.34 seconds
2021-12-10 08:16:32.971138 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 08:16:32.972937 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 08:16:32.974006 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_postgres_dbt_local".
2021-12-10 08:16:32.974835 (ThreadPoolExecutor-0_0): Creating schema ""postgres"."dbt_local""
2021-12-10 08:16:32.997065 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 08:16:32.997515 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: BEGIN
2021-12-10 08:16:32.997995 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-10 08:16:33.040741 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:16:33.041455 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 08:16:33.042309 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "create_postgres_dbt_local"} */
create schema if not exists "dbt_local"
2021-12-10 08:16:33.061829 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.02 seconds
2021-12-10 08:16:33.065964 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 08:16:33.066781 (ThreadPoolExecutor-0_0): Using postgres connection "create_postgres_dbt_local".
2021-12-10 08:16:33.067268 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: COMMIT
2021-12-10 08:16:33.076610 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:16:33.077450 (ThreadPoolExecutor-0_0): On create_postgres_dbt_local: Close
2021-12-10 08:16:33.084416 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 08:16:33.113894 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:16:33.114545 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 08:16:33.115064 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 08:16:33.197822 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.08 seconds
2021-12-10 08:16:33.198512 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:16:33.199014 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 08:16:33.222386 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.02 seconds
2021-12-10 08:16:33.226560 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 08:16:33.234360 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 08:16:33.254084 (MainThread): Using postgres connection "master".
2021-12-10 08:16:33.254834 (MainThread): On master: BEGIN
2021-12-10 08:16:33.255667 (MainThread): Opening a new connection, currently in state init
2021-12-10 08:16:33.402168 (MainThread): SQL status: BEGIN in 0.15 seconds
2021-12-10 08:16:33.402855 (MainThread): Using postgres connection "master".
2021-12-10 08:16:33.403568 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 08:16:35.795016 (MainThread): SQL status: SELECT 0 in 2.39 seconds
2021-12-10 08:16:35.801480 (MainThread): On master: ROLLBACK
2021-12-10 08:16:35.809936 (MainThread): Using postgres connection "master".
2021-12-10 08:16:35.810671 (MainThread): On master: BEGIN
2021-12-10 08:16:35.823380 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 08:16:35.823919 (MainThread): On master: COMMIT
2021-12-10 08:16:35.824279 (MainThread): Using postgres connection "master".
2021-12-10 08:16:35.824610 (MainThread): On master: COMMIT
2021-12-10 08:16:35.829480 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 08:16:35.830303 (MainThread): On master: Close
2021-12-10 08:16:35.831687 (MainThread): 15:16:35 | Concurrency: 1 threads (target='dev')
2021-12-10 08:16:35.832261 (MainThread): 15:16:35 | 
2021-12-10 08:16:35.842541 (Thread-1): Began running node seed.waresix_dbt.raw_customers
2021-12-10 08:16:35.843845 (Thread-1): 15:16:35 | 1 of 3 START seed file dbt_local.raw_customers....................... [RUN]
2021-12-10 08:16:35.845110 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:16:35.846001 (Thread-1): finished collecting timing info
2021-12-10 08:16:36.048353 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:36.049437 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:36.050491 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:36.052046 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:16:36.052904 (Thread-1): On seed.waresix_dbt.raw_customers: BEGIN
2021-12-10 08:16:36.053502 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:16:36.114783 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 08:16:36.116916 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:16:36.117959 (Thread-1): On seed.waresix_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_customers"} */

    create table "postgres"."dbt_local"."raw_customers" (id integer,first_name text,last_name text)
  
2021-12-10 08:16:36.171092 (Thread-1): SQL status: CREATE TABLE in 0.05 seconds
2021-12-10 08:16:36.832836 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:16:36.833787 (Thread-1): On seed.waresix_dbt.raw_customers: 
          insert into "postgres"."dbt_local"."raw_customers" (id, first_name, last_name) values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
2021-12-10 08:16:36.871040 (Thread-1): SQL status: INSERT 0 100 in 0.03 seconds
2021-12-10 08:16:36.902670 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_customers"
2021-12-10 08:16:37.024372 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 08:16:37.025241 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_customers".
2021-12-10 08:16:37.025802 (Thread-1): On seed.waresix_dbt.raw_customers: COMMIT
2021-12-10 08:16:37.042667 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-12-10 08:16:37.044517 (Thread-1): finished collecting timing info
2021-12-10 08:16:37.046509 (Thread-1): On seed.waresix_dbt.raw_customers: Close
2021-12-10 08:16:37.052802 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e740ba-cc62-421a-be87-27313f70deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d99f5e0>]}
2021-12-10 08:16:37.054538 (Thread-1): 15:16:37 | 1 of 3 OK loaded seed file dbt_local.raw_customers................... [INSERT 100 in 1.21s]
2021-12-10 08:16:37.056079 (Thread-1): Finished running node seed.waresix_dbt.raw_customers
2021-12-10 08:16:37.062941 (Thread-1): Began running node seed.waresix_dbt.raw_orders
2021-12-10 08:16:37.066047 (Thread-1): 15:16:37 | 2 of 3 START seed file dbt_local.raw_orders.......................... [RUN]
2021-12-10 08:16:37.067826 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:16:37.069986 (Thread-1): finished collecting timing info
2021-12-10 08:16:37.206871 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.210181 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.210944 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.211685 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.212950 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:16:37.214033 (Thread-1): On seed.waresix_dbt.raw_orders: BEGIN
2021-12-10 08:16:37.214674 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:16:37.270483 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 08:16:37.271312 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:16:37.271892 (Thread-1): On seed.waresix_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_orders"} */

    create table "postgres"."dbt_local"."raw_orders" (id integer,user_id integer,order_date date,status text)
  
2021-12-10 08:16:37.301250 (Thread-1): SQL status: CREATE TABLE in 0.03 seconds
2021-12-10 08:16:37.541826 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:16:37.542274 (Thread-1): On seed.waresix_dbt.raw_orders: 
          insert into "postgres"."dbt_local"."raw_orders" (id, user_id, order_date, status) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
2021-12-10 08:16:37.557083 (Thread-1): SQL status: INSERT 0 99 in 0.01 seconds
2021-12-10 08:16:37.558734 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_orders"
2021-12-10 08:16:37.564687 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 08:16:37.566119 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_orders".
2021-12-10 08:16:37.566530 (Thread-1): On seed.waresix_dbt.raw_orders: COMMIT
2021-12-10 08:16:37.577401 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:16:37.580008 (Thread-1): finished collecting timing info
2021-12-10 08:16:37.581180 (Thread-1): On seed.waresix_dbt.raw_orders: Close
2021-12-10 08:16:37.584487 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e740ba-cc62-421a-be87-27313f70deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9a35b0>]}
2021-12-10 08:16:37.586813 (Thread-1): 15:16:37 | 2 of 3 OK loaded seed file dbt_local.raw_orders...................... [INSERT 99 in 0.52s]
2021-12-10 08:16:37.587555 (Thread-1): Finished running node seed.waresix_dbt.raw_orders
2021-12-10 08:16:37.588284 (Thread-1): Began running node seed.waresix_dbt.raw_payments
2021-12-10 08:16:37.590610 (Thread-1): 15:16:37 | 3 of 3 START seed file dbt_local.raw_payments........................ [RUN]
2021-12-10 08:16:37.591719 (Thread-1): Acquiring new postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:16:37.592155 (Thread-1): finished collecting timing info
2021-12-10 08:16:37.626541 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.628311 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.629062 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.631918 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:16:37.633051 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:16:37.633499 (Thread-1): On seed.waresix_dbt.raw_payments: BEGIN
2021-12-10 08:16:37.633823 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:16:37.677877 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:16:37.678525 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:16:37.678992 (Thread-1): On seed.waresix_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "seed.waresix_dbt.raw_payments"} */

    create table "postgres"."dbt_local"."raw_payments" (id integer,order_id integer,payment_method text,amount integer)
  
2021-12-10 08:16:37.718793 (Thread-1): SQL status: CREATE TABLE in 0.04 seconds
2021-12-10 08:16:38.034784 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:16:38.035705 (Thread-1): On seed.waresix_dbt.raw_payments: 
          insert into "postgres"."dbt_local"."raw_payments" (id, order_id, payment_method, amount) values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s...
2021-12-10 08:16:38.049479 (Thread-1): SQL status: INSERT 0 113 in 0.01 seconds
2021-12-10 08:16:38.050837 (Thread-1): Writing runtime SQL for node "seed.waresix_dbt.raw_payments"
2021-12-10 08:16:38.056657 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 08:16:38.057845 (Thread-1): Using postgres connection "seed.waresix_dbt.raw_payments".
2021-12-10 08:16:38.058479 (Thread-1): On seed.waresix_dbt.raw_payments: COMMIT
2021-12-10 08:16:38.065984 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:16:38.067588 (Thread-1): finished collecting timing info
2021-12-10 08:16:38.068465 (Thread-1): On seed.waresix_dbt.raw_payments: Close
2021-12-10 08:16:38.070081 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75e740ba-cc62-421a-be87-27313f70deab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92d340>]}
2021-12-10 08:16:38.071355 (Thread-1): 15:16:38 | 3 of 3 OK loaded seed file dbt_local.raw_payments.................... [INSERT 113 in 0.48s]
2021-12-10 08:16:38.072233 (Thread-1): Finished running node seed.waresix_dbt.raw_payments
2021-12-10 08:16:38.076351 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:16:38.076922 (MainThread): Using postgres connection "master".
2021-12-10 08:16:38.077293 (MainThread): On master: BEGIN
2021-12-10 08:16:38.077675 (MainThread): Opening a new connection, currently in state closed
2021-12-10 08:16:38.154447 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-10 08:16:38.155613 (MainThread): On master: COMMIT
2021-12-10 08:16:38.156504 (MainThread): Using postgres connection "master".
2021-12-10 08:16:38.157350 (MainThread): On master: COMMIT
2021-12-10 08:16:38.163739 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:16:38.164672 (MainThread): On master: Close
2021-12-10 08:16:38.166325 (MainThread): 15:16:38 | 
2021-12-10 08:16:38.167001 (MainThread): 15:16:38 | Finished running 3 seeds in 5.63s.
2021-12-10 08:16:38.167773 (MainThread): Connection 'master' was properly closed.
2021-12-10 08:16:38.168372 (MainThread): Connection 'seed.waresix_dbt.raw_payments' was properly closed.
2021-12-10 08:16:38.207737 (MainThread): 
2021-12-10 08:16:38.208518 (MainThread): Completed successfully
2021-12-10 08:16:38.209107 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 08:16:38.210207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7023a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d702eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da224c0>]}
2021-12-10 08:16:38.211151 (MainThread): Flushing usage events
2021-12-10 08:21:58.122354 (MainThread): Running with dbt=0.21.0
2021-12-10 08:21:58.463993 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:stg'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-10 08:21:58.467773 (MainThread): Tracking: tracking
2021-12-10 08:21:58.512345 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae124f0>]}
2021-12-10 08:21:58.555624 (MainThread): Partial parsing not enabled
2021-12-10 08:21:58.623531 (MainThread): Parsing macros/catalog.sql
2021-12-10 08:21:58.636723 (MainThread): Parsing macros/relations.sql
2021-12-10 08:21:58.643039 (MainThread): Parsing macros/adapters.sql
2021-12-10 08:21:58.740350 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 08:21:58.746180 (MainThread): Parsing macros/core.sql
2021-12-10 08:21:58.760934 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 08:21:58.785283 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 08:21:58.820894 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 08:21:58.826237 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 08:21:58.920465 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 08:21:59.065982 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 08:21:59.163890 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 08:21:59.169999 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 08:21:59.205194 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 08:21:59.275610 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 08:21:59.323068 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 08:21:59.349378 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 08:21:59.373849 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 08:21:59.387256 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 08:21:59.392263 (MainThread): Parsing macros/etc/query.sql
2021-12-10 08:21:59.395717 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 08:21:59.400839 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 08:21:59.430483 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 08:21:59.436883 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 08:21:59.445307 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 08:21:59.450751 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 08:21:59.646141 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 08:21:59.655026 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 08:21:59.662969 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 08:21:59.668047 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 08:22:00.420968 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 08:22:00.473490 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 08:22:00.553519 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:00.565187 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:00.577007 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:00.766423 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.772185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.779332 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.785052 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.790718 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.816302 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.851200 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.852080 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.861026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.868252 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.874948 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.882027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.887908 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.906686 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.912176 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.918027 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.924702 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.945267 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.946952 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.953308 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.960431 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.984434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:00.985500 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:22:01.070205 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485668be-7e41-4fd1-9bb2-77073af2b3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add6700>]}
2021-12-10 08:22:01.102631 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 08:22:01.104629 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485668be-7e41-4fd1-9bb2-77073af2b3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10add9fd0>]}
2021-12-10 08:22:01.105555 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 08:22:01.116698 (MainThread): 
2021-12-10 08:22:01.118119 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:22:01.121701 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2021-12-10 08:22:01.176825 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2021-12-10 08:22:01.177593 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2021-12-10 08:22:01.177954 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-10 08:22:01.441173 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.26 seconds
2021-12-10 08:22:01.444790 (ThreadPoolExecutor-0_0): On list_postgres: Close
2021-12-10 08:22:01.449970 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 08:22:01.471288 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:22:01.471785 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 08:22:01.472130 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-10 08:22:01.507974 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:22:01.508691 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:22:01.509493 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 08:22:01.520871 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2021-12-10 08:22:01.524253 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 08:22:01.529157 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 08:22:01.543387 (MainThread): Using postgres connection "master".
2021-12-10 08:22:01.544023 (MainThread): On master: BEGIN
2021-12-10 08:22:01.544818 (MainThread): Opening a new connection, currently in state init
2021-12-10 08:22:01.575037 (MainThread): SQL status: BEGIN in 0.03 seconds
2021-12-10 08:22:01.575550 (MainThread): Using postgres connection "master".
2021-12-10 08:22:01.575902 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 08:22:03.527700 (MainThread): SQL status: SELECT 0 in 1.95 seconds
2021-12-10 08:22:03.531527 (MainThread): On master: ROLLBACK
2021-12-10 08:22:03.536860 (MainThread): Using postgres connection "master".
2021-12-10 08:22:03.537378 (MainThread): On master: BEGIN
2021-12-10 08:22:03.545718 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-12-10 08:22:03.546405 (MainThread): On master: COMMIT
2021-12-10 08:22:03.546782 (MainThread): Using postgres connection "master".
2021-12-10 08:22:03.547087 (MainThread): On master: COMMIT
2021-12-10 08:22:03.552394 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-12-10 08:22:03.552934 (MainThread): On master: Close
2021-12-10 08:22:03.554355 (MainThread): 15:22:03 | Concurrency: 1 threads (target='dev')
2021-12-10 08:22:03.555024 (MainThread): 15:22:03 | 
2021-12-10 08:22:03.561477 (Thread-1): Began running node model.waresix_dbt.stg_customers
2021-12-10 08:22:03.562326 (Thread-1): 15:22:03 | 1 of 3 START table model dbt_local.stg_customers..................... [RUN]
2021-12-10 08:22:03.563435 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.564218 (Thread-1): Compiling model.waresix_dbt.stg_customers
2021-12-10 08:22:03.571173 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 08:22:03.575788 (Thread-1): finished collecting timing info
2021-12-10 08:22:03.663363 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_customers"
2021-12-10 08:22:03.664787 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.665274 (Thread-1): On model.waresix_dbt.stg_customers: BEGIN
2021-12-10 08:22:03.665597 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:22:03.701337 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:22:03.701881 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.702220 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */


  create  table "postgres"."dbt_local"."stg_customers__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_customers"

),

renamed as (

    select
        id as customer_id,
        first_name,
        last_name

    from source

)

select * from renamed
  );
2021-12-10 08:22:03.724096 (Thread-1): SQL status: SELECT 100 in 0.02 seconds
2021-12-10 08:22:03.742789 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.743237 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
alter table "postgres"."dbt_local"."stg_customers__dbt_tmp" rename to "stg_customers"
2021-12-10 08:22:03.750992 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 08:22:03.783915 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 08:22:03.784522 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.784861 (Thread-1): On model.waresix_dbt.stg_customers: COMMIT
2021-12-10 08:22:03.792168 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:22:03.805655 (Thread-1): Using postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:22:03.806127 (Thread-1): On model.waresix_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_customers"} */
drop table if exists "postgres"."dbt_local"."stg_customers__dbt_backup" cascade
2021-12-10 08:22:03.812584 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 08:22:03.816000 (Thread-1): finished collecting timing info
2021-12-10 08:22:03.816590 (Thread-1): On model.waresix_dbt.stg_customers: Close
2021-12-10 08:22:03.817866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485668be-7e41-4fd1-9bb2-77073af2b3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b018d30>]}
2021-12-10 08:22:03.819516 (Thread-1): 15:22:03 | 1 of 3 OK created table model dbt_local.stg_customers................ [SELECT 100 in 0.25s]
2021-12-10 08:22:03.820090 (Thread-1): Finished running node model.waresix_dbt.stg_customers
2021-12-10 08:22:03.820557 (Thread-1): Began running node model.waresix_dbt.stg_orders
2021-12-10 08:22:03.821186 (Thread-1): 15:22:03 | 2 of 3 START table model dbt_local.stg_orders........................ [RUN]
2021-12-10 08:22:03.822230 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.822647 (Thread-1): Compiling model.waresix_dbt.stg_orders
2021-12-10 08:22:03.829140 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 08:22:03.831381 (Thread-1): finished collecting timing info
2021-12-10 08:22:03.847079 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_orders"
2021-12-10 08:22:03.849432 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.850223 (Thread-1): On model.waresix_dbt.stg_orders: BEGIN
2021-12-10 08:22:03.850861 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:22:03.900192 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 08:22:03.900697 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.901028 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */


  create  table "postgres"."dbt_local"."stg_orders__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_orders"

),

renamed as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from source

)

select * from renamed
  );
2021-12-10 08:22:03.919579 (Thread-1): SQL status: SELECT 99 in 0.02 seconds
2021-12-10 08:22:03.925661 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.926116 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
alter table "postgres"."dbt_local"."stg_orders__dbt_tmp" rename to "stg_orders"
2021-12-10 08:22:03.931623 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 08:22:03.935657 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 08:22:03.936090 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.936406 (Thread-1): On model.waresix_dbt.stg_orders: COMMIT
2021-12-10 08:22:03.942470 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:22:03.946497 (Thread-1): Using postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:22:03.946924 (Thread-1): On model.waresix_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_orders"} */
drop table if exists "postgres"."dbt_local"."stg_orders__dbt_backup" cascade
2021-12-10 08:22:03.952150 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-12-10 08:22:03.956178 (Thread-1): finished collecting timing info
2021-12-10 08:22:03.956741 (Thread-1): On model.waresix_dbt.stg_orders: Close
2021-12-10 08:22:03.957716 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485668be-7e41-4fd1-9bb2-77073af2b3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b00aa30>]}
2021-12-10 08:22:03.959225 (Thread-1): 15:22:03 | 2 of 3 OK created table model dbt_local.stg_orders................... [SELECT 99 in 0.14s]
2021-12-10 08:22:03.960130 (Thread-1): Finished running node model.waresix_dbt.stg_orders
2021-12-10 08:22:03.960863 (Thread-1): Began running node model.waresix_dbt.stg_payments
2021-12-10 08:22:03.961853 (Thread-1): 15:22:03 | 3 of 3 START table model dbt_local.stg_payments...................... [RUN]
2021-12-10 08:22:03.962885 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:03.963425 (Thread-1): Compiling model.waresix_dbt.stg_payments
2021-12-10 08:22:03.976802 (Thread-1): Writing injected SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 08:22:03.979150 (Thread-1): finished collecting timing info
2021-12-10 08:22:03.991331 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.stg_payments"
2021-12-10 08:22:03.995778 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:03.996770 (Thread-1): On model.waresix_dbt.stg_payments: BEGIN
2021-12-10 08:22:03.997191 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:22:04.041060 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:22:04.042044 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:04.042876 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */


  create  table "postgres"."dbt_local"."stg_payments__dbt_tmp"
  as (
    with source as (
    select * from "postgres"."dbt_local"."raw_payments"

),

renamed as (

    select
        id as payment_id,
        order_id,
        payment_method,

        -- `amount` is currently stored in cents, so we convert it to dollars
        amount / 100 as amount

    from source

)

select * from renamed
  );
2021-12-10 08:22:04.068002 (Thread-1): SQL status: SELECT 113 in 0.02 seconds
2021-12-10 08:22:04.076828 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:04.077385 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
alter table "postgres"."dbt_local"."stg_payments__dbt_tmp" rename to "stg_payments"
2021-12-10 08:22:04.084352 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2021-12-10 08:22:04.091928 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 08:22:04.092626 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:04.093124 (Thread-1): On model.waresix_dbt.stg_payments: COMMIT
2021-12-10 08:22:04.101904 (Thread-1): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:22:04.110946 (Thread-1): Using postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:22:04.112202 (Thread-1): On model.waresix_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.stg_payments"} */
drop table if exists "postgres"."dbt_local"."stg_payments__dbt_backup" cascade
2021-12-10 08:22:04.119960 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-12-10 08:22:04.126044 (Thread-1): finished collecting timing info
2021-12-10 08:22:04.127257 (Thread-1): On model.waresix_dbt.stg_payments: Close
2021-12-10 08:22:04.130063 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485668be-7e41-4fd1-9bb2-77073af2b3be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0844f0>]}
2021-12-10 08:22:04.132737 (Thread-1): 15:22:04 | 3 of 3 OK created table model dbt_local.stg_payments................. [SELECT 113 in 0.17s]
2021-12-10 08:22:04.133598 (Thread-1): Finished running node model.waresix_dbt.stg_payments
2021-12-10 08:22:04.138261 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:22:04.139523 (MainThread): Using postgres connection "master".
2021-12-10 08:22:04.140199 (MainThread): On master: BEGIN
2021-12-10 08:22:04.140949 (MainThread): Opening a new connection, currently in state closed
2021-12-10 08:22:04.220688 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-10 08:22:04.221230 (MainThread): On master: COMMIT
2021-12-10 08:22:04.221573 (MainThread): Using postgres connection "master".
2021-12-10 08:22:04.221886 (MainThread): On master: COMMIT
2021-12-10 08:22:04.230981 (MainThread): SQL status: COMMIT in 0.01 seconds
2021-12-10 08:22:04.231794 (MainThread): On master: Close
2021-12-10 08:22:04.233458 (MainThread): 15:22:04 | 
2021-12-10 08:22:04.234623 (MainThread): 15:22:04 | Finished running 3 table models in 3.12s.
2021-12-10 08:22:04.235614 (MainThread): Connection 'master' was properly closed.
2021-12-10 08:22:04.236375 (MainThread): Connection 'model.waresix_dbt.stg_payments' was properly closed.
2021-12-10 08:22:04.272162 (MainThread): 
2021-12-10 08:22:04.272962 (MainThread): Completed successfully
2021-12-10 08:22:04.273701 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-10 08:22:04.275820 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af30550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adfdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09a340>]}
2021-12-10 08:22:04.278047 (MainThread): Flushing usage events
2021-12-10 08:23:28.684406 (MainThread): Running with dbt=0.21.0
2021-12-10 08:23:28.960253 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['tag:stg'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-10 08:23:28.964089 (MainThread): Tracking: tracking
2021-12-10 08:23:29.005722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c214af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c22a520>]}
2021-12-10 08:23:29.043445 (MainThread): Partial parsing not enabled
2021-12-10 08:23:29.106210 (MainThread): Parsing macros/catalog.sql
2021-12-10 08:23:29.117658 (MainThread): Parsing macros/relations.sql
2021-12-10 08:23:29.123680 (MainThread): Parsing macros/adapters.sql
2021-12-10 08:23:29.201554 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-10 08:23:29.207733 (MainThread): Parsing macros/core.sql
2021-12-10 08:23:29.225616 (MainThread): Parsing macros/materializations/test.sql
2021-12-10 08:23:29.253661 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-10 08:23:29.286846 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-10 08:23:29.292415 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-10 08:23:29.389518 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-10 08:23:29.548914 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-10 08:23:29.628993 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-10 08:23:29.635513 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-10 08:23:29.671061 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-10 08:23:29.748083 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-10 08:23:29.794215 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-10 08:23:29.821006 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-10 08:23:29.846273 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-10 08:23:29.860348 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-10 08:23:29.865207 (MainThread): Parsing macros/etc/query.sql
2021-12-10 08:23:29.868281 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-10 08:23:29.873617 (MainThread): Parsing macros/etc/datetime.sql
2021-12-10 08:23:29.903539 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-10 08:23:29.910401 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-10 08:23:29.923075 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-10 08:23:29.936777 (MainThread): Parsing macros/adapters/common.sql
2021-12-10 08:23:30.162051 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-10 08:23:30.168561 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-10 08:23:30.172496 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-10 08:23:30.178770 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-10 08:23:31.026417 (MainThread): Acquiring new postgres connection "model.waresix_dbt.customers".
2021-12-10 08:23:31.084214 (MainThread): Acquiring new postgres connection "model.waresix_dbt.orders".
2021-12-10 08:23:31.192879 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_customers".
2021-12-10 08:23:31.355692 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_payments".
2021-12-10 08:23:31.401193 (MainThread): Acquiring new postgres connection "model.waresix_dbt.stg_orders".
2021-12-10 08:23:31.875943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.885818 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.894934 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.902947 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.909592 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.952001 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.993111 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:31.994350 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.001300 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.007926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.017763 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.026674 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.033791 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.057026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.063421 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.070516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.078966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.099966 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.100810 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.107307 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.116062 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.148700 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.151455 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-10 08:23:32.205121 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dd1fc81-ee3d-4f11-9a48-f98a77d5f87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fc8e0>]}
2021-12-10 08:23:32.229273 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-10 08:23:32.231180 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dd1fc81-ee3d-4f11-9a48-f98a77d5f87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c386940>]}
2021-12-10 08:23:32.232912 (MainThread): Found 5 models, 20 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 3 seed files, 0 sources, 0 exposures
2021-12-10 08:23:32.247403 (MainThread): 
2021-12-10 08:23:32.249927 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:23:32.254691 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_dbt_local".
2021-12-10 08:23:32.303972 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:23:32.304440 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: BEGIN
2021-12-10 08:23:32.304786 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-10 08:23:32.721338 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.42 seconds
2021-12-10 08:23:32.722617 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_dbt_local".
2021-12-10 08:23:32.723596 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_postgres_dbt_local"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_local'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_local'
  
2021-12-10 08:23:32.748091 (ThreadPoolExecutor-1_0): SQL status: SELECT 6 in 0.02 seconds
2021-12-10 08:23:32.752065 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: ROLLBACK
2021-12-10 08:23:32.758464 (ThreadPoolExecutor-1_0): On list_postgres_dbt_local: Close
2021-12-10 08:23:32.781951 (MainThread): Using postgres connection "master".
2021-12-10 08:23:32.782608 (MainThread): On master: BEGIN
2021-12-10 08:23:32.783316 (MainThread): Opening a new connection, currently in state init
2021-12-10 08:23:32.821119 (MainThread): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:23:32.821633 (MainThread): Using postgres connection "master".
2021-12-10 08:23:32.822316 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-10 08:23:35.440348 (MainThread): SQL status: SELECT 0 in 2.62 seconds
2021-12-10 08:23:35.443762 (MainThread): On master: ROLLBACK
2021-12-10 08:23:35.448079 (MainThread): On master: Close
2021-12-10 08:23:35.449434 (MainThread): 15:23:35 | Concurrency: 1 threads (target='dev')
2021-12-10 08:23:35.450052 (MainThread): 15:23:35 | 
2021-12-10 08:23:35.460023 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 08:23:35.460893 (Thread-1): 15:23:35 | 1 of 8 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2021-12-10 08:23:35.462088 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 08:23:35.463094 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 08:23:35.536803 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 08:23:35.541431 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.620428 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
2021-12-10 08:23:35.623034 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 08:23:35.623680 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: BEGIN
2021-12-10 08:23:35.624055 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:35.668649 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:23:35.669340 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad".
2021-12-10 08:23:35.669889 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
2021-12-10 08:23:35.681025 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:35.688024 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.688823 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: ROLLBACK
2021-12-10 08:23:35.694190 (Thread-1): On test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
2021-12-10 08:23:35.695868 (Thread-1): 15:23:35 | 1 of 8 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 0.23s]
2021-12-10 08:23:35.696613 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
2021-12-10 08:23:35.697600 (Thread-1): Began running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 08:23:35.699059 (Thread-1): 15:23:35 | 2 of 8 START test accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [RUN]
2021-12-10 08:23:35.700596 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 08:23:35.701270 (Thread-1): Compiling test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 08:23:35.739088 (Thread-1): Writing injected SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 08:23:35.743041 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.755764 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"
2021-12-10 08:23:35.760371 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 08:23:35.761093 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: BEGIN
2021-12-10 08:23:35.761690 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:35.802895 (Thread-1): SQL status: BEGIN in 0.04 seconds
2021-12-10 08:23:35.803437 (Thread-1): Using postgres connection "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278".
2021-12-10 08:23:35.803788 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from "postgres"."dbt_local"."stg_payments"
    group by payment_method

)

select *
from all_values
where value_field not in (
    'credit_card','coupon','bank_transfer','gift_card'
)



      
    ) dbt_internal_test
2021-12-10 08:23:35.811984 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:35.818034 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.818597 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: ROLLBACK
2021-12-10 08:23:35.829528 (Thread-1): On test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278: Close
2021-12-10 08:23:35.832689 (Thread-1): 15:23:35 | 2 of 8 PASS accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card [PASS in 0.13s]
2021-12-10 08:23:35.833453 (Thread-1): Finished running node test.waresix_dbt.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278
2021-12-10 08:23:35.834219 (Thread-1): Began running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 08:23:35.835538 (Thread-1): 15:23:35 | 3 of 8 START test not_null_stg_customers_customer_id................. [RUN]
2021-12-10 08:23:35.837114 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 08:23:35.837950 (Thread-1): Compiling test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 08:23:35.881896 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 08:23:35.885785 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.892363 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
2021-12-10 08:23:35.894299 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 08:23:35.894989 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
2021-12-10 08:23:35.895547 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:35.942837 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 08:23:35.943615 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa".
2021-12-10 08:23:35.944369 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_customers"
where customer_id is null



      
    ) dbt_internal_test
2021-12-10 08:23:35.953384 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:35.960977 (Thread-1): finished collecting timing info
2021-12-10 08:23:35.961715 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
2021-12-10 08:23:35.967239 (Thread-1): On test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
2021-12-10 08:23:35.969285 (Thread-1): 15:23:35 | 3 of 8 PASS not_null_stg_customers_customer_id....................... [PASS in 0.13s]
2021-12-10 08:23:35.970229 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
2021-12-10 08:23:35.971262 (Thread-1): Began running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 08:23:35.972887 (Thread-1): 15:23:35 | 4 of 8 START test not_null_stg_orders_order_id....................... [RUN]
2021-12-10 08:23:35.974377 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 08:23:35.975128 (Thread-1): Compiling test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 08:23:35.993695 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 08:23:35.995467 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.007137 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"
2021-12-10 08:23:36.009087 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 08:23:36.009675 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
2021-12-10 08:23:36.010361 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:36.071170 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 08:23:36.071690 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64".
2021-12-10 08:23:36.072220 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_orders"
where order_id is null



      
    ) dbt_internal_test
2021-12-10 08:23:36.087567 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:36.091544 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.092158 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
2021-12-10 08:23:36.096280 (Thread-1): On test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
2021-12-10 08:23:36.098320 (Thread-1): 15:23:36 | 4 of 8 PASS not_null_stg_orders_order_id............................. [PASS in 0.12s]
2021-12-10 08:23:36.099339 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_orders_order_id.81cfe2fe64
2021-12-10 08:23:36.100306 (Thread-1): Began running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 08:23:36.101051 (Thread-1): 15:23:36 | 5 of 8 START test not_null_stg_payments_payment_id................... [RUN]
2021-12-10 08:23:36.102086 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 08:23:36.102800 (Thread-1): Compiling test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 08:23:36.118033 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 08:23:36.120112 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.131065 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"
2021-12-10 08:23:36.134647 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 08:23:36.137577 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: BEGIN
2021-12-10 08:23:36.139023 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:36.194294 (Thread-1): SQL status: BEGIN in 0.06 seconds
2021-12-10 08:23:36.195202 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075".
2021-12-10 08:23:36.195690 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."dbt_local"."stg_payments"
where payment_id is null



      
    ) dbt_internal_test
2021-12-10 08:23:36.202348 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:36.207409 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.208098 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
2021-12-10 08:23:36.212352 (Thread-1): On test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075: Close
2021-12-10 08:23:36.214144 (Thread-1): 15:23:36 | 5 of 8 PASS not_null_stg_payments_payment_id......................... [PASS in 0.11s]
2021-12-10 08:23:36.214917 (Thread-1): Finished running node test.waresix_dbt.not_null_stg_payments_payment_id.c19cc50075
2021-12-10 08:23:36.216319 (Thread-1): Began running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 08:23:36.217575 (Thread-1): 15:23:36 | 6 of 8 START test unique_stg_customers_customer_id................... [RUN]
2021-12-10 08:23:36.219575 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 08:23:36.221813 (Thread-1): Compiling test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 08:23:36.277242 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 08:23:36.279490 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.289112 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"
2021-12-10 08:23:36.290552 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 08:23:36.291269 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
2021-12-10 08:23:36.291889 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:36.346191 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 08:23:36.347464 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada".
2021-12-10 08:23:36.348043 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 08:23:36.356934 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:36.360970 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.361479 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
2021-12-10 08:23:36.366754 (Thread-1): On test.waresix_dbt.unique_stg_customers_customer_id.c7614daada: Close
2021-12-10 08:23:36.368270 (Thread-1): 15:23:36 | 6 of 8 PASS unique_stg_customers_customer_id......................... [PASS in 0.15s]
2021-12-10 08:23:36.369145 (Thread-1): Finished running node test.waresix_dbt.unique_stg_customers_customer_id.c7614daada
2021-12-10 08:23:36.369882 (Thread-1): Began running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 08:23:36.371039 (Thread-1): 15:23:36 | 7 of 8 START test unique_stg_orders_order_id......................... [RUN]
2021-12-10 08:23:36.372217 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 08:23:36.372947 (Thread-1): Compiling test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 08:23:36.384327 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 08:23:36.385535 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.399550 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"
2021-12-10 08:23:36.403481 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 08:23:36.404221 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
2021-12-10 08:23:36.404812 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:36.457431 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 08:23:36.457931 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a".
2021-12-10 08:23:36.458268 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 08:23:36.465632 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:36.470024 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.470572 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
2021-12-10 08:23:36.475714 (Thread-1): On test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a: Close
2021-12-10 08:23:36.477424 (Thread-1): 15:23:36 | 7 of 8 PASS unique_stg_orders_order_id............................... [PASS in 0.11s]
2021-12-10 08:23:36.477970 (Thread-1): Finished running node test.waresix_dbt.unique_stg_orders_order_id.e3b841c71a
2021-12-10 08:23:36.478802 (Thread-1): Began running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 08:23:36.479819 (Thread-1): 15:23:36 | 8 of 8 START test unique_stg_payments_payment_id..................... [RUN]
2021-12-10 08:23:36.480941 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 08:23:36.481495 (Thread-1): Compiling test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 08:23:36.496577 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 08:23:36.500093 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.505669 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"
2021-12-10 08:23:36.507745 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 08:23:36.508156 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: BEGIN
2021-12-10 08:23:36.508490 (Thread-1): Opening a new connection, currently in state closed
2021-12-10 08:23:36.561142 (Thread-1): SQL status: BEGIN in 0.05 seconds
2021-12-10 08:23:36.561849 (Thread-1): Using postgres connection "test.waresix_dbt.unique_stg_payments_payment_id.3744510712".
2021-12-10 08:23:36.562640 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_stg_payments_payment_id.3744510712"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "postgres"."dbt_local"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-10 08:23:36.569934 (Thread-1): SQL status: SELECT 1 in 0.01 seconds
2021-12-10 08:23:36.573992 (Thread-1): finished collecting timing info
2021-12-10 08:23:36.574603 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: ROLLBACK
2021-12-10 08:23:36.579131 (Thread-1): On test.waresix_dbt.unique_stg_payments_payment_id.3744510712: Close
2021-12-10 08:23:36.580590 (Thread-1): 15:23:36 | 8 of 8 PASS unique_stg_payments_payment_id........................... [PASS in 0.10s]
2021-12-10 08:23:36.581154 (Thread-1): Finished running node test.waresix_dbt.unique_stg_payments_payment_id.3744510712
2021-12-10 08:23:36.587392 (MainThread): Acquiring new postgres connection "master".
2021-12-10 08:23:36.589455 (MainThread): 15:23:36 | 
2021-12-10 08:23:36.590251 (MainThread): 15:23:36 | Finished running 8 tests in 4.34s.
2021-12-10 08:23:36.591022 (MainThread): Connection 'master' was properly closed.
2021-12-10 08:23:36.591738 (MainThread): Connection 'test.waresix_dbt.unique_stg_payments_payment_id.3744510712' was properly closed.
2021-12-10 08:23:36.624340 (MainThread): 
2021-12-10 08:23:36.625329 (MainThread): Completed successfully
2021-12-10 08:23:36.626420 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-12-10 08:23:36.627459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ed8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3edac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fc940>]}
2021-12-10 08:23:36.628575 (MainThread): Flushing usage events
2021-12-20 14:48:53.145987 (MainThread): Running with dbt=0.21.0
2021-12-20 14:48:53.149881 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'waresix_dbt'
2021-12-20 14:48:53.149959 (MainThread): No profile "waresix_dbt" found, continuing with no target
2021-12-20 14:48:53.181694 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/var/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-20 14:48:53.182921 (MainThread): Tracking: do not track
2021-12-20 14:48:53.203867 (MainThread): Warning: No packages were found in packages.yml
2021-12-20 14:48:53.204383 (MainThread): Flushing usage events
2021-12-20 14:52:15.133020 (MainThread): Running with dbt=0.21.0
2021-12-20 14:52:15.137639 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'waresix_dbt'
2021-12-20 14:52:15.137743 (MainThread): No profile "waresix_dbt" found, continuing with no target
2021-12-20 14:52:15.158871 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-20 14:52:15.159814 (MainThread): Tracking: do not track
2021-12-20 14:52:15.178948 (MainThread): Warning: No packages were found in packages.yml
2021-12-20 14:52:15.179441 (MainThread): Flushing usage events
2021-12-20 15:00:03.287481 (MainThread): Running with dbt=0.21.0
2021-12-20 15:00:03.364860 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-20 15:00:03.365608 (MainThread): Tracking: tracking
2021-12-20 15:00:03.378331 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa9bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa9b970>]}
2021-12-20 15:00:03.379067 (MainThread): Warning: No packages were found in packages.yml
2021-12-20 15:00:03.379385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa9bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa9b970>]}
2021-12-20 15:00:03.379609 (MainThread): Flushing usage events
2021-12-20 15:59:01.929560 (MainThread): Running with dbt=0.21.0
2021-12-20 15:59:02.030753 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-20 15:59:02.032457 (MainThread): Tracking: tracking
2021-12-20 15:59:02.046212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e3490>]}
2021-12-20 15:59:02.059218 (MainThread): Partial parsing not enabled
2021-12-20 15:59:02.062927 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104819610>]}
2021-12-20 15:59:02.063228 (MainThread): Flushing usage events
2021-12-20 15:59:03.327672 (MainThread): Encountered an error:
2021-12-20 15:59:03.328398 (MainThread): Compilation Error
  Error reading waresix_dbt: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name:clean_transport_delivery_orders
    5  |     columns:
    6  |       - name:id
    7  |         tests:
    8  |           - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12
2021-12-20 15:59:03.430469 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   - name:clean_transport_delivery_orders
  5  |     columns:
  6  |       - name:id
  7  |         tests:
  8  |           - unique
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name:clean_transport_delivery_orders
    5  |     columns:
    6  |       - name:id
    7  |         tests:
    8  |           - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12

2021-12-20 16:00:52.291066 (MainThread): Running with dbt=0.21.0
2021-12-20 16:00:52.420973 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-20 16:00:52.423790 (MainThread): Tracking: tracking
2021-12-20 16:00:52.471040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111deda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e044f0>]}
2021-12-20 16:00:52.486719 (MainThread): Partial parsing not enabled
2021-12-20 16:00:52.490135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dd7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3a610>]}
2021-12-20 16:00:52.490439 (MainThread): Flushing usage events
2021-12-20 16:00:54.658224 (MainThread): Encountered an error:
2021-12-20 16:00:54.658492 (MainThread): Compilation Error
  Error reading waresix_dbt: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name:clean_transport_delivery_orders
    5  |     columns:
    6  |     -name : id
    7  |         tests:
    8  |           - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12
2021-12-20 16:00:54.731637 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   - name:clean_transport_delivery_orders
  5  |     columns:
  6  |     -name : id
  7  |         tests:
  8  |           - unique
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 12

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name:clean_transport_delivery_orders
    5  |     columns:
    6  |     -name : id
    7  |         tests:
    8  |           - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 12

2021-12-20 16:03:58.970011 (MainThread): Running with dbt=0.21.0
2021-12-20 16:03:59.070686 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-20 16:03:59.072249 (MainThread): Tracking: tracking
2021-12-20 16:03:59.087180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a531bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a552b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a567550>]}
2021-12-20 16:03:59.099875 (MainThread): Partial parsing not enabled
2021-12-20 16:03:59.117664 (MainThread): Parsing macros/catalog.sql
2021-12-20 16:03:59.124314 (MainThread): Parsing macros/relations.sql
2021-12-20 16:03:59.125862 (MainThread): Parsing macros/adapters.sql
2021-12-20 16:03:59.152197 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-20 16:03:59.154156 (MainThread): Parsing macros/core.sql
2021-12-20 16:03:59.158550 (MainThread): Parsing macros/materializations/test.sql
2021-12-20 16:03:59.166795 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-20 16:03:59.183447 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-20 16:03:59.186097 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-20 16:03:59.222434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-20 16:03:59.264410 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-20 16:03:59.289447 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-20 16:03:59.291355 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-20 16:03:59.302543 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-20 16:03:59.323953 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-20 16:03:59.339910 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-20 16:03:59.348520 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-20 16:03:59.356370 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-20 16:03:59.360580 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-20 16:03:59.362180 (MainThread): Parsing macros/etc/query.sql
2021-12-20 16:03:59.363207 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-20 16:03:59.364827 (MainThread): Parsing macros/etc/datetime.sql
2021-12-20 16:03:59.373930 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-20 16:03:59.375876 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-20 16:03:59.378399 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-20 16:03:59.380079 (MainThread): Parsing macros/adapters/common.sql
2021-12-20 16:03:59.440283 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-20 16:03:59.442194 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-20 16:03:59.443499 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-20 16:03:59.444943 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-20 16:03:59.640935 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:03:59.710773 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:03:59.712676 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:03:59.726103 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-20 16:03:59.731529 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b73a084e-fe5d-4468-a044-593d51596073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074626d0>]}
2021-12-20 16:03:59.742056 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-20 16:03:59.743274 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b73a084e-fe5d-4468-a044-593d51596073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6146a0>]}
2021-12-20 16:03:59.743612 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-20 16:03:59.745504 (MainThread): 
2021-12-20 16:03:59.746699 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:03:59.749922 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-20 16:03:59.771379 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-20 16:03:59.771828 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-20 16:03:59.772017 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-20 16:04:00.418999 (ThreadPoolExecutor-0_0): SQL status: SELECT 184 in 0.65 seconds
2021-12-20 16:04:00.424864 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-20 16:04:00.426276 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_pg_raw_dbt_dev".
2021-12-20 16:04:00.426782 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "create_pg_raw_dbt_dev".
2021-12-20 16:04:00.427124 (ThreadPoolExecutor-0_0): Creating schema ""pg_raw"."dbt_dev""
2021-12-20 16:04:00.436354 (ThreadPoolExecutor-0_0): Using postgres connection "create_pg_raw_dbt_dev".
2021-12-20 16:04:00.436601 (ThreadPoolExecutor-0_0): On create_pg_raw_dbt_dev: BEGIN
2021-12-20 16:04:00.436794 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-12-20 16:04:00.748519 (ThreadPoolExecutor-0_0): SQL status: BEGIN in 0.31 seconds
2021-12-20 16:04:00.748966 (ThreadPoolExecutor-0_0): Using postgres connection "create_pg_raw_dbt_dev".
2021-12-20 16:04:00.749255 (ThreadPoolExecutor-0_0): On create_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "create_pg_raw_dbt_dev"} */
create schema if not exists "dbt_dev"
2021-12-20 16:04:00.789338 (ThreadPoolExecutor-0_0): SQL status: CREATE SCHEMA in 0.04 seconds
2021-12-20 16:04:00.791964 (ThreadPoolExecutor-0_0): On create_pg_raw_dbt_dev: COMMIT
2021-12-20 16:04:00.792424 (ThreadPoolExecutor-0_0): Using postgres connection "create_pg_raw_dbt_dev".
2021-12-20 16:04:00.792699 (ThreadPoolExecutor-0_0): On create_pg_raw_dbt_dev: COMMIT
2021-12-20 16:04:00.828677 (ThreadPoolExecutor-0_0): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:04:00.829329 (ThreadPoolExecutor-0_0): On create_pg_raw_dbt_dev: Close
2021-12-20 16:04:00.832456 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:00.845016 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:00.845315 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-20 16:04:00.845532 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-20 16:04:01.168657 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:01.169239 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:01.169610 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-20 16:04:01.208551 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:04:01.210894 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-20 16:04:01.248122 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-20 16:04:01.252322 (MainThread): Using postgres connection "master".
2021-12-20 16:04:01.252528 (MainThread): On master: BEGIN
2021-12-20 16:04:01.252659 (MainThread): Opening a new connection, currently in state init
2021-12-20 16:04:01.568656 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:01.569236 (MainThread): Using postgres connection "master".
2021-12-20 16:04:01.569620 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-20 16:04:01.608830 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:04:01.612050 (MainThread): On master: ROLLBACK
2021-12-20 16:04:01.648758 (MainThread): Using postgres connection "master".
2021-12-20 16:04:01.649322 (MainThread): On master: BEGIN
2021-12-20 16:04:01.728619 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-20 16:04:01.729235 (MainThread): On master: COMMIT
2021-12-20 16:04:01.729630 (MainThread): Using postgres connection "master".
2021-12-20 16:04:01.729964 (MainThread): On master: COMMIT
2021-12-20 16:04:01.768649 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:04:01.769326 (MainThread): On master: Close
2021-12-20 16:04:01.770586 (MainThread): 23:04:01 | Concurrency: 1 threads (target='dev')
2021-12-20 16:04:01.771060 (MainThread): 23:04:01 | 
2021-12-20 16:04:01.778291 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:01.779165 (Thread-1): 23:04:01 | 1 of 1 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-20 16:04:01.780061 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:01.780513 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:01.783213 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:04:01.785389 (Thread-1): finished collecting timing info
2021-12-20 16:04:01.829256 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:04:01.829779 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:01.829918 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-20 16:04:01.830044 (Thread-1): Opening a new connection, currently in state closed
2021-12-20 16:04:02.148570 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:02.149159 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:02.149550 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false;
  );
2021-12-20 16:04:02.188821 (Thread-1): Postgres error: syntax error at or near ";"
LINE 99:   and rtdo.is_deleted  = false;
                                       ^

2021-12-20 16:04:02.189482 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: ROLLBACK
2021-12-20 16:04:02.228532 (Thread-1): finished collecting timing info
2021-12-20 16:04:02.228969 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-20 16:04:02.229776 (Thread-1): Database Error in model clean_transport_delivery_orders (models/clean_transport_delivery_orders.sql)
  syntax error at or near ";"
  LINE 99:   and rtdo.is_deleted  = false;
                                         ^
  compiled SQL at target/run/waresix_dbt/models/clean_transport_delivery_orders.sql
Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/Library/Python/3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 99:   and rtdo.is_deleted  = false;
                                       ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Library/Python/3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Library/Python/3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/Library/Python/3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/Library/Python/3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Library/Python/3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Library/Python/3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/Library/Python/3.8/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Library/Python/3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.8/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Library/Python/3.8/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model clean_transport_delivery_orders (models/clean_transport_delivery_orders.sql)
  syntax error at or near ";"
  LINE 99:   and rtdo.is_deleted  = false;
                                         ^
  compiled SQL at target/run/waresix_dbt/models/clean_transport_delivery_orders.sql
2021-12-20 16:04:02.277510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b73a084e-fe5d-4468-a044-593d51596073', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a53f070>]}
2021-12-20 16:04:02.277904 (Thread-1): 23:04:02 | 1 of 1 ERROR creating table model dbt_dev.clean_transport_delivery_orders [ERROR in 0.50s]
2021-12-20 16:04:02.278070 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:02.279303 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:04:02.279558 (MainThread): Using postgres connection "master".
2021-12-20 16:04:02.279686 (MainThread): On master: BEGIN
2021-12-20 16:04:02.279800 (MainThread): Opening a new connection, currently in state closed
2021-12-20 16:04:02.598618 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:02.599224 (MainThread): On master: COMMIT
2021-12-20 16:04:02.599596 (MainThread): Using postgres connection "master".
2021-12-20 16:04:02.599920 (MainThread): On master: COMMIT
2021-12-20 16:04:02.638548 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:04:02.639000 (MainThread): On master: Close
2021-12-20 16:04:02.639904 (MainThread): 23:04:02 | 
2021-12-20 16:04:02.640223 (MainThread): 23:04:02 | Finished running 1 table model in 2.89s.
2021-12-20 16:04:02.640495 (MainThread): Connection 'master' was properly closed.
2021-12-20 16:04:02.640721 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-20 16:04:02.652694 (MainThread): 
2021-12-20 16:04:02.653335 (MainThread): Completed with 1 error and 0 warnings:
2021-12-20 16:04:02.653733 (MainThread): 
2021-12-20 16:04:02.654073 (MainThread): Database Error in model clean_transport_delivery_orders (models/clean_transport_delivery_orders.sql)
2021-12-20 16:04:02.654271 (MainThread):   syntax error at or near ";"
2021-12-20 16:04:02.654467 (MainThread):   LINE 99:   and rtdo.is_deleted  = false;
2021-12-20 16:04:02.654645 (MainThread):                                          ^
2021-12-20 16:04:02.654954 (MainThread):   compiled SQL at target/run/waresix_dbt/models/clean_transport_delivery_orders.sql
2021-12-20 16:04:02.655347 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-12-20 16:04:02.655944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ff3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ff7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5ff760>]}
2021-12-20 16:04:02.656450 (MainThread): Flushing usage events
2021-12-20 16:04:32.648355 (MainThread): Running with dbt=0.21.0
2021-12-20 16:04:32.726852 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-20 16:04:32.727667 (MainThread): Tracking: tracking
2021-12-20 16:04:32.738245 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a08550>]}
2021-12-20 16:04:32.750165 (MainThread): Partial parsing not enabled
2021-12-20 16:04:32.760055 (MainThread): Parsing macros/catalog.sql
2021-12-20 16:04:32.764195 (MainThread): Parsing macros/relations.sql
2021-12-20 16:04:32.765664 (MainThread): Parsing macros/adapters.sql
2021-12-20 16:04:32.790549 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-20 16:04:32.792656 (MainThread): Parsing macros/core.sql
2021-12-20 16:04:32.797387 (MainThread): Parsing macros/materializations/test.sql
2021-12-20 16:04:32.805994 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-20 16:04:32.818340 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-20 16:04:32.820537 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-20 16:04:32.840953 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-20 16:04:32.877878 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-20 16:04:32.902709 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-20 16:04:32.904570 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-20 16:04:32.915542 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-20 16:04:32.937197 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-20 16:04:32.951734 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-20 16:04:32.959882 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-20 16:04:32.967889 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-20 16:04:32.971988 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-20 16:04:32.973525 (MainThread): Parsing macros/etc/query.sql
2021-12-20 16:04:32.974585 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-20 16:04:32.976146 (MainThread): Parsing macros/etc/datetime.sql
2021-12-20 16:04:32.985293 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-20 16:04:32.987160 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-20 16:04:32.989678 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-20 16:04:32.991348 (MainThread): Parsing macros/adapters/common.sql
2021-12-20 16:04:33.050465 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-20 16:04:33.052304 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-20 16:04:33.053544 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-20 16:04:33.054970 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-20 16:04:33.251506 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:33.318366 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:04:33.320195 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:04:33.329482 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-20 16:04:33.337815 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '794c78fb-f47e-4afb-9506-3b56853bfd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112adea00>]}
2021-12-20 16:04:33.344158 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-20 16:04:33.344891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '794c78fb-f47e-4afb-9506-3b56853bfd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ad1d60>]}
2021-12-20 16:04:33.345253 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-20 16:04:33.349520 (MainThread): 
2021-12-20 16:04:33.351110 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:04:33.352616 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-20 16:04:33.370687 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-20 16:04:33.370925 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-20 16:04:33.371067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-20 16:04:33.778262 (ThreadPoolExecutor-0_0): SQL status: SELECT 185 in 0.41 seconds
2021-12-20 16:04:33.784149 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-20 16:04:33.786172 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:33.796225 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:33.796508 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-20 16:04:33.796695 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-20 16:04:34.107474 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-20 16:04:34.108044 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:04:34.108424 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-20 16:04:34.147742 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:04:34.150955 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-20 16:04:34.187250 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-20 16:04:34.195791 (MainThread): Using postgres connection "master".
2021-12-20 16:04:34.196127 (MainThread): On master: BEGIN
2021-12-20 16:04:34.196375 (MainThread): Opening a new connection, currently in state init
2021-12-20 16:04:34.507576 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-20 16:04:34.508158 (MainThread): Using postgres connection "master".
2021-12-20 16:04:34.508528 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-20 16:04:34.547482 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:04:34.550763 (MainThread): On master: ROLLBACK
2021-12-20 16:04:34.587434 (MainThread): Using postgres connection "master".
2021-12-20 16:04:34.587990 (MainThread): On master: BEGIN
2021-12-20 16:04:34.667749 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-20 16:04:34.668359 (MainThread): On master: COMMIT
2021-12-20 16:04:34.668776 (MainThread): Using postgres connection "master".
2021-12-20 16:04:34.669117 (MainThread): On master: COMMIT
2021-12-20 16:04:34.707503 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:04:34.708149 (MainThread): On master: Close
2021-12-20 16:04:34.709377 (MainThread): 23:04:34 | Concurrency: 1 threads (target='dev')
2021-12-20 16:04:34.709848 (MainThread): 23:04:34 | 
2021-12-20 16:04:34.713282 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:34.713861 (Thread-1): 23:04:34 | 1 of 1 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-20 16:04:34.714464 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:34.714771 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:34.717162 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:04:34.717845 (Thread-1): finished collecting timing info
2021-12-20 16:04:34.755934 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:04:34.756441 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:34.756568 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-20 16:04:34.756680 (Thread-1): Opening a new connection, currently in state closed
2021-12-20 16:04:35.077648 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:35.078292 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:35.078682 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-20 16:04:41.546960 (Thread-1): SQL status: SELECT 388460 in 6.47 seconds
2021-12-20 16:04:41.563258 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:41.563599 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-20 16:04:41.606779 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-20 16:04:41.632223 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-20 16:04:41.632721 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:41.633048 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-20 16:04:41.666883 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-12-20 16:04:41.674708 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:04:41.674965 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-20 16:04:41.716767 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-20 16:04:41.718664 (Thread-1): finished collecting timing info
2021-12-20 16:04:41.718954 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-20 16:04:41.719741 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '794c78fb-f47e-4afb-9506-3b56853bfd32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bbae20>]}
2021-12-20 16:04:41.720196 (Thread-1): 23:04:41 | 1 of 1 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388460 in 7.01s]
2021-12-20 16:04:41.720393 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:04:41.721632 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:04:41.721893 (MainThread): Using postgres connection "master".
2021-12-20 16:04:41.722090 (MainThread): On master: BEGIN
2021-12-20 16:04:41.722291 (MainThread): Opening a new connection, currently in state closed
2021-12-20 16:04:42.046789 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:04:42.047034 (MainThread): On master: COMMIT
2021-12-20 16:04:42.047154 (MainThread): Using postgres connection "master".
2021-12-20 16:04:42.047263 (MainThread): On master: COMMIT
2021-12-20 16:04:42.086608 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:04:42.086844 (MainThread): On master: Close
2021-12-20 16:04:42.087403 (MainThread): 23:04:42 | 
2021-12-20 16:04:42.087573 (MainThread): 23:04:42 | Finished running 1 table model in 8.74s.
2021-12-20 16:04:42.087702 (MainThread): Connection 'master' was properly closed.
2021-12-20 16:04:42.087805 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-20 16:04:42.091916 (MainThread): 
2021-12-20 16:04:42.092101 (MainThread): Completed successfully
2021-12-20 16:04:42.092238 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-20 16:04:42.092431 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112123820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b571f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b57d60>]}
2021-12-20 16:04:42.092646 (MainThread): Flushing usage events
2021-12-20 16:08:08.718202 (MainThread): Running with dbt=0.21.0
2021-12-20 16:08:08.822103 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-20 16:08:08.823848 (MainThread): Tracking: tracking
2021-12-20 16:08:08.842075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d03da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d055ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06d520>]}
2021-12-20 16:08:08.856498 (MainThread): Partial parsing not enabled
2021-12-20 16:08:08.874205 (MainThread): Parsing macros/catalog.sql
2021-12-20 16:08:08.879318 (MainThread): Parsing macros/relations.sql
2021-12-20 16:08:08.880848 (MainThread): Parsing macros/adapters.sql
2021-12-20 16:08:08.905209 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-20 16:08:08.907033 (MainThread): Parsing macros/core.sql
2021-12-20 16:08:08.911085 (MainThread): Parsing macros/materializations/test.sql
2021-12-20 16:08:08.918394 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-20 16:08:08.928758 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-20 16:08:08.930480 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-20 16:08:08.949114 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-20 16:08:08.985071 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-20 16:08:09.009359 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-20 16:08:09.011242 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-20 16:08:09.022261 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-20 16:08:09.043626 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-20 16:08:09.058289 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-20 16:08:09.066577 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-20 16:08:09.074791 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-20 16:08:09.079228 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-20 16:08:09.080881 (MainThread): Parsing macros/etc/query.sql
2021-12-20 16:08:09.082017 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-20 16:08:09.083617 (MainThread): Parsing macros/etc/datetime.sql
2021-12-20 16:08:09.092736 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-20 16:08:09.094638 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-20 16:08:09.097211 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-20 16:08:09.098873 (MainThread): Parsing macros/adapters/common.sql
2021-12-20 16:08:09.156672 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-20 16:08:09.158466 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-20 16:08:09.159698 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-20 16:08:09.161418 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-20 16:08:09.358505 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:09.429788 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:08:09.431751 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:08:09.441410 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-20 16:08:09.446577 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fa9cfcd-fb8b-4993-a37d-a603a84c3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d145eb0>]}
2021-12-20 16:08:09.453390 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-20 16:08:09.454232 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fa9cfcd-fb8b-4993-a37d-a603a84c3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d001a30>]}
2021-12-20 16:08:09.454637 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-20 16:08:09.457982 (MainThread): 
2021-12-20 16:08:09.458601 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:08:09.461697 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-20 16:08:09.482528 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-20 16:08:09.482994 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-20 16:08:09.483204 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-20 16:08:10.069998 (ThreadPoolExecutor-0_0): SQL status: SELECT 185 in 0.59 seconds
2021-12-20 16:08:10.075839 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-20 16:08:10.078018 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:10.088382 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:10.089124 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-20 16:08:10.089360 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-20 16:08:10.409802 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:08:10.410395 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:10.410758 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-20 16:08:10.449660 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.04 seconds
2021-12-20 16:08:10.453061 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-20 16:08:10.489545 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-20 16:08:10.500624 (MainThread): Using postgres connection "master".
2021-12-20 16:08:10.500927 (MainThread): On master: BEGIN
2021-12-20 16:08:10.501137 (MainThread): Opening a new connection, currently in state init
2021-12-20 16:08:10.819249 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:08:10.819588 (MainThread): Using postgres connection "master".
2021-12-20 16:08:10.819775 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-20 16:08:10.859152 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:08:10.860402 (MainThread): On master: ROLLBACK
2021-12-20 16:08:10.899715 (MainThread): Using postgres connection "master".
2021-12-20 16:08:10.900284 (MainThread): On master: BEGIN
2021-12-20 16:08:10.979677 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-20 16:08:10.980291 (MainThread): On master: COMMIT
2021-12-20 16:08:10.980677 (MainThread): Using postgres connection "master".
2021-12-20 16:08:10.981011 (MainThread): On master: COMMIT
2021-12-20 16:08:11.019585 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:08:11.020202 (MainThread): On master: Close
2021-12-20 16:08:11.021388 (MainThread): 23:08:11 | Concurrency: 1 threads (target='dev')
2021-12-20 16:08:11.021862 (MainThread): 23:08:11 | 
2021-12-20 16:08:11.027429 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:08:11.028041 (Thread-1): 23:08:11 | 1 of 1 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-20 16:08:11.028650 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:11.028957 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:08:11.031785 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:08:11.033338 (Thread-1): finished collecting timing info
2021-12-20 16:08:11.071495 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-20 16:08:11.072088 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:11.072237 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-20 16:08:11.072386 (Thread-1): Opening a new connection, currently in state closed
2021-12-20 16:08:11.389625 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:08:11.390220 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:11.390585 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-20 16:08:14.225762 (Thread-1): SQL status: SELECT 388460 in 2.83 seconds
2021-12-20 16:08:14.238420 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:14.238721 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-20 16:08:14.269664 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-20 16:08:14.276337 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:14.276638 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-20 16:08:14.319418 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-20 16:08:14.339834 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-20 16:08:14.340105 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:14.340264 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-20 16:08:14.381573 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:08:14.391962 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:14.392259 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-20 16:08:14.489597 (Thread-1): SQL status: DROP TABLE in 0.10 seconds
2021-12-20 16:08:14.492808 (Thread-1): finished collecting timing info
2021-12-20 16:08:14.493324 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-20 16:08:14.494489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa9cfcd-fb8b-4993-a37d-a603a84c3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d226f10>]}
2021-12-20 16:08:14.495179 (Thread-1): 23:08:14 | 1 of 1 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388460 in 3.47s]
2021-12-20 16:08:14.495510 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-20 16:08:14.497331 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:08:14.497706 (MainThread): Using postgres connection "master".
2021-12-20 16:08:14.497951 (MainThread): On master: BEGIN
2021-12-20 16:08:14.498185 (MainThread): Opening a new connection, currently in state closed
2021-12-20 16:08:14.819707 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:08:14.820301 (MainThread): On master: COMMIT
2021-12-20 16:08:14.820662 (MainThread): Using postgres connection "master".
2021-12-20 16:08:14.820991 (MainThread): On master: COMMIT
2021-12-20 16:08:14.859430 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-20 16:08:14.860131 (MainThread): On master: Close
2021-12-20 16:08:14.861426 (MainThread): 23:08:14 | 
2021-12-20 16:08:14.861898 (MainThread): 23:08:14 | Finished running 1 table model in 5.40s.
2021-12-20 16:08:14.862320 (MainThread): Connection 'master' was properly closed.
2021-12-20 16:08:14.862655 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-20 16:08:14.872567 (MainThread): 
2021-12-20 16:08:14.872980 (MainThread): Completed successfully
2021-12-20 16:08:14.873322 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-20 16:08:14.873689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d122ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1c5e80>]}
2021-12-20 16:08:14.874077 (MainThread): Flushing usage events
2021-12-20 16:08:31.033665 (MainThread): Running with dbt=0.21.0
2021-12-20 16:08:31.112819 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['tag:transport'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-20 16:08:31.113800 (MainThread): Tracking: tracking
2021-12-20 16:08:31.124215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b673bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b689b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b69e580>]}
2021-12-20 16:08:31.135963 (MainThread): Partial parsing not enabled
2021-12-20 16:08:31.145791 (MainThread): Parsing macros/catalog.sql
2021-12-20 16:08:31.149474 (MainThread): Parsing macros/relations.sql
2021-12-20 16:08:31.150989 (MainThread): Parsing macros/adapters.sql
2021-12-20 16:08:31.176055 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-20 16:08:31.178075 (MainThread): Parsing macros/core.sql
2021-12-20 16:08:31.182258 (MainThread): Parsing macros/materializations/test.sql
2021-12-20 16:08:31.189317 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-20 16:08:31.201302 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-20 16:08:31.203456 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-20 16:08:31.227180 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-20 16:08:31.264651 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-20 16:08:31.289444 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-20 16:08:31.291406 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-20 16:08:31.302441 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-20 16:08:31.324445 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-20 16:08:31.339399 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-20 16:08:31.347814 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-20 16:08:31.355516 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-20 16:08:31.359531 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-20 16:08:31.361126 (MainThread): Parsing macros/etc/query.sql
2021-12-20 16:08:31.362109 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-20 16:08:31.363751 (MainThread): Parsing macros/etc/datetime.sql
2021-12-20 16:08:31.372713 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-20 16:08:31.374605 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-20 16:08:31.377050 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-20 16:08:31.378631 (MainThread): Parsing macros/adapters/common.sql
2021-12-20 16:08:31.438093 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-20 16:08:31.439903 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-20 16:08:31.441127 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-20 16:08:31.442500 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-20 16:08:31.638875 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-20 16:08:31.708260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:08:31.710358 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-20 16:08:31.720516 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-20 16:08:31.725613 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7518eb3-4c13-40a4-9fd1-68491f094634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ae250>]}
2021-12-20 16:08:31.730144 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-20 16:08:31.730528 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7518eb3-4c13-40a4-9fd1-68491f094634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72d220>]}
2021-12-20 16:08:31.730782 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-20 16:08:31.732188 (MainThread): 
2021-12-20 16:08:31.732600 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:08:31.733369 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:31.743167 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:31.744235 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-20 16:08:31.745361 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-20 16:08:32.118446 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.37 seconds
2021-12-20 16:08:32.118708 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-20 16:08:32.118834 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-20 16:08:32.158442 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.04 seconds
2021-12-20 16:08:32.159957 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-20 16:08:32.198456 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-20 16:08:32.203018 (MainThread): Using postgres connection "master".
2021-12-20 16:08:32.203223 (MainThread): On master: BEGIN
2021-12-20 16:08:32.203372 (MainThread): Opening a new connection, currently in state init
2021-12-20 16:08:32.946600 (MainThread): SQL status: BEGIN in 0.74 seconds
2021-12-20 16:08:32.946871 (MainThread): Using postgres connection "master".
2021-12-20 16:08:32.946997 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-20 16:08:32.988717 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-20 16:08:32.989928 (MainThread): On master: ROLLBACK
2021-12-20 16:08:33.028720 (MainThread): On master: Close
2021-12-20 16:08:33.029414 (MainThread): 23:08:33 | Concurrency: 1 threads (target='dev')
2021-12-20 16:08:33.029612 (MainThread): 23:08:33 | 
2021-12-20 16:08:33.031606 (Thread-1): Began running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-20 16:08:33.031847 (Thread-1): 23:08:33 | 1 of 2 START test not_null_clean_transport_delivery_orders_id........ [RUN]
2021-12-20 16:08:33.032231 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-20 16:08:33.032423 (Thread-1): Compiling test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-20 16:08:33.042391 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-20 16:08:33.044014 (Thread-1): finished collecting timing info
2021-12-20 16:08:33.074268 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-20 16:08:33.074901 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-20 16:08:33.075061 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: BEGIN
2021-12-20 16:08:33.075194 (Thread-1): Opening a new connection, currently in state closed
2021-12-20 16:08:33.388214 (Thread-1): SQL status: BEGIN in 0.31 seconds
2021-12-20 16:08:33.388440 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-20 16:08:33.388561 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is null



      
    ) dbt_internal_test
2021-12-20 16:08:33.528863 (Thread-1): SQL status: SELECT 1 in 0.14 seconds
2021-12-20 16:08:33.534028 (Thread-1): finished collecting timing info
2021-12-20 16:08:33.534409 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: ROLLBACK
2021-12-20 16:08:33.568949 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: Close
2021-12-20 16:08:33.570660 (Thread-1): 23:08:33 | 1 of 2 PASS not_null_clean_transport_delivery_orders_id.............. [PASS in 0.54s]
2021-12-20 16:08:33.571181 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-20 16:08:33.571672 (Thread-1): Began running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-20 16:08:33.572373 (Thread-1): 23:08:33 | 2 of 2 START test unique_clean_transport_delivery_orders_id.......... [RUN]
2021-12-20 16:08:33.573238 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-20 16:08:33.573662 (Thread-1): Compiling test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-20 16:08:33.586094 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-20 16:08:33.586872 (Thread-1): finished collecting timing info
2021-12-20 16:08:33.589425 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-20 16:08:33.589968 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-20 16:08:33.590138 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: BEGIN
2021-12-20 16:08:33.590297 (Thread-1): Opening a new connection, currently in state closed
2021-12-20 16:08:33.908296 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-20 16:08:33.908581 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-20 16:08:33.908749 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-20 16:08:34.280226 (Thread-1): SQL status: SELECT 1 in 0.37 seconds
2021-12-20 16:08:34.281696 (Thread-1): finished collecting timing info
2021-12-20 16:08:34.281971 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: ROLLBACK
2021-12-20 16:08:34.318469 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: Close
2021-12-20 16:08:34.320094 (Thread-1): 23:08:34 | 2 of 2 PASS unique_clean_transport_delivery_orders_id................ [PASS in 0.75s]
2021-12-20 16:08:34.320605 (Thread-1): Finished running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-20 16:08:34.323067 (MainThread): Acquiring new postgres connection "master".
2021-12-20 16:08:34.323942 (MainThread): 23:08:34 | 
2021-12-20 16:08:34.324388 (MainThread): 23:08:34 | Finished running 2 tests in 2.59s.
2021-12-20 16:08:34.324779 (MainThread): Connection 'master' was properly closed.
2021-12-20 16:08:34.325117 (MainThread): Connection 'test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924' was properly closed.
2021-12-20 16:08:34.333685 (MainThread): 
2021-12-20 16:08:34.334044 (MainThread): Completed successfully
2021-12-20 16:08:34.334313 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-20 16:08:34.334662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6cd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6392b0>]}
2021-12-20 16:08:34.335045 (MainThread): Flushing usage events
2021-12-21 01:28:31.362121 (MainThread): Running with dbt=0.21.0
2021-12-21 01:28:31.481160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 01:28:31.482662 (MainThread): Tracking: tracking
2021-12-21 01:28:31.501459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd23bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd60520>]}
2021-12-21 01:28:31.513853 (MainThread): Partial parsing not enabled
2021-12-21 01:28:31.531833 (MainThread): Parsing macros/catalog.sql
2021-12-21 01:28:31.537014 (MainThread): Parsing macros/relations.sql
2021-12-21 01:28:31.538520 (MainThread): Parsing macros/adapters.sql
2021-12-21 01:28:31.562442 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 01:28:31.564234 (MainThread): Parsing macros/core.sql
2021-12-21 01:28:31.568517 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 01:28:31.575576 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 01:28:31.586040 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 01:28:31.587746 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 01:28:31.607459 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 01:28:31.641893 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 01:28:31.665576 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 01:28:31.667519 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 01:28:31.678064 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 01:28:31.698649 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 01:28:31.713769 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 01:28:31.722147 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 01:28:31.730043 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 01:28:31.734002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 01:28:31.735679 (MainThread): Parsing macros/etc/query.sql
2021-12-21 01:28:31.736634 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 01:28:31.738145 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 01:28:31.747026 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 01:28:31.748814 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 01:28:31.751235 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 01:28:31.752804 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 01:28:31.810671 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 01:28:31.812461 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 01:28:31.813682 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 01:28:31.815051 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 01:28:32.024112 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:32.092734 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 01:28:32.094583 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 01:28:32.106750 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 01:28:32.111535 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd02d9835-46bb-4457-9f9d-9c8d28d4429e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdee490>]}
2021-12-21 01:28:32.116628 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 01:28:32.117619 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd02d9835-46bb-4457-9f9d-9c8d28d4429e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdf2250>]}
2021-12-21 01:28:32.117901 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 01:28:32.119073 (MainThread): 
2021-12-21 01:28:32.119455 (MainThread): Acquiring new postgres connection "master".
2021-12-21 01:28:32.120171 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 01:28:32.135384 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 01:28:32.135596 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 01:28:32.135767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 01:28:32.891602 (ThreadPoolExecutor-0_0): SQL status: SELECT 185 in 0.76 seconds
2021-12-21 01:28:32.894093 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 01:28:32.895421 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 01:28:32.901382 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 01:28:32.901587 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 01:28:32.901713 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 01:28:33.229134 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.33 seconds
2021-12-21 01:28:33.229701 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 01:28:33.230056 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 01:28:33.279102 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.05 seconds
2021-12-21 01:28:33.282473 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 01:28:33.329073 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 01:28:33.338708 (MainThread): Using postgres connection "master".
2021-12-21 01:28:33.339023 (MainThread): On master: BEGIN
2021-12-21 01:28:33.339267 (MainThread): Opening a new connection, currently in state init
2021-12-21 01:28:33.688971 (MainThread): SQL status: BEGIN in 0.35 seconds
2021-12-21 01:28:33.689514 (MainThread): Using postgres connection "master".
2021-12-21 01:28:33.689880 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 01:28:33.788749 (MainThread): SQL status: SELECT 0 in 0.10 seconds
2021-12-21 01:28:33.790390 (MainThread): On master: ROLLBACK
2021-12-21 01:28:33.828742 (MainThread): Using postgres connection "master".
2021-12-21 01:28:33.828999 (MainThread): On master: BEGIN
2021-12-21 01:28:33.908798 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 01:28:33.909131 (MainThread): On master: COMMIT
2021-12-21 01:28:33.909282 (MainThread): Using postgres connection "master".
2021-12-21 01:28:33.909401 (MainThread): On master: COMMIT
2021-12-21 01:28:33.948707 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 01:28:33.948960 (MainThread): On master: Close
2021-12-21 01:28:33.949467 (MainThread): 08:28:33 | Concurrency: 1 threads (target='dev')
2021-12-21 01:28:33.949675 (MainThread): 08:28:33 | 
2021-12-21 01:28:33.952049 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 01:28:33.952365 (Thread-1): 08:28:33 | 1 of 1 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 01:28:33.952689 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:33.952843 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 01:28:33.954199 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 01:28:33.955663 (Thread-1): finished collecting timing info
2021-12-21 01:28:33.989706 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 01:28:33.991341 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:33.991552 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 01:28:33.991691 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 01:28:34.329012 (Thread-1): SQL status: BEGIN in 0.34 seconds
2021-12-21 01:28:34.329562 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:34.329997 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 01:28:45.408750 (Thread-1): SQL status: SELECT 388512 in 11.08 seconds
2021-12-21 01:28:45.421668 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:45.421960 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 01:28:45.488786 (Thread-1): SQL status: ALTER TABLE in 0.07 seconds
2021-12-21 01:28:45.495520 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:45.495816 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 01:28:45.548756 (Thread-1): SQL status: ALTER TABLE in 0.05 seconds
2021-12-21 01:28:45.568708 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 01:28:45.568956 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:45.569110 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 01:28:45.608803 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 01:28:45.620082 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 01:28:45.620465 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 01:28:45.768618 (Thread-1): SQL status: DROP TABLE in 0.15 seconds
2021-12-21 01:28:45.771788 (Thread-1): finished collecting timing info
2021-12-21 01:28:45.772272 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 01:28:45.773437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd02d9835-46bb-4457-9f9d-9c8d28d4429e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beac040>]}
2021-12-21 01:28:45.774060 (Thread-1): 08:28:45 | 1 of 1 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388512 in 11.82s]
2021-12-21 01:28:45.774373 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 01:28:45.776350 (MainThread): Acquiring new postgres connection "master".
2021-12-21 01:28:45.776723 (MainThread): Using postgres connection "master".
2021-12-21 01:28:45.776956 (MainThread): On master: BEGIN
2021-12-21 01:28:45.777181 (MainThread): Opening a new connection, currently in state closed
2021-12-21 01:28:46.248613 (MainThread): SQL status: BEGIN in 0.47 seconds
2021-12-21 01:28:46.249235 (MainThread): On master: COMMIT
2021-12-21 01:28:46.249600 (MainThread): Using postgres connection "master".
2021-12-21 01:28:46.249928 (MainThread): On master: COMMIT
2021-12-21 01:28:46.299242 (MainThread): SQL status: COMMIT in 0.05 seconds
2021-12-21 01:28:46.300304 (MainThread): On master: Close
2021-12-21 01:28:46.301165 (MainThread): 08:28:46 | 
2021-12-21 01:28:46.301489 (MainThread): 08:28:46 | Finished running 1 table model in 14.18s.
2021-12-21 01:28:46.301750 (MainThread): Connection 'master' was properly closed.
2021-12-21 01:28:46.301964 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 01:28:46.314962 (MainThread): 
2021-12-21 01:28:46.315229 (MainThread): Completed successfully
2021-12-21 01:28:46.315420 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-21 01:28:46.315676 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf13fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be252e0>]}
2021-12-21 01:28:46.315965 (MainThread): Flushing usage events
2021-12-21 02:08:03.586290 (MainThread): Running with dbt=0.21.0
2021-12-21 02:08:03.691543 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 02:08:03.693452 (MainThread): Tracking: tracking
2021-12-21 02:08:03.721318 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cf79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d189d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2c400>]}
2021-12-21 02:08:03.735206 (MainThread): Partial parsing not enabled
2021-12-21 02:08:03.753589 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:08:03.758561 (MainThread): Parsing macros/relations.sql
2021-12-21 02:08:03.760130 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:08:03.785555 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:08:03.787404 (MainThread): Parsing macros/core.sql
2021-12-21 02:08:03.791620 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:08:03.799397 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:08:03.810614 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:08:03.812572 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:08:03.832067 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:08:03.868103 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:08:03.893380 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:08:03.895406 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:08:03.907817 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:08:03.930023 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:08:03.945419 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:08:03.954012 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:08:03.962146 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:08:03.966601 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:08:03.968320 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:08:03.969348 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:08:03.971137 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:08:03.980623 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:08:03.982755 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:08:03.985543 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:08:03.987261 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:08:04.047502 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:08:04.049391 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:08:04.050681 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:08:04.052262 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:08:04.275062 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:04.288175 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:04.350014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:08:04.351953 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:08:04.353807 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:08:04.355895 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:08:04.369151 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:08:04.374255 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6efa94d-0d4a-4b7a-97f6-7a31dbb6a1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04910>]}
2021-12-21 02:08:04.380501 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:08:04.382613 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6efa94d-0d4a-4b7a-97f6-7a31dbb6a1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04df0>]}
2021-12-21 02:08:04.382918 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:08:04.384195 (MainThread): 
2021-12-21 02:08:04.384749 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:08:04.386377 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 02:08:04.404580 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 02:08:04.404899 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 02:08:04.405211 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 02:08:05.501552 (ThreadPoolExecutor-0_0): SQL status: SELECT 187 in 1.10 seconds
2021-12-21 02:08:05.507510 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 02:08:05.510092 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:08:05.520760 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:08:05.521095 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:08:05.521279 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 02:08:05.920497 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.40 seconds
2021-12-21 02:08:05.921199 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:08:05.921353 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:08:05.960394 (ThreadPoolExecutor-1_0): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 02:08:05.961846 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:08:06.000463 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:08:06.004542 (MainThread): Using postgres connection "master".
2021-12-21 02:08:06.004719 (MainThread): On master: BEGIN
2021-12-21 02:08:06.004838 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:08:06.320630 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:08:06.321059 (MainThread): Using postgres connection "master".
2021-12-21 02:08:06.321193 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:08:06.360699 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:08:06.361885 (MainThread): On master: ROLLBACK
2021-12-21 02:08:06.400448 (MainThread): Using postgres connection "master".
2021-12-21 02:08:06.400690 (MainThread): On master: BEGIN
2021-12-21 02:08:06.480491 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 02:08:06.480731 (MainThread): On master: COMMIT
2021-12-21 02:08:06.480972 (MainThread): Using postgres connection "master".
2021-12-21 02:08:06.481096 (MainThread): On master: COMMIT
2021-12-21 02:08:06.523148 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:08:06.523404 (MainThread): On master: Close
2021-12-21 02:08:06.523899 (MainThread): 09:08:06 | Concurrency: 1 threads (target='dev')
2021-12-21 02:08:06.524071 (MainThread): 09:08:06 | 
2021-12-21 02:08:06.526885 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:08:06.527198 (Thread-1): 09:08:06 | 1 of 2 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 02:08:06.527501 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:06.527649 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:08:06.528985 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:08:06.530007 (Thread-1): finished collecting timing info
2021-12-21 02:08:06.560567 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:08:06.561237 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:06.561386 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 02:08:06.561505 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:08:06.880627 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:08:06.880897 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:06.881038 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 02:08:06.950579 (Thread-1): SQL status: SELECT 2816 in 0.07 seconds
2021-12-21 02:08:06.956707 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:06.956891 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 02:08:06.990843 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 02:08:07.001532 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:08:07.001718 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:07.001835 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:08:07.040948 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:08:07.046750 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:08:07.046928 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 02:08:07.090587 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 02:08:07.091992 (Thread-1): finished collecting timing info
2021-12-21 02:08:07.092209 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 02:08:07.092740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6efa94d-0d4a-4b7a-97f6-7a31dbb6a1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4d3d0>]}
2021-12-21 02:08:07.093083 (Thread-1): 09:08:07 | 1 of 2 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.57s]
2021-12-21 02:08:07.093260 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:08:07.093439 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:08:07.093755 (Thread-1): 09:08:07 | 2 of 2 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 02:08:07.094051 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:07.094240 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:08:07.095694 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:08:07.097483 (Thread-1): finished collecting timing info
2021-12-21 02:08:07.099515 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:08:07.099956 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:07.100083 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 02:08:07.100196 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:08:07.431219 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 02:08:07.431457 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:07.431583 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 02:08:12.820929 (Thread-1): SQL status: SELECT 388534 in 5.39 seconds
2021-12-21 02:08:12.826667 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:12.827000 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 02:08:12.871368 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:08:12.877173 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:12.877505 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 02:08:12.920632 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:08:12.924805 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:08:12.925226 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:12.925475 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:08:12.991243 (Thread-1): SQL status: COMMIT in 0.07 seconds
2021-12-21 02:08:12.995762 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:08:12.996081 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 02:08:13.070771 (Thread-1): SQL status: DROP TABLE in 0.07 seconds
2021-12-21 02:08:13.073278 (Thread-1): finished collecting timing info
2021-12-21 02:08:13.073654 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 02:08:13.074847 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6efa94d-0d4a-4b7a-97f6-7a31dbb6a1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4ddf0>]}
2021-12-21 02:08:13.075551 (Thread-1): 09:08:13 | 2 of 2 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388534 in 5.98s]
2021-12-21 02:08:13.075869 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:08:13.077437 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:08:13.077735 (MainThread): Using postgres connection "master".
2021-12-21 02:08:13.077944 (MainThread): On master: BEGIN
2021-12-21 02:08:13.078144 (MainThread): Opening a new connection, currently in state closed
2021-12-21 02:08:13.400281 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:08:13.400682 (MainThread): On master: COMMIT
2021-12-21 02:08:13.400944 (MainThread): Using postgres connection "master".
2021-12-21 02:08:13.401162 (MainThread): On master: COMMIT
2021-12-21 02:08:13.440601 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:08:13.440943 (MainThread): On master: Close
2021-12-21 02:08:13.441484 (MainThread): 09:08:13 | 
2021-12-21 02:08:13.441669 (MainThread): 09:08:13 | Finished running 2 table models in 9.06s.
2021-12-21 02:08:13.441823 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:08:13.441939 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 02:08:13.446655 (MainThread): 
2021-12-21 02:08:13.446854 (MainThread): Completed successfully
2021-12-21 02:08:13.447000 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-21 02:08:13.447210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f30cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d6c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d602e0>]}
2021-12-21 02:08:13.447421 (MainThread): Flushing usage events
2021-12-21 02:09:29.476057 (MainThread): Running with dbt=0.21.0
2021-12-21 02:09:29.587222 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 02:09:29.588313 (MainThread): Tracking: tracking
2021-12-21 02:09:29.603910 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a694f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa14c0>]}
2021-12-21 02:09:29.617012 (MainThread): Partial parsing not enabled
2021-12-21 02:09:29.634698 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:09:29.639591 (MainThread): Parsing macros/relations.sql
2021-12-21 02:09:29.641074 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:09:29.666149 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:09:29.668068 (MainThread): Parsing macros/core.sql
2021-12-21 02:09:29.672535 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:09:29.680026 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:09:29.691188 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:09:29.693140 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:09:29.712610 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:09:29.748681 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:09:29.775496 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:09:29.777634 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:09:29.789203 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:09:29.811675 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:09:29.830532 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:09:29.844246 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:09:29.855213 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:09:29.860124 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:09:29.862012 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:09:29.863199 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:09:29.865075 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:09:29.876263 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:09:29.878744 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:09:29.881759 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:09:29.883853 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:09:29.945118 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:09:29.946965 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:09:29.948259 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:09:29.949810 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:09:30.150316 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:30.163730 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:30.219871 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:09:30.221762 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:09:30.223701 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:09:30.225683 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:09:30.237021 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:09:30.242565 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1fbfe53-69dc-4af9-b87f-ea899331c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b756d0>]}
2021-12-21 02:09:30.248039 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:09:30.248570 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1fbfe53-69dc-4af9-b87f-ea899331c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b75d60>]}
2021-12-21 02:09:30.248829 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:09:30.250198 (MainThread): 
2021-12-21 02:09:30.250536 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:09:30.251302 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 02:09:30.264375 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 02:09:30.264566 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 02:09:30.264686 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 02:09:30.817587 (ThreadPoolExecutor-0_0): SQL status: SELECT 187 in 0.55 seconds
2021-12-21 02:09:30.823339 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 02:09:30.825910 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:09:30.837370 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:09:30.837640 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:09:30.837819 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 02:09:31.147472 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:09:31.148019 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:09:31.148283 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:09:31.186860 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.04 seconds
2021-12-21 02:09:31.188603 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:09:31.227268 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:09:31.237173 (MainThread): Using postgres connection "master".
2021-12-21 02:09:31.237507 (MainThread): On master: BEGIN
2021-12-21 02:09:31.237718 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:09:31.547130 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:09:31.547692 (MainThread): Using postgres connection "master".
2021-12-21 02:09:31.548061 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:09:31.587115 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:09:31.588702 (MainThread): On master: ROLLBACK
2021-12-21 02:09:31.627247 (MainThread): Using postgres connection "master".
2021-12-21 02:09:31.627851 (MainThread): On master: BEGIN
2021-12-21 02:09:31.707823 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 02:09:31.708416 (MainThread): On master: COMMIT
2021-12-21 02:09:31.708906 (MainThread): Using postgres connection "master".
2021-12-21 02:09:31.709298 (MainThread): On master: COMMIT
2021-12-21 02:09:31.747513 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:09:31.748261 (MainThread): On master: Close
2021-12-21 02:09:31.749705 (MainThread): 09:09:31 | Concurrency: 1 threads (target='dev')
2021-12-21 02:09:31.750239 (MainThread): 09:09:31 | 
2021-12-21 02:09:31.755768 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:09:31.756504 (Thread-1): 09:09:31 | 1 of 2 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 02:09:31.757179 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:31.757588 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:09:31.760944 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:09:31.761942 (Thread-1): finished collecting timing info
2021-12-21 02:09:31.815888 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:09:31.816537 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:31.816732 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 02:09:31.816945 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:09:32.137240 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:09:32.137664 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:32.137911 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 02:09:32.207227 (Thread-1): SQL status: SELECT 2816 in 0.07 seconds
2021-12-21 02:09:32.220798 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:32.221120 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 02:09:32.257398 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:09:32.263183 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:32.263532 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 02:09:32.308632 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:09:32.329758 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:09:32.330103 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:32.330276 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:09:32.379693 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 02:09:32.388963 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:09:32.389221 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 02:09:32.437191 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 02:09:32.440604 (Thread-1): finished collecting timing info
2021-12-21 02:09:32.441137 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 02:09:32.442278 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fbfe53-69dc-4af9-b87f-ea899331c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae19a0>]}
2021-12-21 02:09:32.442989 (Thread-1): 09:09:32 | 1 of 2 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.69s]
2021-12-21 02:09:32.443325 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:09:32.443666 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:09:32.444315 (Thread-1): 09:09:32 | 2 of 2 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 02:09:32.444940 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:32.445234 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:09:32.447864 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:09:32.449340 (Thread-1): finished collecting timing info
2021-12-21 02:09:32.453044 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:09:32.453891 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:32.454123 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 02:09:32.454329 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:09:32.776946 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:09:32.777345 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:32.777589 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 02:09:38.176880 (Thread-1): SQL status: SELECT 388534 in 5.40 seconds
2021-12-21 02:09:38.182913 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:38.183265 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 02:09:39.226959 (Thread-1): SQL status: ALTER TABLE in 1.04 seconds
2021-12-21 02:09:39.233010 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:39.233367 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 02:09:39.276807 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:09:39.280622 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:09:39.281116 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:39.281486 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:09:39.327046 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 02:09:39.331920 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:09:39.332307 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 02:09:39.437065 (Thread-1): SQL status: DROP TABLE in 0.10 seconds
2021-12-21 02:09:39.440435 (Thread-1): finished collecting timing info
2021-12-21 02:09:39.440975 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 02:09:39.442409 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fbfe53-69dc-4af9-b87f-ea899331c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a510d0>]}
2021-12-21 02:09:39.443112 (Thread-1): 09:09:39 | 2 of 2 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388534 in 7.00s]
2021-12-21 02:09:39.443498 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:09:39.445507 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:09:39.445855 (MainThread): Using postgres connection "master".
2021-12-21 02:09:39.446093 (MainThread): On master: BEGIN
2021-12-21 02:09:39.446323 (MainThread): Opening a new connection, currently in state closed
2021-12-21 02:09:39.777087 (MainThread): SQL status: BEGIN in 0.33 seconds
2021-12-21 02:09:39.777736 (MainThread): On master: COMMIT
2021-12-21 02:09:39.778299 (MainThread): Using postgres connection "master".
2021-12-21 02:09:39.778865 (MainThread): On master: COMMIT
2021-12-21 02:09:39.816672 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:09:39.817183 (MainThread): On master: Close
2021-12-21 02:09:39.818002 (MainThread): 09:09:39 | 
2021-12-21 02:09:39.818387 (MainThread): 09:09:39 | Finished running 2 table models in 9.57s.
2021-12-21 02:09:39.818600 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:09:39.818770 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 02:09:39.824530 (MainThread): 
2021-12-21 02:09:39.824787 (MainThread): Completed successfully
2021-12-21 02:09:39.824977 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-21 02:09:39.825233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad5340>]}
2021-12-21 02:09:39.825547 (MainThread): Flushing usage events
2021-12-21 02:20:36.864892 (MainThread): Running with dbt=0.21.0
2021-12-21 02:20:36.979553 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 02:20:36.981119 (MainThread): Tracking: tracking
2021-12-21 02:20:36.996957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a189a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a329d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a44400>]}
2021-12-21 02:20:37.010330 (MainThread): Partial parsing not enabled
2021-12-21 02:20:37.028057 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:20:37.032858 (MainThread): Parsing macros/relations.sql
2021-12-21 02:20:37.034419 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:20:37.059023 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:20:37.060879 (MainThread): Parsing macros/core.sql
2021-12-21 02:20:37.065135 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:20:37.072741 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:20:37.083713 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:20:37.085558 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:20:37.105224 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:20:37.141571 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:20:37.167885 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:20:37.169899 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:20:37.181253 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:20:37.203383 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:20:37.218719 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:20:37.227424 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:20:37.235966 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:20:37.240414 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:20:37.242073 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:20:37.243233 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:20:37.244882 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:20:37.254425 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:20:37.256408 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:20:37.259082 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:20:37.260809 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:20:37.321842 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:20:37.323806 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:20:37.325107 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:20:37.326533 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:20:37.533668 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:37.547219 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:37.583333 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:37.615204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:20:37.617188 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:20:37.619025 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:20:37.620968 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:20:37.631537 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:20:37.636840 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '367e635d-495d-444b-89b8-b5544a668530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b4ed00>]}
2021-12-21 02:20:37.642983 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:20:37.643606 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '367e635d-495d-444b-89b8-b5544a668530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b516a0>]}
2021-12-21 02:20:37.643871 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:20:37.645206 (MainThread): 
2021-12-21 02:20:37.645531 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:20:37.646342 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 02:20:37.667561 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 02:20:37.667793 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 02:20:37.667938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 02:20:38.388885 (ThreadPoolExecutor-0_0): SQL status: SELECT 187 in 0.72 seconds
2021-12-21 02:20:38.392587 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 02:20:38.394117 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:20:38.400679 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:20:38.400870 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:20:38.400999 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 02:20:38.718383 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:20:38.718919 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:20:38.719268 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:20:38.758558 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.04 seconds
2021-12-21 02:20:38.762145 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:20:38.798545 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:20:38.806828 (MainThread): Using postgres connection "master".
2021-12-21 02:20:38.807132 (MainThread): On master: BEGIN
2021-12-21 02:20:38.807346 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:20:39.118459 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:20:39.119030 (MainThread): Using postgres connection "master".
2021-12-21 02:20:39.119394 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:20:39.158729 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:20:39.161992 (MainThread): On master: ROLLBACK
2021-12-21 02:20:39.197951 (MainThread): Using postgres connection "master".
2021-12-21 02:20:39.198204 (MainThread): On master: BEGIN
2021-12-21 02:20:39.278378 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 02:20:39.279007 (MainThread): On master: COMMIT
2021-12-21 02:20:39.279430 (MainThread): Using postgres connection "master".
2021-12-21 02:20:39.279766 (MainThread): On master: COMMIT
2021-12-21 02:20:39.318788 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:20:39.319564 (MainThread): On master: Close
2021-12-21 02:20:39.321027 (MainThread): 09:20:39 | Concurrency: 1 threads (target='dev')
2021-12-21 02:20:39.321564 (MainThread): 09:20:39 | 
2021-12-21 02:20:39.326429 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:20:39.327039 (Thread-1): 09:20:39 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 02:20:39.327674 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:39.328001 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:20:39.334825 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 02:20:39.338121 (Thread-1): finished collecting timing info
2021-12-21 02:20:39.395754 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 02:20:39.396374 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:39.396537 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 02:20:39.396687 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:20:39.718858 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:20:39.719482 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:39.719855 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 02:20:40.109803 (Thread-1): SQL status: SELECT 62744 in 0.39 seconds
2021-12-21 02:20:40.123151 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:40.123590 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 02:20:40.158567 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 02:20:40.181013 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 02:20:40.181283 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:40.181450 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 02:20:40.218527 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:20:40.227475 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:20:40.227780 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 02:20:40.268717 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 02:20:40.272458 (Thread-1): finished collecting timing info
2021-12-21 02:20:40.273041 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 02:20:40.274251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367e635d-495d-444b-89b8-b5544a668530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa3820>]}
2021-12-21 02:20:40.274967 (Thread-1): 09:20:40 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62744 in 0.95s]
2021-12-21 02:20:40.275308 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:20:40.275652 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:20:40.276263 (Thread-1): 09:20:40 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 02:20:40.276887 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.277183 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:20:40.279804 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:20:40.282172 (Thread-1): finished collecting timing info
2021-12-21 02:20:40.286239 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:20:40.287111 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.287341 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 02:20:40.287547 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:20:40.608987 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:20:40.609549 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.609913 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 02:20:40.678524 (Thread-1): SQL status: SELECT 2816 in 0.07 seconds
2021-12-21 02:20:40.684509 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.684839 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 02:20:40.728768 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:20:40.734675 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.735037 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 02:20:40.778576 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:20:40.781754 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:20:40.782170 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.782408 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:20:40.828524 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 02:20:40.831380 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:20:40.831695 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 02:20:40.878682 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 02:20:40.880004 (Thread-1): finished collecting timing info
2021-12-21 02:20:40.880315 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 02:20:40.880892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367e635d-495d-444b-89b8-b5544a668530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d43130>]}
2021-12-21 02:20:40.881243 (Thread-1): 09:20:40 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.60s]
2021-12-21 02:20:40.881409 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:20:40.881584 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:20:40.881926 (Thread-1): 09:20:40 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 02:20:40.882286 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:40.882445 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:20:40.884054 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:20:40.885087 (Thread-1): finished collecting timing info
2021-12-21 02:20:40.887274 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:20:40.887722 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:40.887845 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 02:20:40.887955 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:20:41.209041 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:20:41.209686 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:41.210355 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 02:20:48.609871 (Thread-1): SQL status: SELECT 388569 in 7.40 seconds
2021-12-21 02:20:48.614925 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:48.615365 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 02:20:48.659683 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:20:48.665834 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:48.666205 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 02:20:48.709725 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:20:48.713411 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:20:48.713872 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:48.714129 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:20:48.759933 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 02:20:48.764718 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:20:48.765094 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 02:20:48.819660 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 02:20:48.821361 (Thread-1): finished collecting timing info
2021-12-21 02:20:48.821648 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 02:20:48.822327 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '367e635d-495d-444b-89b8-b5544a668530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d43580>]}
2021-12-21 02:20:48.822767 (Thread-1): 09:20:48 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388569 in 7.94s]
2021-12-21 02:20:48.822979 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:20:48.824479 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:20:48.824801 (MainThread): Using postgres connection "master".
2021-12-21 02:20:48.824970 (MainThread): On master: BEGIN
2021-12-21 02:20:48.825125 (MainThread): Opening a new connection, currently in state closed
2021-12-21 02:20:49.169526 (MainThread): SQL status: BEGIN in 0.34 seconds
2021-12-21 02:20:49.169894 (MainThread): On master: COMMIT
2021-12-21 02:20:49.170066 (MainThread): Using postgres connection "master".
2021-12-21 02:20:49.170247 (MainThread): On master: COMMIT
2021-12-21 02:20:49.209478 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:20:49.209757 (MainThread): On master: Close
2021-12-21 02:20:49.210344 (MainThread): 09:20:49 | 
2021-12-21 02:20:49.210561 (MainThread): 09:20:49 | Finished running 3 table models in 11.56s.
2021-12-21 02:20:49.210737 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:20:49.210863 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 02:20:49.223125 (MainThread): 
2021-12-21 02:20:49.223440 (MainThread): Completed successfully
2021-12-21 02:20:49.223837 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 02:20:49.224273 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68730>]}
2021-12-21 02:20:49.224913 (MainThread): Flushing usage events
2021-12-21 02:25:10.327056 (MainThread): Running with dbt=0.21.0
2021-12-21 02:25:10.457187 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-21 02:25:10.458761 (MainThread): Tracking: tracking
2021-12-21 02:25:10.488348 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134feca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113515a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11352b4f0>]}
2021-12-21 02:25:10.504092 (MainThread): Partial parsing not enabled
2021-12-21 02:25:10.523760 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:25:10.528668 (MainThread): Parsing macros/relations.sql
2021-12-21 02:25:10.530368 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:25:10.558253 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:25:10.560175 (MainThread): Parsing macros/core.sql
2021-12-21 02:25:10.564519 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:25:10.572765 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:25:10.584392 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:25:10.586349 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:25:10.607311 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:25:10.643712 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:25:10.669458 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:25:10.671478 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:25:10.683126 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:25:10.705059 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:25:10.720961 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:25:10.729907 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:25:10.738036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:25:10.742747 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:25:10.744556 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:25:10.746072 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:25:10.748399 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:25:10.758914 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:25:10.761023 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:25:10.763713 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:25:10.765468 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:25:10.826141 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:25:10.828179 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:25:10.829529 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:25:10.831090 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:25:11.039718 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:25:11.053671 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:25:11.087557 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:25:11.122520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.124550 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.126367 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.129548 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.131794 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.133692 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:25:11.144821 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:25:11.151274 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a830804f-1abb-4d19-b0f0-057e92926ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113637f40>]}
2021-12-21 02:25:11.162886 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:25:11.164598 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a830804f-1abb-4d19-b0f0-057e92926ed9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113637dc0>]}
2021-12-21 02:25:11.165082 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:25:11.172259 (MainThread): 
2021-12-21 02:25:11.173675 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:25:11.177756 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:25:11.195524 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:25:11.195752 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:25:11.195898 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-21 02:25:11.861393 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.67 seconds
2021-12-21 02:25:11.861929 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:25:11.862277 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:25:11.901225 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 02:25:11.904571 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:25:11.941264 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:25:11.951652 (MainThread): Using postgres connection "master".
2021-12-21 02:25:11.952112 (MainThread): On master: BEGIN
2021-12-21 02:25:11.952379 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:25:12.271196 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:25:12.271735 (MainThread): Using postgres connection "master".
2021-12-21 02:25:12.272101 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:25:12.311050 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:25:12.314042 (MainThread): On master: ROLLBACK
2021-12-21 02:25:12.351259 (MainThread): On master: Close
2021-12-21 02:25:12.352464 (MainThread): 09:25:12 | Concurrency: 1 threads (target='dev')
2021-12-21 02:25:12.352812 (MainThread): 09:25:12 | 
2021-12-21 02:25:12.357059 (Thread-1): Began running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:25:12.357519 (Thread-1): 09:25:12 | 1 of 6 START test not_null_clean_odoo_purchase_order_id.............. [RUN]
2021-12-21 02:25:12.358138 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:25:12.358459 (Thread-1): Compiling test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:25:12.372477 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 02:25:12.375245 (Thread-1): finished collecting timing info
2021-12-21 02:25:12.408275 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 02:25:12.408891 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:25:12.409047 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: BEGIN
2021-12-21 02:25:12.409184 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:12.731081 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:25:12.731484 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:25:12.731729 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:25:12.790788 (Thread-1): SQL status: SELECT 1 in 0.06 seconds
2021-12-21 02:25:12.793387 (Thread-1): finished collecting timing info
2021-12-21 02:25:12.793635 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: ROLLBACK
2021-12-21 02:25:12.831306 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: Close
2021-12-21 02:25:12.833151 (Thread-1): 09:25:12 | 1 of 6 PASS not_null_clean_odoo_purchase_order_id.................... [PASS in 0.48s]
2021-12-21 02:25:12.833750 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:25:12.834351 (Thread-1): Began running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:25:12.835056 (Thread-1): 09:25:12 | 2 of 6 START test not_null_clean_partner_company_phones_id........... [RUN]
2021-12-21 02:25:12.835715 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:25:12.836015 (Thread-1): Compiling test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:25:12.842949 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 02:25:12.843716 (Thread-1): finished collecting timing info
2021-12-21 02:25:12.846606 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 02:25:12.847449 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:25:12.847663 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: BEGIN
2021-12-21 02:25:12.847843 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:13.172181 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:25:13.172528 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:25:13.172742 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:25:13.211211 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 02:25:13.214646 (Thread-1): finished collecting timing info
2021-12-21 02:25:13.215018 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: ROLLBACK
2021-12-21 02:25:13.251199 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: Close
2021-12-21 02:25:13.252705 (Thread-1): 09:25:13 | 2 of 6 PASS not_null_clean_partner_company_phones_id................. [PASS in 0.42s]
2021-12-21 02:25:13.253200 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:25:13.253688 (Thread-1): Began running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:25:13.254377 (Thread-1): 09:25:13 | 3 of 6 START test not_null_clean_transport_delivery_orders_id........ [RUN]
2021-12-21 02:25:13.255216 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:25:13.255620 (Thread-1): Compiling test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:25:13.265658 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 02:25:13.271065 (Thread-1): finished collecting timing info
2021-12-21 02:25:13.274876 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 02:25:13.275845 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:25:13.276032 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: BEGIN
2021-12-21 02:25:13.276192 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:13.601350 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 02:25:13.601913 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:25:13.602261 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:25:13.671304 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2021-12-21 02:25:13.674468 (Thread-1): finished collecting timing info
2021-12-21 02:25:13.674887 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: ROLLBACK
2021-12-21 02:25:13.710979 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: Close
2021-12-21 02:25:13.712404 (Thread-1): 09:25:13 | 3 of 6 PASS not_null_clean_transport_delivery_orders_id.............. [PASS in 0.46s]
2021-12-21 02:25:13.712897 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:25:13.713365 (Thread-1): Began running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:25:13.713682 (Thread-1): 09:25:13 | 4 of 6 START test unique_clean_odoo_purchase_order_id................ [RUN]
2021-12-21 02:25:13.714212 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:25:13.714496 (Thread-1): Compiling test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:25:13.729165 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 02:25:13.729799 (Thread-1): finished collecting timing info
2021-12-21 02:25:13.732210 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 02:25:13.733342 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:25:13.733582 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: BEGIN
2021-12-21 02:25:13.733750 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:14.071115 (Thread-1): SQL status: BEGIN in 0.34 seconds
2021-12-21 02:25:14.071691 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:25:14.072057 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:25:14.151571 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-12-21 02:25:14.155156 (Thread-1): finished collecting timing info
2021-12-21 02:25:14.155579 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: ROLLBACK
2021-12-21 02:25:14.190847 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: Close
2021-12-21 02:25:14.192574 (Thread-1): 09:25:14 | 4 of 6 PASS unique_clean_odoo_purchase_order_id...................... [PASS in 0.48s]
2021-12-21 02:25:14.193077 (Thread-1): Finished running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:25:14.193567 (Thread-1): Began running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:25:14.194247 (Thread-1): 09:25:14 | 5 of 6 START test unique_clean_partner_company_phones_id............. [RUN]
2021-12-21 02:25:14.195182 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:25:14.195607 (Thread-1): Compiling test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:25:14.202699 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 02:25:14.203475 (Thread-1): finished collecting timing info
2021-12-21 02:25:14.206233 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 02:25:14.207102 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:25:14.207356 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: BEGIN
2021-12-21 02:25:14.207566 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:14.530673 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:25:14.530930 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:25:14.531059 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:25:14.570853 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 02:25:14.572413 (Thread-1): finished collecting timing info
2021-12-21 02:25:14.572639 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: ROLLBACK
2021-12-21 02:25:14.611039 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: Close
2021-12-21 02:25:14.612556 (Thread-1): 09:25:14 | 5 of 6 PASS unique_clean_partner_company_phones_id................... [PASS in 0.42s]
2021-12-21 02:25:14.613044 (Thread-1): Finished running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:25:14.613529 (Thread-1): Began running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:25:14.613969 (Thread-1): 09:25:14 | 6 of 6 START test unique_clean_transport_delivery_orders_id.......... [RUN]
2021-12-21 02:25:14.614576 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:25:14.614875 (Thread-1): Compiling test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:25:14.621675 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 02:25:14.622488 (Thread-1): finished collecting timing info
2021-12-21 02:25:14.625274 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 02:25:14.627088 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:25:14.627434 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: BEGIN
2021-12-21 02:25:14.627657 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:25:14.951430 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:25:14.951977 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:25:14.952341 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:25:15.361961 (Thread-1): SQL status: SELECT 1 in 0.41 seconds
2021-12-21 02:25:15.365587 (Thread-1): finished collecting timing info
2021-12-21 02:25:15.366035 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: ROLLBACK
2021-12-21 02:25:15.401453 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: Close
2021-12-21 02:25:15.402844 (Thread-1): 09:25:15 | 6 of 6 PASS unique_clean_transport_delivery_orders_id................ [PASS in 0.79s]
2021-12-21 02:25:15.403337 (Thread-1): Finished running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:25:15.406056 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:25:15.406930 (MainThread): 09:25:15 | 
2021-12-21 02:25:15.407248 (MainThread): 09:25:15 | Finished running 6 tests in 4.23s.
2021-12-21 02:25:15.407531 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:25:15.407759 (MainThread): Connection 'test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924' was properly closed.
2021-12-21 02:25:15.416424 (MainThread): 
2021-12-21 02:25:15.416796 (MainThread): Completed successfully
2021-12-21 02:25:15.417295 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-21 02:25:15.418211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11375a7f0>]}
2021-12-21 02:25:15.420065 (MainThread): Flushing usage events
2021-12-21 02:43:02.539133 (MainThread): Running with dbt=0.21.0
2021-12-21 02:43:02.645742 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 02:43:02.647874 (MainThread): Tracking: tracking
2021-12-21 02:43:02.661878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eae6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eafda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb134f0>]}
2021-12-21 02:43:02.675056 (MainThread): Partial parsing not enabled
2021-12-21 02:43:02.695745 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:43:02.700653 (MainThread): Parsing macros/relations.sql
2021-12-21 02:43:02.702147 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:43:02.727517 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:43:02.729522 (MainThread): Parsing macros/core.sql
2021-12-21 02:43:02.733631 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:43:02.741324 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:43:02.753266 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:43:02.755128 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:43:02.775006 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:43:02.814165 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:43:02.841029 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:43:02.843037 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:43:02.854871 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:43:02.877310 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:43:02.893393 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:43:02.902298 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:43:02.910342 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:43:02.914893 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:43:02.916678 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:43:02.917774 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:43:02.919448 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:43:02.928994 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:43:02.931039 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:43:02.933654 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:43:02.935340 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:43:03.002608 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:43:03.004874 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:43:03.006353 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:43:03.008894 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:43:03.217894 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:03.231146 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:03.259609 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:03.291220 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.293139 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.294969 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.298194 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.300146 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.301962 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:43:03.312848 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:43:03.318105 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f817c43-bda1-443c-b523-45ab41e5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec1f8e0>]}
2021-12-21 02:43:03.323792 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:43:03.325145 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f817c43-bda1-443c-b523-45ab41e5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec1f790>]}
2021-12-21 02:43:03.325427 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:43:03.326890 (MainThread): 
2021-12-21 02:43:03.327227 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:43:03.328242 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 02:43:03.340207 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 02:43:03.340396 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 02:43:03.340518 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 02:43:03.812560 (ThreadPoolExecutor-0_0): SQL status: SELECT 187 in 0.47 seconds
2021-12-21 02:43:03.817252 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 02:43:03.819489 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:43:03.828387 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:43:03.828637 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:43:03.828863 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 02:43:04.139218 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:43:04.139747 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:43:04.140087 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:43:04.179175 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 02:43:04.182658 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:43:04.219208 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:43:04.229055 (MainThread): Using postgres connection "master".
2021-12-21 02:43:04.229429 (MainThread): On master: BEGIN
2021-12-21 02:43:04.229657 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:43:04.539266 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:43:04.539747 (MainThread): Using postgres connection "master".
2021-12-21 02:43:04.539957 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:43:04.578854 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:43:04.580292 (MainThread): On master: ROLLBACK
2021-12-21 02:43:04.619002 (MainThread): Using postgres connection "master".
2021-12-21 02:43:04.619282 (MainThread): On master: BEGIN
2021-12-21 02:43:04.699200 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 02:43:04.699752 (MainThread): On master: COMMIT
2021-12-21 02:43:04.700119 (MainThread): Using postgres connection "master".
2021-12-21 02:43:04.700441 (MainThread): On master: COMMIT
2021-12-21 02:43:04.739035 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:43:04.739690 (MainThread): On master: Close
2021-12-21 02:43:04.740971 (MainThread): 09:43:04 | Concurrency: 1 threads (target='dev')
2021-12-21 02:43:04.741484 (MainThread): 09:43:04 | 
2021-12-21 02:43:04.747900 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:43:04.749097 (Thread-1): 09:43:04 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 02:43:04.749933 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:04.750416 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:43:04.757102 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 02:43:04.760860 (Thread-1): finished collecting timing info
2021-12-21 02:43:04.818754 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 02:43:04.819380 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:04.819534 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 02:43:04.819680 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:43:05.138933 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:43:05.139191 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:05.139319 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 02:43:05.569690 (Thread-1): SQL status: SELECT 62746 in 0.43 seconds
2021-12-21 02:43:05.577874 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:05.578120 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 02:43:05.619109 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:43:05.624546 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:05.624833 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 02:43:05.669238 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:43:05.688573 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 02:43:05.688848 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:05.689008 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 02:43:05.730877 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:43:05.742515 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:43:05.742811 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 02:43:05.799090 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-12-21 02:43:05.802158 (Thread-1): finished collecting timing info
2021-12-21 02:43:05.802649 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 02:43:05.803671 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f817c43-bda1-443c-b523-45ab41e5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eab36d0>]}
2021-12-21 02:43:05.804325 (Thread-1): 09:43:05 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62746 in 1.05s]
2021-12-21 02:43:05.804644 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 02:43:05.804977 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:43:05.805410 (Thread-1): 09:43:05 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 02:43:05.806066 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:05.806635 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:43:05.810335 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:43:05.815016 (Thread-1): finished collecting timing info
2021-12-21 02:43:05.818295 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 02:43:05.821068 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:05.821310 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 02:43:05.821687 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:43:06.149031 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 02:43:06.149428 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:06.149673 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 02:43:06.239098 (Thread-1): SQL status: SELECT 2816 in 0.09 seconds
2021-12-21 02:43:06.244419 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:06.244729 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 02:43:06.279080 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 02:43:06.284441 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:06.284731 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 02:43:06.319208 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 02:43:06.323448 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:43:06.323770 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:06.323981 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 02:43:06.368885 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:43:06.371131 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:43:06.371347 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 02:43:06.419045 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 02:43:06.422184 (Thread-1): finished collecting timing info
2021-12-21 02:43:06.422622 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 02:43:06.423543 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f817c43-bda1-443c-b523-45ab41e5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb32b0>]}
2021-12-21 02:43:06.424161 (Thread-1): 09:43:06 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.62s]
2021-12-21 02:43:06.424468 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 02:43:06.424787 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:43:06.425217 (Thread-1): 09:43:06 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 02:43:06.425821 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:06.426109 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:43:06.429046 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:43:06.431840 (Thread-1): finished collecting timing info
2021-12-21 02:43:06.437514 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 02:43:06.439773 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:06.440323 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 02:43:06.440576 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:43:06.758950 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:43:06.759485 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:06.759804 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 02:43:19.018613 (Thread-1): SQL status: SELECT 388590 in 12.26 seconds
2021-12-21 02:43:19.021991 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:19.022203 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 02:43:19.058681 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 02:43:19.064024 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:19.064333 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 02:43:19.098419 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 02:43:19.100664 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:43:19.100919 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:19.101114 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 02:43:19.268547 (Thread-1): SQL status: COMMIT in 0.17 seconds
2021-12-21 02:43:19.272076 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:43:19.272357 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 02:43:19.349500 (Thread-1): SQL status: DROP TABLE in 0.08 seconds
2021-12-21 02:43:19.350890 (Thread-1): finished collecting timing info
2021-12-21 02:43:19.351162 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 02:43:19.352004 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f817c43-bda1-443c-b523-45ab41e5533d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebb32b0>]}
2021-12-21 02:43:19.352471 (Thread-1): 09:43:19 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388590 in 12.93s]
2021-12-21 02:43:19.352733 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 02:43:19.353974 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:43:19.354192 (MainThread): Using postgres connection "master".
2021-12-21 02:43:19.354314 (MainThread): On master: BEGIN
2021-12-21 02:43:19.354422 (MainThread): Opening a new connection, currently in state closed
2021-12-21 02:43:19.678060 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:43:19.678342 (MainThread): On master: COMMIT
2021-12-21 02:43:19.678463 (MainThread): Using postgres connection "master".
2021-12-21 02:43:19.678570 (MainThread): On master: COMMIT
2021-12-21 02:43:19.718129 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 02:43:19.718439 (MainThread): On master: Close
2021-12-21 02:43:19.719168 (MainThread): 09:43:19 | 
2021-12-21 02:43:19.719752 (MainThread): 09:43:19 | Finished running 3 table models in 16.39s.
2021-12-21 02:43:19.720017 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:43:19.720197 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 02:43:19.733854 (MainThread): 
2021-12-21 02:43:19.734315 (MainThread): Completed successfully
2021-12-21 02:43:19.734702 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 02:43:19.735379 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecad8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecad1c0>]}
2021-12-21 02:43:19.736296 (MainThread): Flushing usage events
2021-12-21 02:44:41.336619 (MainThread): Running with dbt=0.21.0
2021-12-21 02:44:41.436303 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-21 02:44:41.437649 (MainThread): Tracking: tracking
2021-12-21 02:44:41.474141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec9490>]}
2021-12-21 02:44:41.487261 (MainThread): Partial parsing not enabled
2021-12-21 02:44:41.510608 (MainThread): Parsing macros/catalog.sql
2021-12-21 02:44:41.516584 (MainThread): Parsing macros/relations.sql
2021-12-21 02:44:41.518615 (MainThread): Parsing macros/adapters.sql
2021-12-21 02:44:41.548201 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 02:44:41.550204 (MainThread): Parsing macros/core.sql
2021-12-21 02:44:41.554580 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 02:44:41.562268 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 02:44:41.573367 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 02:44:41.575565 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 02:44:41.595504 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 02:44:41.631881 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 02:44:41.657740 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 02:44:41.659778 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 02:44:41.671423 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 02:44:41.694054 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 02:44:41.709862 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 02:44:41.718736 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 02:44:41.727376 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 02:44:41.731871 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 02:44:41.733565 (MainThread): Parsing macros/etc/query.sql
2021-12-21 02:44:41.734681 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 02:44:41.736540 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 02:44:41.746259 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 02:44:41.748319 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 02:44:41.751863 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 02:44:41.754102 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 02:44:41.815580 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 02:44:41.817566 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 02:44:41.818853 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 02:44:41.820274 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 02:44:42.054653 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 02:44:42.068379 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 02:44:42.098824 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 02:44:42.130837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.132756 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.135059 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.138508 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.140464 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.142271 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 02:44:42.152897 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 02:44:42.162127 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '948c413d-8c66-4ec9-9fb2-1b97dd50477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd6460>]}
2021-12-21 02:44:42.169749 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 02:44:42.170305 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '948c413d-8c66-4ec9-9fb2-1b97dd50477e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd6e80>]}
2021-12-21 02:44:42.170574 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 02:44:42.172544 (MainThread): 
2021-12-21 02:44:42.173028 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:44:42.174525 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:44:42.186695 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:44:42.186889 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 02:44:42.187008 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-21 02:44:42.785820 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.60 seconds
2021-12-21 02:44:42.786556 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 02:44:42.786931 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 02:44:42.826064 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 02:44:42.829761 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 02:44:42.867502 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 02:44:42.875329 (MainThread): Using postgres connection "master".
2021-12-21 02:44:42.875680 (MainThread): On master: BEGIN
2021-12-21 02:44:42.875904 (MainThread): Opening a new connection, currently in state init
2021-12-21 02:44:43.185608 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 02:44:43.186163 (MainThread): Using postgres connection "master".
2021-12-21 02:44:43.186530 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 02:44:43.226597 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 02:44:43.230456 (MainThread): On master: ROLLBACK
2021-12-21 02:44:43.275297 (MainThread): On master: Close
2021-12-21 02:44:43.276864 (MainThread): 09:44:43 | Concurrency: 1 threads (target='dev')
2021-12-21 02:44:43.277384 (MainThread): 09:44:43 | 
2021-12-21 02:44:43.282867 (Thread-1): Began running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:44:43.283340 (Thread-1): 09:44:43 | 1 of 6 START test not_null_clean_odoo_purchase_order_id.............. [RUN]
2021-12-21 02:44:43.283982 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:44:43.284402 (Thread-1): Compiling test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:44:43.303927 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 02:44:43.307040 (Thread-1): finished collecting timing info
2021-12-21 02:44:43.335205 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 02:44:43.335845 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:44:43.336009 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: BEGIN
2021-12-21 02:44:43.336140 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:43.655479 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:44:43.656071 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 02:44:43.656453 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:44:43.726203 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2021-12-21 02:44:43.730229 (Thread-1): finished collecting timing info
2021-12-21 02:44:43.730609 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: ROLLBACK
2021-12-21 02:44:43.775010 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: Close
2021-12-21 02:44:43.775904 (Thread-1): 09:44:43 | 1 of 6 PASS not_null_clean_odoo_purchase_order_id.................... [PASS in 0.49s]
2021-12-21 02:44:43.776163 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 02:44:43.776395 (Thread-1): Began running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:44:43.776607 (Thread-1): 09:44:43 | 2 of 6 START test not_null_clean_partner_company_phones_id........... [RUN]
2021-12-21 02:44:43.777107 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:44:43.777314 (Thread-1): Compiling test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:44:43.782441 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 02:44:43.784883 (Thread-1): finished collecting timing info
2021-12-21 02:44:43.788426 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 02:44:43.789573 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:44:43.789974 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: BEGIN
2021-12-21 02:44:43.790178 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:44.095134 (Thread-1): SQL status: BEGIN in 0.30 seconds
2021-12-21 02:44:44.095575 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 02:44:44.095812 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:44:44.138835 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 02:44:44.143235 (Thread-1): finished collecting timing info
2021-12-21 02:44:44.143747 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: ROLLBACK
2021-12-21 02:44:44.185169 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: Close
2021-12-21 02:44:44.186413 (Thread-1): 09:44:44 | 2 of 6 PASS not_null_clean_partner_company_phones_id................. [PASS in 0.41s]
2021-12-21 02:44:44.186796 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 02:44:44.187161 (Thread-1): Began running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:44:44.187438 (Thread-1): 09:44:44 | 3 of 6 START test not_null_clean_transport_delivery_orders_id........ [RUN]
2021-12-21 02:44:44.187921 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:44:44.188171 (Thread-1): Compiling test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:44:44.197154 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 02:44:44.198258 (Thread-1): finished collecting timing info
2021-12-21 02:44:44.200536 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 02:44:44.201134 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:44:44.201359 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: BEGIN
2021-12-21 02:44:44.201519 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:44.525622 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:44:44.527535 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 02:44:44.527957 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is null



      
    ) dbt_internal_test
2021-12-21 02:44:45.015504 (Thread-1): SQL status: SELECT 1 in 0.49 seconds
2021-12-21 02:44:45.018047 (Thread-1): finished collecting timing info
2021-12-21 02:44:45.018393 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: ROLLBACK
2021-12-21 02:44:45.056812 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: Close
2021-12-21 02:44:45.057480 (Thread-1): 09:44:45 | 3 of 6 PASS not_null_clean_transport_delivery_orders_id.............. [PASS in 0.87s]
2021-12-21 02:44:45.057744 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 02:44:45.058020 (Thread-1): Began running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:44:45.058307 (Thread-1): 09:44:45 | 4 of 6 START test unique_clean_odoo_purchase_order_id................ [RUN]
2021-12-21 02:44:45.058731 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:44:45.058958 (Thread-1): Compiling test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:44:45.067325 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 02:44:45.068526 (Thread-1): finished collecting timing info
2021-12-21 02:44:45.080384 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 02:44:45.082433 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:44:45.082893 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: BEGIN
2021-12-21 02:44:45.083283 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:45.435138 (Thread-1): SQL status: BEGIN in 0.35 seconds
2021-12-21 02:44:45.435838 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 02:44:45.436376 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:44:45.584935 (Thread-1): SQL status: SELECT 1 in 0.15 seconds
2021-12-21 02:44:45.586920 (Thread-1): finished collecting timing info
2021-12-21 02:44:45.587193 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: ROLLBACK
2021-12-21 02:44:45.625345 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: Close
2021-12-21 02:44:45.627263 (Thread-1): 09:44:45 | 4 of 6 PASS unique_clean_odoo_purchase_order_id...................... [PASS in 0.57s]
2021-12-21 02:44:45.627811 (Thread-1): Finished running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 02:44:45.628316 (Thread-1): Began running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:44:45.628726 (Thread-1): 09:44:45 | 5 of 6 START test unique_clean_partner_company_phones_id............. [RUN]
2021-12-21 02:44:45.629309 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:44:45.629602 (Thread-1): Compiling test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:44:45.640496 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 02:44:45.642483 (Thread-1): finished collecting timing info
2021-12-21 02:44:45.647524 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 02:44:45.648379 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:44:45.648584 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: BEGIN
2021-12-21 02:44:45.648750 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:45.974983 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 02:44:45.975413 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 02:44:45.975731 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:44:46.015388 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 02:44:46.019283 (Thread-1): finished collecting timing info
2021-12-21 02:44:46.019676 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: ROLLBACK
2021-12-21 02:44:46.054828 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: Close
2021-12-21 02:44:46.055805 (Thread-1): 09:44:46 | 5 of 6 PASS unique_clean_partner_company_phones_id................... [PASS in 0.43s]
2021-12-21 02:44:46.056095 (Thread-1): Finished running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 02:44:46.056348 (Thread-1): Began running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:44:46.056749 (Thread-1): 09:44:46 | 6 of 6 START test unique_clean_transport_delivery_orders_id.......... [RUN]
2021-12-21 02:44:46.057247 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:44:46.057474 (Thread-1): Compiling test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:44:46.062457 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 02:44:46.066881 (Thread-1): finished collecting timing info
2021-12-21 02:44:46.070833 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 02:44:46.072241 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:44:46.073035 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: BEGIN
2021-12-21 02:44:46.073363 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 02:44:46.395214 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 02:44:46.395879 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 02:44:46.396246 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 02:44:46.877450 (Thread-1): SQL status: SELECT 1 in 0.48 seconds
2021-12-21 02:44:46.880150 (Thread-1): finished collecting timing info
2021-12-21 02:44:46.880555 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: ROLLBACK
2021-12-21 02:44:46.917855 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: Close
2021-12-21 02:44:46.919394 (Thread-1): 09:44:46 | 6 of 6 PASS unique_clean_transport_delivery_orders_id................ [PASS in 0.86s]
2021-12-21 02:44:46.919908 (Thread-1): Finished running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 02:44:46.923076 (MainThread): Acquiring new postgres connection "master".
2021-12-21 02:44:46.924128 (MainThread): 09:44:46 | 
2021-12-21 02:44:46.924626 (MainThread): 09:44:46 | Finished running 6 tests in 4.75s.
2021-12-21 02:44:46.924915 (MainThread): Connection 'master' was properly closed.
2021-12-21 02:44:46.925144 (MainThread): Connection 'test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924' was properly closed.
2021-12-21 02:44:46.934723 (MainThread): 
2021-12-21 02:44:46.935065 (MainThread): Completed successfully
2021-12-21 02:44:46.935526 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-21 02:44:46.935930 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efa2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109efa2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e92b80>]}
2021-12-21 02:44:46.936421 (MainThread): Flushing usage events
2021-12-21 03:10:12.619324 (MainThread): Running with dbt=0.21.0
2021-12-21 03:10:12.715969 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 03:10:12.717143 (MainThread): Tracking: tracking
2021-12-21 03:10:12.731149 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a823e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a83fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a853490>]}
2021-12-21 03:10:12.743750 (MainThread): Partial parsing not enabled
2021-12-21 03:10:12.763141 (MainThread): Parsing macros/catalog.sql
2021-12-21 03:10:12.768488 (MainThread): Parsing macros/relations.sql
2021-12-21 03:10:12.770013 (MainThread): Parsing macros/adapters.sql
2021-12-21 03:10:12.794904 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 03:10:12.796749 (MainThread): Parsing macros/core.sql
2021-12-21 03:10:12.800857 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 03:10:12.808225 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 03:10:12.819112 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 03:10:12.820979 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 03:10:12.840603 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 03:10:12.878749 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 03:10:12.904374 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 03:10:12.906320 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 03:10:12.917797 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 03:10:12.940854 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 03:10:12.957183 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 03:10:12.966598 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 03:10:12.974932 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 03:10:12.979337 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 03:10:12.981113 (MainThread): Parsing macros/etc/query.sql
2021-12-21 03:10:12.982185 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 03:10:12.983803 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 03:10:12.993654 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 03:10:12.995688 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 03:10:12.998310 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 03:10:13.000168 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 03:10:13.062379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 03:10:13.064607 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 03:10:13.066054 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 03:10:13.067529 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 03:10:13.304937 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:13.318423 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:13.348557 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:13.380866 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.382774 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.384793 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.388033 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.390110 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.391947 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 03:10:13.404057 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 03:10:13.410439 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14bbf6da-bd55-4641-9101-f90799e1e6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a961b80>]}
2021-12-21 03:10:13.416854 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 03:10:13.417551 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14bbf6da-bd55-4641-9101-f90799e1e6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9613a0>]}
2021-12-21 03:10:13.417886 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 03:10:13.419337 (MainThread): 
2021-12-21 03:10:13.420003 (MainThread): Acquiring new postgres connection "master".
2021-12-21 03:10:13.420944 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 03:10:13.434898 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 03:10:13.435116 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 03:10:13.435240 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 03:10:14.182563 (ThreadPoolExecutor-0_0): SQL status: SELECT 190 in 0.75 seconds
2021-12-21 03:10:14.186161 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 03:10:14.187927 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 03:10:14.194514 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 03:10:14.194764 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 03:10:14.194918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 03:10:14.589775 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.39 seconds
2021-12-21 03:10:14.590391 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 03:10:14.590749 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 03:10:14.634126 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 03:10:14.637778 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 03:10:14.672855 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 03:10:14.682851 (MainThread): Using postgres connection "master".
2021-12-21 03:10:14.683203 (MainThread): On master: BEGIN
2021-12-21 03:10:14.683454 (MainThread): Opening a new connection, currently in state init
2021-12-21 03:10:14.992909 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 03:10:14.993418 (MainThread): Using postgres connection "master".
2021-12-21 03:10:14.993750 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 03:10:15.044340 (MainThread): SQL status: SELECT 0 in 0.05 seconds
2021-12-21 03:10:15.047711 (MainThread): On master: ROLLBACK
2021-12-21 03:10:15.083010 (MainThread): Using postgres connection "master".
2021-12-21 03:10:15.083559 (MainThread): On master: BEGIN
2021-12-21 03:10:15.163255 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 03:10:15.163578 (MainThread): On master: COMMIT
2021-12-21 03:10:15.163746 (MainThread): Using postgres connection "master".
2021-12-21 03:10:15.163872 (MainThread): On master: COMMIT
2021-12-21 03:10:15.202449 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 03:10:15.202715 (MainThread): On master: Close
2021-12-21 03:10:15.203300 (MainThread): 10:10:15 | Concurrency: 1 threads (target='dev')
2021-12-21 03:10:15.203541 (MainThread): 10:10:15 | 
2021-12-21 03:10:15.206516 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 03:10:15.206894 (Thread-1): 10:10:15 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 03:10:15.207265 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:15.207446 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 03:10:15.209429 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 03:10:15.210809 (Thread-1): finished collecting timing info
2021-12-21 03:10:15.258566 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 03:10:15.259182 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:15.259332 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 03:10:15.259469 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 03:10:15.584419 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 03:10:15.585224 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:15.585585 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 03:10:15.982959 (Thread-1): SQL status: SELECT 62762 in 0.40 seconds
2021-12-21 03:10:15.996260 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:15.996587 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 03:10:16.032931 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 03:10:16.037710 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:16.038031 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 03:10:16.072786 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 03:10:16.093109 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 03:10:16.093382 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:16.093549 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 03:10:16.132610 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 03:10:16.142527 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 03:10:16.142830 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 03:10:16.192332 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 03:10:16.194142 (Thread-1): finished collecting timing info
2021-12-21 03:10:16.194571 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 03:10:16.195683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14bbf6da-bd55-4641-9101-f90799e1e6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8c7d00>]}
2021-12-21 03:10:16.196223 (Thread-1): 10:10:16 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62762 in 0.99s]
2021-12-21 03:10:16.196676 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 03:10:16.197061 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 03:10:16.197537 (Thread-1): 10:10:16 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 03:10:16.198063 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.198362 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 03:10:16.200583 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 03:10:16.202016 (Thread-1): finished collecting timing info
2021-12-21 03:10:16.205924 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 03:10:16.206768 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.207726 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 03:10:16.210984 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 03:10:16.532784 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 03:10:16.533313 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.533660 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 03:10:16.643221 (Thread-1): SQL status: SELECT 2816 in 0.11 seconds
2021-12-21 03:10:16.648820 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.649127 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 03:10:16.692632 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 03:10:16.698084 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.698409 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 03:10:16.742856 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 03:10:16.746606 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 03:10:16.746992 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.747229 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 03:10:16.792647 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 03:10:16.796824 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 03:10:16.797137 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 03:10:16.842862 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 03:10:16.846074 (Thread-1): finished collecting timing info
2021-12-21 03:10:16.846597 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 03:10:16.847573 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14bbf6da-bd55-4641-9101-f90799e1e6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a800670>]}
2021-12-21 03:10:16.848222 (Thread-1): 10:10:16 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.65s]
2021-12-21 03:10:16.848538 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 03:10:16.848861 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 03:10:16.849292 (Thread-1): 10:10:16 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 03:10:16.850084 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:16.850385 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 03:10:16.852879 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 03:10:16.854400 (Thread-1): finished collecting timing info
2021-12-21 03:10:16.858035 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 03:10:16.858831 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:16.859055 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 03:10:16.859237 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 03:10:17.172857 (Thread-1): SQL status: BEGIN in 0.31 seconds
2021-12-21 03:10:17.173504 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:17.173860 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 03:10:38.152179 (Thread-1): SQL status: SELECT 388613 in 20.98 seconds
2021-12-21 03:10:38.158076 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:38.158479 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 03:10:38.202087 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 03:10:38.207592 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:38.207927 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 03:10:38.252523 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 03:10:38.256002 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 03:10:38.256304 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:38.256542 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 03:10:38.432035 (Thread-1): SQL status: COMMIT in 0.18 seconds
2021-12-21 03:10:38.436127 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 03:10:38.436534 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 03:10:38.761831 (Thread-1): SQL status: DROP TABLE in 0.32 seconds
2021-12-21 03:10:38.767650 (Thread-1): finished collecting timing info
2021-12-21 03:10:38.768047 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 03:10:38.768993 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14bbf6da-bd55-4641-9101-f90799e1e6ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab5df0>]}
2021-12-21 03:10:38.769700 (Thread-1): 10:10:38 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388613 in 21.92s]
2021-12-21 03:10:38.770030 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 03:10:38.772414 (MainThread): Acquiring new postgres connection "master".
2021-12-21 03:10:38.772748 (MainThread): Using postgres connection "master".
2021-12-21 03:10:38.772958 (MainThread): On master: BEGIN
2021-12-21 03:10:38.773155 (MainThread): Opening a new connection, currently in state closed
2021-12-21 03:10:39.172296 (MainThread): SQL status: BEGIN in 0.40 seconds
2021-12-21 03:10:39.174287 (MainThread): On master: COMMIT
2021-12-21 03:10:39.174849 (MainThread): Using postgres connection "master".
2021-12-21 03:10:39.175209 (MainThread): On master: COMMIT
2021-12-21 03:10:39.212091 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 03:10:39.212711 (MainThread): On master: Close
2021-12-21 03:10:39.213968 (MainThread): 10:10:39 | 
2021-12-21 03:10:39.214611 (MainThread): 10:10:39 | Finished running 3 table models in 25.79s.
2021-12-21 03:10:39.215039 (MainThread): Connection 'master' was properly closed.
2021-12-21 03:10:39.215371 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 03:10:39.224685 (MainThread): 
2021-12-21 03:10:39.225028 (MainThread): Completed successfully
2021-12-21 03:10:39.225291 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 03:10:39.225643 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e46d0>]}
2021-12-21 03:10:39.226019 (MainThread): Flushing usage events
2021-12-21 04:22:53.270480 (MainThread): Running with dbt=0.21.0
2021-12-21 04:22:53.374313 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 04:22:53.375646 (MainThread): Tracking: tracking
2021-12-21 04:22:53.391541 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef409d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef6d430>]}
2021-12-21 04:22:53.404550 (MainThread): Partial parsing not enabled
2021-12-21 04:22:53.423767 (MainThread): Parsing macros/catalog.sql
2021-12-21 04:22:53.429200 (MainThread): Parsing macros/relations.sql
2021-12-21 04:22:53.430774 (MainThread): Parsing macros/adapters.sql
2021-12-21 04:22:53.456637 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 04:22:53.458658 (MainThread): Parsing macros/core.sql
2021-12-21 04:22:53.462720 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 04:22:53.470562 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 04:22:53.481487 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 04:22:53.483605 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 04:22:53.504286 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 04:22:53.541304 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 04:22:53.567590 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 04:22:53.569683 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 04:22:53.581664 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 04:22:53.605073 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 04:22:53.620720 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 04:22:53.629781 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 04:22:53.638393 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 04:22:53.642780 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 04:22:53.644461 (MainThread): Parsing macros/etc/query.sql
2021-12-21 04:22:53.645552 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 04:22:53.647195 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 04:22:53.657257 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 04:22:53.659304 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 04:22:53.662015 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 04:22:53.663737 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 04:22:53.727282 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 04:22:53.729283 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 04:22:53.730933 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 04:22:53.732553 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 04:22:53.942715 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:53.957096 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:22:53.996559 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:54.031391 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.033938 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.036330 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.039672 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.041543 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.043324 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 04:22:54.054596 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 04:22:54.059739 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4d5cb30-b908-4dc9-a257-8643b7653aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07c5e0>]}
2021-12-21 04:22:54.065607 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 04:22:54.066214 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4d5cb30-b908-4dc9-a257-8643b7653aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07c760>]}
2021-12-21 04:22:54.066479 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 04:22:54.068148 (MainThread): 
2021-12-21 04:22:54.068525 (MainThread): Acquiring new postgres connection "master".
2021-12-21 04:22:54.069346 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 04:22:54.079507 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 04:22:54.079834 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 04:22:54.080079 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 04:22:54.843132 (ThreadPoolExecutor-0_0): SQL status: SELECT 190 in 0.76 seconds
2021-12-21 04:22:54.849236 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 04:22:54.851873 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 04:22:54.861689 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 04:22:54.861951 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 04:22:54.862117 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 04:22:55.171347 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 04:22:55.171961 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 04:22:55.172370 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 04:22:55.211376 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 04:22:55.214977 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 04:22:55.251510 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 04:22:55.262033 (MainThread): Using postgres connection "master".
2021-12-21 04:22:55.262337 (MainThread): On master: BEGIN
2021-12-21 04:22:55.262550 (MainThread): Opening a new connection, currently in state init
2021-12-21 04:22:55.591846 (MainThread): SQL status: BEGIN in 0.33 seconds
2021-12-21 04:22:55.592269 (MainThread): Using postgres connection "master".
2021-12-21 04:22:55.592509 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 04:22:55.642224 (MainThread): SQL status: SELECT 0 in 0.05 seconds
2021-12-21 04:22:55.644912 (MainThread): On master: ROLLBACK
2021-12-21 04:22:55.671705 (MainThread): Using postgres connection "master".
2021-12-21 04:22:55.672216 (MainThread): On master: BEGIN
2021-12-21 04:22:55.751750 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 04:22:55.752770 (MainThread): On master: COMMIT
2021-12-21 04:22:55.753183 (MainThread): Using postgres connection "master".
2021-12-21 04:22:55.753624 (MainThread): On master: COMMIT
2021-12-21 04:22:55.791771 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 04:22:55.792464 (MainThread): On master: Close
2021-12-21 04:22:55.793639 (MainThread): 11:22:55 | Concurrency: 1 threads (target='dev')
2021-12-21 04:22:55.794453 (MainThread): 11:22:55 | 
2021-12-21 04:22:55.800652 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 04:22:55.801726 (Thread-1): 11:22:55 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 04:22:55.802703 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:55.803170 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 04:22:55.807696 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 04:22:55.811617 (Thread-1): finished collecting timing info
2021-12-21 04:22:55.862861 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 04:22:55.863492 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:55.863646 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 04:22:55.863778 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 04:22:56.183056 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 04:22:56.183732 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:56.184370 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 04:22:56.551859 (Thread-1): SQL status: SELECT 62796 in 0.37 seconds
2021-12-21 04:22:56.565403 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:56.565730 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 04:22:56.595084 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 04:22:56.600292 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:56.600616 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 04:22:56.641470 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 04:22:56.662396 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 04:22:56.662653 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:56.662816 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 04:22:56.696050 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-12-21 04:22:56.706415 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 04:22:56.706744 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 04:22:56.751413 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 04:22:56.754294 (Thread-1): finished collecting timing info
2021-12-21 04:22:56.754742 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 04:22:56.755942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d5cb30-b908-4dc9-a257-8643b7653aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0fd040>]}
2021-12-21 04:22:56.756649 (Thread-1): 11:22:56 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62796 in 0.95s]
2021-12-21 04:22:56.757011 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 04:22:56.757322 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 04:22:56.757900 (Thread-1): 11:22:56 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 04:22:56.758560 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:56.758841 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 04:22:56.761489 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 04:22:56.762962 (Thread-1): finished collecting timing info
2021-12-21 04:22:56.766415 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 04:22:56.767079 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:56.767262 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 04:22:56.767584 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 04:22:57.071079 (Thread-1): SQL status: BEGIN in 0.30 seconds
2021-12-21 04:22:57.071325 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:57.071456 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 04:22:57.171233 (Thread-1): SQL status: SELECT 2816 in 0.10 seconds
2021-12-21 04:22:57.176530 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:57.176887 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 04:22:57.211127 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 04:22:57.214961 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:57.215269 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 04:22:57.251727 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 04:22:57.254500 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 04:22:57.255094 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:57.255571 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 04:22:57.291349 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 04:22:57.295847 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 04:22:57.296211 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 04:22:57.343175 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 04:22:57.346042 (Thread-1): finished collecting timing info
2021-12-21 04:22:57.346515 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 04:22:57.347483 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d5cb30-b908-4dc9-a257-8643b7653aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f012f70>]}
2021-12-21 04:22:57.348039 (Thread-1): 11:22:57 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.59s]
2021-12-21 04:22:57.348313 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 04:22:57.348592 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 04:22:57.348965 (Thread-1): 11:22:57 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 04:22:57.349433 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:22:57.349677 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 04:22:57.351887 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 04:22:57.353181 (Thread-1): finished collecting timing info
2021-12-21 04:22:57.357063 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 04:22:57.357720 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:22:57.357900 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 04:22:57.358060 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 04:22:57.671423 (Thread-1): SQL status: BEGIN in 0.31 seconds
2021-12-21 04:22:57.672068 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:22:57.672508 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 04:23:06.434333 (Thread-1): SQL status: SELECT 388750 in 8.76 seconds
2021-12-21 04:23:06.437916 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:23:06.438152 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 04:23:06.541447 (Thread-1): SQL status: ALTER TABLE in 0.10 seconds
2021-12-21 04:23:06.547329 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:23:06.547674 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 04:23:06.574875 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 04:23:06.579257 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 04:23:06.579568 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:23:06.579788 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 04:23:06.615221 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 04:23:06.617202 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 04:23:06.617391 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 04:23:06.675953 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-12-21 04:23:06.681838 (Thread-1): finished collecting timing info
2021-12-21 04:23:06.682257 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 04:23:06.683207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d5cb30-b908-4dc9-a257-8643b7653aef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cfd90>]}
2021-12-21 04:23:06.684011 (Thread-1): 11:23:06 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388750 in 9.33s]
2021-12-21 04:23:06.684549 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 04:23:06.686214 (MainThread): Acquiring new postgres connection "master".
2021-12-21 04:23:06.686517 (MainThread): Using postgres connection "master".
2021-12-21 04:23:06.686719 (MainThread): On master: BEGIN
2021-12-21 04:23:06.686915 (MainThread): Opening a new connection, currently in state closed
2021-12-21 04:23:07.011088 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 04:23:07.011642 (MainThread): On master: COMMIT
2021-12-21 04:23:07.011998 (MainThread): Using postgres connection "master".
2021-12-21 04:23:07.012328 (MainThread): On master: COMMIT
2021-12-21 04:23:07.051219 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 04:23:07.051851 (MainThread): On master: Close
2021-12-21 04:23:07.053432 (MainThread): 11:23:07 | 
2021-12-21 04:23:07.053925 (MainThread): 11:23:07 | Finished running 3 table models in 12.98s.
2021-12-21 04:23:07.054492 (MainThread): Connection 'master' was properly closed.
2021-12-21 04:23:07.054841 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 04:23:07.065134 (MainThread): 
2021-12-21 04:23:07.065489 (MainThread): Completed successfully
2021-12-21 04:23:07.065752 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 04:23:07.066102 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0e5280>]}
2021-12-21 04:23:07.066481 (MainThread): Flushing usage events
2021-12-21 07:13:30.424287 (MainThread): Running with dbt=0.21.0
2021-12-21 07:13:30.527247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:13:30.528955 (MainThread): Tracking: tracking
2021-12-21 07:13:30.550563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f0a550>]}
2021-12-21 07:13:30.564602 (MainThread): Partial parsing not enabled
2021-12-21 07:13:30.584392 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:13:30.589300 (MainThread): Parsing macros/relations.sql
2021-12-21 07:13:30.591270 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:13:30.618130 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:13:30.619957 (MainThread): Parsing macros/core.sql
2021-12-21 07:13:30.623903 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:13:30.631655 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:13:30.643178 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:13:30.645090 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:13:30.665471 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:13:30.702682 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:13:30.729310 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:13:30.731367 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:13:30.743008 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:13:30.765111 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:13:30.780702 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:13:30.794863 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:13:30.804133 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:13:30.812561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:13:30.815181 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:13:30.816545 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:13:30.819873 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:13:30.839221 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:13:30.843503 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:13:30.847860 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:13:30.849894 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:13:30.916217 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:13:30.918062 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:13:30.919295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:13:30.920760 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:13:31.153562 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:31.166793 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:31.201895 (MainThread): 1699: statically parsed clean_odoo/clean_odoo_purchase_order.sql
2021-12-21 07:13:31.202146 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:31.204529 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f0250>]}
2021-12-21 07:13:31.233945 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.236008 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.237812 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.240732 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.242519 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.244516 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:13:31.255407 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:13:31.261153 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113019f40>]}
2021-12-21 07:13:31.267007 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:13:31.267686 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113019d60>]}
2021-12-21 07:13:31.268192 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:13:31.273449 (MainThread): 
2021-12-21 07:13:31.274355 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:13:31.276274 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 07:13:31.289740 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 07:13:31.290216 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 07:13:31.290389 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 07:13:31.974054 (ThreadPoolExecutor-0_0): SQL status: SELECT 190 in 0.68 seconds
2021-12-21 07:13:31.979771 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 07:13:31.982341 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:13:31.992319 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:13:31.992557 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 07:13:31.992718 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 07:13:32.314208 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:13:32.315386 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:13:32.316241 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 07:13:32.363862 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.05 seconds
2021-12-21 07:13:32.367303 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 07:13:32.403734 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 07:13:32.413511 (MainThread): Using postgres connection "master".
2021-12-21 07:13:32.413843 (MainThread): On master: BEGIN
2021-12-21 07:13:32.414084 (MainThread): Opening a new connection, currently in state init
2021-12-21 07:13:32.733648 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:13:32.734386 (MainThread): Using postgres connection "master".
2021-12-21 07:13:32.734979 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 07:13:32.825179 (MainThread): SQL status: SELECT 0 in 0.09 seconds
2021-12-21 07:13:32.829633 (MainThread): On master: ROLLBACK
2021-12-21 07:13:32.873537 (MainThread): Using postgres connection "master".
2021-12-21 07:13:32.873895 (MainThread): On master: BEGIN
2021-12-21 07:13:32.956477 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 07:13:32.957076 (MainThread): On master: COMMIT
2021-12-21 07:13:32.957498 (MainThread): Using postgres connection "master".
2021-12-21 07:13:32.957823 (MainThread): On master: COMMIT
2021-12-21 07:13:32.993561 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:13:32.994180 (MainThread): On master: Close
2021-12-21 07:13:32.995352 (MainThread): 14:13:32 | Concurrency: 1 threads (target='dev')
2021-12-21 07:13:32.995818 (MainThread): 14:13:32 | 
2021-12-21 07:13:33.001059 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:13:33.001865 (Thread-1): 14:13:33 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 07:13:33.003551 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:33.004641 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:13:33.009602 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:13:33.011767 (Thread-1): finished collecting timing info
2021-12-21 07:13:33.060930 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:13:33.061547 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:33.061699 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 07:13:33.061831 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:13:33.393642 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 07:13:33.394217 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:33.394575 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 07:13:39.820306 (Thread-1): SQL status: SELECT 62828 in 6.43 seconds
2021-12-21 07:13:39.833005 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:39.833291 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 07:13:41.458855 (Thread-1): SQL status: ALTER TABLE in 1.63 seconds
2021-12-21 07:13:41.464635 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:41.464963 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 07:13:43.503375 (Thread-1): SQL status: ALTER TABLE in 2.04 seconds
2021-12-21 07:13:43.523368 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:13:43.523625 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:43.523780 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:13:43.613245 (Thread-1): SQL status: COMMIT in 0.09 seconds
2021-12-21 07:13:43.623928 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:13:43.624208 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 07:13:44.221644 (Thread-1): SQL status: DROP TABLE in 0.60 seconds
2021-12-21 07:13:44.224786 (Thread-1): finished collecting timing info
2021-12-21 07:13:44.225277 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 07:13:44.226476 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eb7ca0>]}
2021-12-21 07:13:44.227135 (Thread-1): 14:13:44 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62828 in 11.22s]
2021-12-21 07:13:44.227456 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:13:44.227788 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:13:44.228260 (Thread-1): 14:13:44 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 07:13:44.229043 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:44.229348 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:13:44.231960 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:13:44.232748 (Thread-1): finished collecting timing info
2021-12-21 07:13:44.235899 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:13:44.236741 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:44.236978 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 07:13:44.237388 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:13:44.553222 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:13:44.553784 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:44.554146 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 07:13:45.144351 (Thread-1): SQL status: SELECT 2816 in 0.59 seconds
2021-12-21 07:13:45.146943 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:45.147137 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 07:13:45.601633 (Thread-1): SQL status: ALTER TABLE in 0.45 seconds
2021-12-21 07:13:45.605262 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:45.605485 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 07:13:45.631892 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 07:13:45.633635 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:13:45.633829 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:45.633979 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:13:45.775432 (Thread-1): SQL status: COMMIT in 0.14 seconds
2021-12-21 07:13:45.779750 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:13:45.780086 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 07:13:45.993166 (Thread-1): SQL status: DROP TABLE in 0.21 seconds
2021-12-21 07:13:45.996377 (Thread-1): finished collecting timing info
2021-12-21 07:13:45.996872 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 07:13:45.997922 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130167c0>]}
2021-12-21 07:13:45.998542 (Thread-1): 14:13:45 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 1.77s]
2021-12-21 07:13:45.998866 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:13:45.999193 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:13:45.999633 (Thread-1): 14:13:45 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 07:13:46.000388 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:46.000698 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:13:46.003105 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:13:46.003901 (Thread-1): finished collecting timing info
2021-12-21 07:13:46.007286 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:13:46.008118 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:46.008383 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 07:13:46.008598 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:13:46.423201 (Thread-1): SQL status: BEGIN in 0.41 seconds
2021-12-21 07:13:46.423768 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:46.424138 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 07:13:57.662221 (Thread-1): SQL status: SELECT 388963 in 11.24 seconds
2021-12-21 07:13:57.667888 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:57.668194 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 07:13:57.712563 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:13:57.718089 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:57.718390 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 07:13:57.763199 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:13:57.766659 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:13:57.766932 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:57.767157 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:13:57.832558 (Thread-1): SQL status: COMMIT in 0.07 seconds
2021-12-21 07:13:57.842240 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:13:57.842576 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 07:13:57.913082 (Thread-1): SQL status: DROP TABLE in 0.07 seconds
2021-12-21 07:13:57.916555 (Thread-1): finished collecting timing info
2021-12-21 07:13:57.917097 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 07:13:57.918235 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7181f7f4-d1af-45e8-9bcd-2f8a3e09070e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131270d0>]}
2021-12-21 07:13:57.918915 (Thread-1): 14:13:57 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388963 in 11.92s]
2021-12-21 07:13:57.919241 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:13:57.921161 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:13:57.921505 (MainThread): Using postgres connection "master".
2021-12-21 07:13:57.921747 (MainThread): On master: BEGIN
2021-12-21 07:13:57.921981 (MainThread): Opening a new connection, currently in state closed
2021-12-21 07:13:58.252658 (MainThread): SQL status: BEGIN in 0.33 seconds
2021-12-21 07:13:58.253276 (MainThread): On master: COMMIT
2021-12-21 07:13:58.253657 (MainThread): Using postgres connection "master".
2021-12-21 07:13:58.253987 (MainThread): On master: COMMIT
2021-12-21 07:13:58.292687 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:13:58.293417 (MainThread): On master: Close
2021-12-21 07:13:58.294758 (MainThread): 14:13:58 | 
2021-12-21 07:13:58.295235 (MainThread): 14:13:58 | Finished running 3 table models in 27.02s.
2021-12-21 07:13:58.295630 (MainThread): Connection 'master' was properly closed.
2021-12-21 07:13:58.295969 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 07:13:58.308114 (MainThread): 
2021-12-21 07:13:58.308541 (MainThread): Completed successfully
2021-12-21 07:13:58.308880 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 07:13:58.309260 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130a5d90>]}
2021-12-21 07:13:58.309708 (MainThread): Flushing usage events
2021-12-21 07:17:33.270540 (MainThread): Running with dbt=0.21.0
2021-12-21 07:17:33.376251 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/waresix_project/waresix_dbt', project_dir='/Users/waresix/waresix_project/waresix_dbt', record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-21 07:17:33.377235 (MainThread): Tracking: tracking
2021-12-21 07:17:33.391683 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113187910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131b3430>]}
2021-12-21 07:17:33.403748 (MainThread): Partial parsing not enabled
2021-12-21 07:17:33.425250 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:17:33.430459 (MainThread): Parsing macros/relations.sql
2021-12-21 07:17:33.431971 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:17:33.456369 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:17:33.458160 (MainThread): Parsing macros/core.sql
2021-12-21 07:17:33.462106 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:17:33.469448 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:17:33.479845 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:17:33.481654 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:17:33.500124 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:17:33.534481 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:17:33.560791 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:17:33.563338 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:17:33.576753 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:17:33.602168 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:17:33.621062 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:17:33.630339 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:17:33.638663 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:17:33.642928 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:17:33.644504 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:17:33.645505 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:17:33.647090 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:17:33.656181 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:17:33.658061 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:17:33.660734 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:17:33.662415 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:17:33.721484 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:17:33.723425 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:17:33.724734 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:17:33.726120 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:17:33.920709 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:17:33.933301 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:17:33.967689 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:17:34.001498 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.003488 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.005271 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.008171 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.009876 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.011854 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:17:34.021064 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:17:34.026234 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '137a4d04-b962-46e2-ab7d-ddbeb4fb0ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b4490>]}
2021-12-21 07:17:34.036490 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:17:34.037087 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '137a4d04-b962-46e2-ab7d-ddbeb4fb0ca5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132b4310>]}
2021-12-21 07:17:34.037360 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:17:34.039753 (MainThread): 
2021-12-21 07:17:34.041914 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:17:34.045150 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:17:34.066432 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:17:34.067175 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 07:17:34.067364 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-21 07:17:34.793779 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.73 seconds
2021-12-21 07:17:34.794354 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:17:34.794720 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 07:17:34.833621 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 07:17:34.837596 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 07:17:34.873575 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 07:17:34.883767 (MainThread): Using postgres connection "master".
2021-12-21 07:17:34.884115 (MainThread): On master: BEGIN
2021-12-21 07:17:34.884361 (MainThread): Opening a new connection, currently in state init
2021-12-21 07:17:35.193698 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:17:35.194269 (MainThread): Using postgres connection "master".
2021-12-21 07:17:35.194644 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 07:17:35.253653 (MainThread): SQL status: SELECT 0 in 0.06 seconds
2021-12-21 07:17:35.256856 (MainThread): On master: ROLLBACK
2021-12-21 07:17:35.293369 (MainThread): On master: Close
2021-12-21 07:17:35.295027 (MainThread): 14:17:35 | Concurrency: 1 threads (target='dev')
2021-12-21 07:17:35.295580 (MainThread): 14:17:35 | 
2021-12-21 07:17:35.300095 (Thread-1): Began running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 07:17:35.300574 (Thread-1): 14:17:35 | 1 of 6 START test not_null_clean_odoo_purchase_order_id.............. [RUN]
2021-12-21 07:17:35.301300 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 07:17:35.301726 (Thread-1): Compiling test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 07:17:35.322363 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 07:17:35.324914 (Thread-1): finished collecting timing info
2021-12-21 07:17:35.345951 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 07:17:35.347231 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 07:17:35.347457 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: BEGIN
2021-12-21 07:17:35.347579 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:35.683319 (Thread-1): SQL status: BEGIN in 0.34 seconds
2021-12-21 07:17:35.683585 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 07:17:35.683743 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is null



      
    ) dbt_internal_test
2021-12-21 07:17:35.754135 (Thread-1): SQL status: SELECT 1 in 0.07 seconds
2021-12-21 07:17:35.759352 (Thread-1): finished collecting timing info
2021-12-21 07:17:35.759715 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: ROLLBACK
2021-12-21 07:17:35.803836 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: Close
2021-12-21 07:17:35.805372 (Thread-1): 14:17:35 | 1 of 6 PASS not_null_clean_odoo_purchase_order_id.................... [PASS in 0.50s]
2021-12-21 07:17:35.805875 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 07:17:35.806384 (Thread-1): Began running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 07:17:35.807115 (Thread-1): 14:17:35 | 2 of 6 START test not_null_clean_partner_company_phones_id........... [RUN]
2021-12-21 07:17:35.807965 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 07:17:35.808372 (Thread-1): Compiling test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 07:17:35.818654 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 07:17:35.821325 (Thread-1): finished collecting timing info
2021-12-21 07:17:35.825920 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"
2021-12-21 07:17:35.827605 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 07:17:35.827818 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: BEGIN
2021-12-21 07:17:35.827982 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:36.143740 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:17:36.144287 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911".
2021-12-21 07:17:36.144646 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is null



      
    ) dbt_internal_test
2021-12-21 07:17:36.183570 (Thread-1): SQL status: SELECT 1 in 0.04 seconds
2021-12-21 07:17:36.187397 (Thread-1): finished collecting timing info
2021-12-21 07:17:36.187918 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: ROLLBACK
2021-12-21 07:17:36.213779 (Thread-1): On test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911: Close
2021-12-21 07:17:36.215458 (Thread-1): 14:17:36 | 2 of 6 PASS not_null_clean_partner_company_phones_id................. [PASS in 0.41s]
2021-12-21 07:17:36.215983 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_partner_company_phones_id.943759d911
2021-12-21 07:17:36.216410 (Thread-1): Began running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 07:17:36.216729 (Thread-1): 14:17:36 | 3 of 6 START test not_null_clean_transport_delivery_orders_id........ [RUN]
2021-12-21 07:17:36.217265 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 07:17:36.217549 (Thread-1): Compiling test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 07:17:36.224163 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 07:17:36.226061 (Thread-1): finished collecting timing info
2021-12-21 07:17:36.229238 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"
2021-12-21 07:17:36.230097 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 07:17:36.230328 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: BEGIN
2021-12-21 07:17:36.230534 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:36.553904 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:17:36.554498 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1".
2021-12-21 07:17:36.554885 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is null



      
    ) dbt_internal_test
2021-12-21 07:17:39.213445 (Thread-1): SQL status: SELECT 1 in 2.66 seconds
2021-12-21 07:17:39.216373 (Thread-1): finished collecting timing info
2021-12-21 07:17:39.216745 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: ROLLBACK
2021-12-21 07:17:39.253035 (Thread-1): On test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1: Close
2021-12-21 07:17:39.253886 (Thread-1): 14:17:39 | 3 of 6 PASS not_null_clean_transport_delivery_orders_id.............. [PASS in 3.04s]
2021-12-21 07:17:39.254135 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_transport_delivery_orders_id.cd140062e1
2021-12-21 07:17:39.254364 (Thread-1): Began running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 07:17:39.254576 (Thread-1): 14:17:39 | 4 of 6 START test unique_clean_odoo_purchase_order_id................ [RUN]
2021-12-21 07:17:39.255081 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 07:17:39.255286 (Thread-1): Compiling test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 07:17:39.262953 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 07:17:39.263536 (Thread-1): finished collecting timing info
2021-12-21 07:17:39.265516 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 07:17:39.266059 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 07:17:39.266213 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: BEGIN
2021-12-21 07:17:39.266348 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:39.585474 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:17:39.586044 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 07:17:39.586398 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 07:17:39.693023 (Thread-1): SQL status: SELECT 1 in 0.11 seconds
2021-12-21 07:17:39.695034 (Thread-1): finished collecting timing info
2021-12-21 07:17:39.695357 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: ROLLBACK
2021-12-21 07:17:39.736630 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: Close
2021-12-21 07:17:39.737412 (Thread-1): 14:17:39 | 4 of 6 PASS unique_clean_odoo_purchase_order_id...................... [PASS in 0.48s]
2021-12-21 07:17:39.737647 (Thread-1): Finished running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 07:17:39.737909 (Thread-1): Began running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 07:17:39.738297 (Thread-1): 14:17:39 | 5 of 6 START test unique_clean_partner_company_phones_id............. [RUN]
2021-12-21 07:17:39.738949 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 07:17:39.739239 (Thread-1): Compiling test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 07:17:39.747149 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 07:17:39.748306 (Thread-1): finished collecting timing info
2021-12-21 07:17:39.750739 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"
2021-12-21 07:17:39.751408 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 07:17:39.751676 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: BEGIN
2021-12-21 07:17:39.751861 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:40.073704 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:17:40.074325 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b".
2021-12-21 07:17:40.074711 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_partner_company_phones"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 07:17:40.123468 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2021-12-21 07:17:40.127240 (Thread-1): finished collecting timing info
2021-12-21 07:17:40.127648 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: ROLLBACK
2021-12-21 07:17:40.163533 (Thread-1): On test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b: Close
2021-12-21 07:17:40.165041 (Thread-1): 14:17:40 | 5 of 6 PASS unique_clean_partner_company_phones_id................... [PASS in 0.43s]
2021-12-21 07:17:40.165692 (Thread-1): Finished running node test.waresix_dbt.unique_clean_partner_company_phones_id.d6d25c9b2b
2021-12-21 07:17:40.166210 (Thread-1): Began running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 07:17:40.166917 (Thread-1): 14:17:40 | 6 of 6 START test unique_clean_transport_delivery_orders_id.......... [RUN]
2021-12-21 07:17:40.167790 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 07:17:40.168204 (Thread-1): Compiling test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 07:17:40.175012 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 07:17:40.175839 (Thread-1): finished collecting timing info
2021-12-21 07:17:40.178746 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"
2021-12-21 07:17:40.180224 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 07:17:40.180503 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: BEGIN
2021-12-21 07:17:40.180721 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:17:40.555512 (Thread-1): SQL status: BEGIN in 0.37 seconds
2021-12-21 07:17:40.556119 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924".
2021-12-21 07:17:40.556484 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_transport_delivery_orders"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 07:17:41.283451 (Thread-1): SQL status: SELECT 1 in 0.73 seconds
2021-12-21 07:17:41.287230 (Thread-1): finished collecting timing info
2021-12-21 07:17:41.287745 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: ROLLBACK
2021-12-21 07:17:41.323621 (Thread-1): On test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924: Close
2021-12-21 07:17:41.325149 (Thread-1): 14:17:41 | 6 of 6 PASS unique_clean_transport_delivery_orders_id................ [PASS in 1.16s]
2021-12-21 07:17:41.325636 (Thread-1): Finished running node test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924
2021-12-21 07:17:41.328009 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:17:41.328863 (MainThread): 14:17:41 | 
2021-12-21 07:17:41.329305 (MainThread): 14:17:41 | Finished running 6 tests in 7.29s.
2021-12-21 07:17:41.329693 (MainThread): Connection 'master' was properly closed.
2021-12-21 07:17:41.330015 (MainThread): Connection 'test.waresix_dbt.unique_clean_transport_delivery_orders_id.f5cd0cc924' was properly closed.
2021-12-21 07:17:41.339249 (MainThread): 
2021-12-21 07:17:41.339576 (MainThread): Completed successfully
2021-12-21 07:17:41.339854 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-12-21 07:17:41.340194 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131d5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112369580>]}
2021-12-21 07:17:41.340578 (MainThread): Flushing usage events
2021-12-21 07:24:32.092247 (MainThread): Running with dbt=0.21.0
2021-12-21 07:24:32.096059 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'waresix_dbt'
2021-12-21 07:24:32.096155 (MainThread): No profile "waresix_dbt" found, continuing with no target
2021-12-21 07:24:32.120528 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2021-12-21 07:24:32.121740 (MainThread): Tracking: do not track
2021-12-21 07:24:32.139008 (MainThread): Warning: No packages were found in packages.yml
2021-12-21 07:24:32.139512 (MainThread): Flushing usage events
2021-12-21 07:35:49.880676 (MainThread): Running with dbt=0.21.0
2021-12-21 07:35:49.956646 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:35:49.958676 (MainThread): Tracking: tracking
2021-12-21 07:35:49.972564 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ffdb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111012580>]}
2021-12-21 07:35:49.992239 (MainThread): Partial parsing not enabled
2021-12-21 07:35:50.007876 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:35:50.012816 (MainThread): Parsing macros/relations.sql
2021-12-21 07:35:50.015767 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:35:50.042819 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:35:50.044684 (MainThread): Parsing macros/core.sql
2021-12-21 07:35:50.048770 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:35:50.056000 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:35:50.066480 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:35:50.068329 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:35:50.087865 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:35:50.123494 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:35:50.149258 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:35:50.151157 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:35:50.162188 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:35:50.183304 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:35:50.197999 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:35:50.206084 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:35:50.213558 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:35:50.217646 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:35:50.219278 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:35:50.220289 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:35:50.221802 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:35:50.230441 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:35:50.232215 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:35:50.235038 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:35:50.236847 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:35:50.294927 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:35:50.296702 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:35:50.297896 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:35:50.299224 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:35:50.489294 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:35:50.501971 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:35:50.534355 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:35:50.567774 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.569735 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.572840 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.574702 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.576465 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.578239 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:35:50.589216 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:35:50.595053 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0323775-0a4d-4579-9d88-7dad3a4afa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111111520>]}
2021-12-21 07:35:50.603417 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:35:50.603869 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0323775-0a4d-4579-9d88-7dad3a4afa1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111111580>]}
2021-12-21 07:35:50.604126 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:35:50.604475 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 07:35:50.605472 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 07:35:50.609891 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111148ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111042430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110423a0>]}
2021-12-21 07:35:50.610141 (MainThread): Flushing usage events
2021-12-21 07:35:52.303620 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 07:37:33.327527 (MainThread): Running with dbt=0.21.0
2021-12-21 07:37:33.422697 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:37:33.424015 (MainThread): Tracking: tracking
2021-12-21 07:37:33.439438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124cdb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e3550>]}
2021-12-21 07:37:33.452495 (MainThread): Partial parsing not enabled
2021-12-21 07:37:33.471836 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:37:33.476831 (MainThread): Parsing macros/relations.sql
2021-12-21 07:37:33.478267 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:37:33.502369 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:37:33.504290 (MainThread): Parsing macros/core.sql
2021-12-21 07:37:33.508287 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:37:33.515617 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:37:33.525855 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:37:33.527544 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:37:33.545932 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:37:33.580788 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:37:33.605801 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:37:33.607751 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:37:33.619032 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:37:33.639888 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:37:33.654162 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:37:33.662997 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:37:33.670726 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:37:33.675053 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:37:33.676588 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:37:33.677569 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:37:33.679153 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:37:33.688394 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:37:33.690259 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:37:33.692806 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:37:33.694435 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:37:33.752762 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:37:33.754550 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:37:33.756277 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:37:33.757831 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:37:33.946614 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:37:33.959369 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:37:33.993514 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:37:34.035025 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.037410 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.040999 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.043518 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.045734 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.047974 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:34.059039 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:37:34.065818 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '652bac34-6652-4735-8896-f3d867c46599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e1160>]}
2021-12-21 07:37:34.078486 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:37:34.079106 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '652bac34-6652-4735-8896-f3d867c46599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e1280>]}
2021-12-21 07:37:34.079411 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:37:34.079810 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 07:37:34.081048 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 07:37:34.086107 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125143d0>]}
2021-12-21 07:37:34.086370 (MainThread): Flushing usage events
2021-12-21 07:37:35.905737 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 07:37:57.681924 (MainThread): Running with dbt=0.21.0
2021-12-21 07:37:57.776780 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:37:57.778011 (MainThread): Tracking: tracking
2021-12-21 07:37:57.790670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b284610>]}
2021-12-21 07:37:57.803237 (MainThread): Partial parsing not enabled
2021-12-21 07:37:57.821146 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:37:57.825840 (MainThread): Parsing macros/relations.sql
2021-12-21 07:37:57.827313 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:37:57.852436 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:37:57.854537 (MainThread): Parsing macros/core.sql
2021-12-21 07:37:57.858680 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:37:57.866271 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:37:57.877651 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:37:57.879521 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:37:57.898668 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:37:57.933984 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:37:57.958965 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:37:57.960831 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:37:57.972108 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:37:57.993674 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:37:58.010224 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:37:58.018820 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:37:58.027572 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:37:58.032447 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:37:58.034274 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:37:58.035379 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:37:58.037137 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:37:58.048720 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:37:58.050739 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:37:58.053432 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:37:58.055159 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:37:58.114053 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:37:58.115862 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:37:58.117099 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:37:58.118578 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:37:58.313970 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:37:58.327240 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:37:58.359496 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:37:58.393255 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.395058 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.396837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.399650 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.401291 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.402954 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:37:58.412043 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:37:58.418082 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b2e5e84-28fd-4be2-bc91-7ca6ad4ed469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37f2e0>]}
2021-12-21 07:37:58.427374 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:37:58.427891 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b2e5e84-28fd-4be2-bc91-7ca6ad4ed469', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b37f430>]}
2021-12-21 07:37:58.428181 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:37:58.428594 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 07:37:58.429793 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 07:37:58.436101 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3bad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2b4430>]}
2021-12-21 07:37:58.436394 (MainThread): Flushing usage events
2021-12-21 07:37:59.926629 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 07:45:34.314613 (MainThread): Running with dbt=0.21.0
2021-12-21 07:45:34.413517 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:45:34.414676 (MainThread): Tracking: tracking
2021-12-21 07:45:34.429339 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085fa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108612a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10862a4c0>]}
2021-12-21 07:45:34.441996 (MainThread): Partial parsing not enabled
2021-12-21 07:45:34.461118 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:45:34.466454 (MainThread): Parsing macros/relations.sql
2021-12-21 07:45:34.467944 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:45:34.494652 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:45:34.496599 (MainThread): Parsing macros/core.sql
2021-12-21 07:45:34.501222 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:45:34.509353 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:45:34.521043 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:45:34.523052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:45:34.543209 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:45:34.579920 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:45:34.606318 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:45:34.608501 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:45:34.620853 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:45:34.644303 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:45:34.660538 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:45:34.669985 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:45:34.678372 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:45:34.682948 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:45:34.685518 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:45:34.686746 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:45:34.688452 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:45:34.700574 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:45:34.703375 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:45:34.707202 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:45:34.709599 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:45:34.779588 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:45:34.781539 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:45:34.782847 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:45:34.784730 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:45:34.987891 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:45:35.002346 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:45:35.035740 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:45:35.075995 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.078543 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.080837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.084556 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.086724 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.088817 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:45:35.098861 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:45:35.105169 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce3c94c5-6598-4a5d-9d77-421f56089278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873ab50>]}
2021-12-21 07:45:35.112710 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:45:35.113321 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce3c94c5-6598-4a5d-9d77-421f56089278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873ad30>]}
2021-12-21 07:45:35.113620 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:45:35.114040 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 07:45:35.115627 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 07:45:35.123390 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108761b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10865b370>]}
2021-12-21 07:45:35.123704 (MainThread): Flushing usage events
2021-12-21 07:45:36.864312 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 07:47:34.373769 (MainThread): Running with dbt=0.21.0
2021-12-21 07:47:34.463546 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:47:34.465032 (MainThread): Tracking: tracking
2021-12-21 07:47:34.478308 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d49a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4b7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4cc5e0>]}
2021-12-21 07:47:34.490391 (MainThread): Partial parsing not enabled
2021-12-21 07:47:34.509609 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:47:34.515236 (MainThread): Parsing macros/relations.sql
2021-12-21 07:47:34.516743 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:47:34.540330 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:47:34.542034 (MainThread): Parsing macros/core.sql
2021-12-21 07:47:34.545853 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:47:34.552750 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:47:34.563020 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:47:34.564870 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:47:34.583240 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:47:34.618372 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:47:34.643972 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:47:34.645983 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:47:34.656946 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:47:34.678060 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:47:34.692906 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:47:34.701417 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:47:34.709389 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:47:34.713550 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:47:34.715123 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:47:34.716100 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:47:34.717643 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:47:34.726848 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:47:34.728847 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:47:34.731368 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:47:34.733170 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:47:34.790329 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:47:34.792306 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:47:34.793530 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:47:34.794869 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:47:34.994062 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:35.008432 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:35.040447 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:35.074473 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.076413 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.078204 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.081137 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.082877 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.084631 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:47:35.093634 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:47:35.099441 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '134613d7-0edf-41ee-978d-4a635faf9226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c8490>]}
2021-12-21 07:47:35.107687 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:47:35.108694 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '134613d7-0edf-41ee-978d-4a635faf9226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c85e0>]}
2021-12-21 07:47:35.109011 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:47:35.110719 (MainThread): 
2021-12-21 07:47:35.111219 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:47:35.112193 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 07:47:35.121978 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 07:47:35.122180 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 07:47:35.122304 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 07:47:35.540488 (ThreadPoolExecutor-0_0): SQL status: SELECT 190 in 0.42 seconds
2021-12-21 07:47:35.546124 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 07:47:35.548330 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:47:35.558551 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:47:35.558801 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 07:47:35.558962 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 07:47:35.871969 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:47:35.872373 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:47:35.872691 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 07:47:35.936794 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.06 seconds
2021-12-21 07:47:35.938906 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 07:47:35.979755 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 07:47:35.984988 (MainThread): Using postgres connection "master".
2021-12-21 07:47:35.985192 (MainThread): On master: BEGIN
2021-12-21 07:47:35.985321 (MainThread): Opening a new connection, currently in state init
2021-12-21 07:47:36.300302 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:47:36.300877 (MainThread): Using postgres connection "master".
2021-12-21 07:47:36.301229 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 07:47:36.339833 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 07:47:36.341264 (MainThread): On master: ROLLBACK
2021-12-21 07:47:36.380149 (MainThread): Using postgres connection "master".
2021-12-21 07:47:36.380684 (MainThread): On master: BEGIN
2021-12-21 07:47:36.449070 (MainThread): SQL status: BEGIN in 0.07 seconds
2021-12-21 07:47:36.449679 (MainThread): On master: COMMIT
2021-12-21 07:47:36.450067 (MainThread): Using postgres connection "master".
2021-12-21 07:47:36.450393 (MainThread): On master: COMMIT
2021-12-21 07:47:36.490176 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:47:36.490694 (MainThread): On master: Close
2021-12-21 07:47:36.491782 (MainThread): 14:47:36 | Concurrency: 1 threads (target='dev')
2021-12-21 07:47:36.492163 (MainThread): 14:47:36 | 
2021-12-21 07:47:36.498937 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:47:36.499566 (Thread-1): 14:47:36 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 07:47:36.500281 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:36.500676 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:47:36.503257 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:47:36.506035 (Thread-1): finished collecting timing info
2021-12-21 07:47:36.541598 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:47:36.543829 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:36.544084 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 07:47:36.544233 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:47:36.880183 (Thread-1): SQL status: BEGIN in 0.34 seconds
2021-12-21 07:47:36.880724 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:36.881077 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 07:47:37.278610 (Thread-1): SQL status: SELECT 62835 in 0.40 seconds
2021-12-21 07:47:37.291567 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:37.291998 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 07:47:37.340087 (Thread-1): SQL status: ALTER TABLE in 0.05 seconds
2021-12-21 07:47:37.345598 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:37.345891 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 07:47:37.389947 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:47:37.408767 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:47:37.409016 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:37.409175 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:47:37.450405 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:47:37.460768 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:47:37.461007 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 07:47:37.509972 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 07:47:37.513204 (Thread-1): finished collecting timing info
2021-12-21 07:47:37.513723 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 07:47:37.514992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '134613d7-0edf-41ee-978d-4a635faf9226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d536a00>]}
2021-12-21 07:47:37.515695 (Thread-1): 14:47:37 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62835 in 1.01s]
2021-12-21 07:47:37.516022 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:47:37.516358 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:47:37.516871 (Thread-1): 14:47:37 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 07:47:37.517855 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:37.518307 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:47:37.520980 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:47:37.522669 (Thread-1): finished collecting timing info
2021-12-21 07:47:37.527243 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:47:37.528722 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:37.528954 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 07:47:37.529112 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:47:37.849742 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:47:37.850106 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:37.850358 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 07:47:37.910345 (Thread-1): SQL status: SELECT 2816 in 0.06 seconds
2021-12-21 07:47:37.916017 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:37.916335 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 07:47:37.960483 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:47:37.965947 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:37.966235 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 07:47:38.009641 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:47:38.011145 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:47:38.011336 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:38.011468 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:47:38.049539 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:47:38.051173 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:47:38.051340 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 07:47:38.100403 (Thread-1): SQL status: DROP TABLE in 0.05 seconds
2021-12-21 07:47:38.103722 (Thread-1): finished collecting timing info
2021-12-21 07:47:38.104256 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 07:47:38.105328 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '134613d7-0edf-41ee-978d-4a635faf9226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5410a0>]}
2021-12-21 07:47:38.106004 (Thread-1): 14:47:38 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.59s]
2021-12-21 07:47:38.106379 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:47:38.106712 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:47:38.107240 (Thread-1): 14:47:38 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 07:47:38.107957 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:38.108646 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:47:38.111211 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:47:38.112016 (Thread-1): finished collecting timing info
2021-12-21 07:47:38.115720 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:47:38.117873 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:38.118178 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 07:47:38.118387 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:47:38.430553 (Thread-1): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:47:38.431133 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:38.431498 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 07:47:45.779880 (Thread-1): SQL status: SELECT 388989 in 7.35 seconds
2021-12-21 07:47:45.785782 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:45.786095 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 07:47:45.829795 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:47:45.837368 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:45.837690 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 07:47:45.880029 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:47:45.883614 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:47:45.884034 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:45.884412 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:47:47.269571 (Thread-1): SQL status: COMMIT in 1.38 seconds
2021-12-21 07:47:47.271282 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:47:47.271466 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 07:47:47.329320 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-12-21 07:47:47.330867 (Thread-1): finished collecting timing info
2021-12-21 07:47:47.331129 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 07:47:47.331721 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '134613d7-0edf-41ee-978d-4a635faf9226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d70beb0>]}
2021-12-21 07:47:47.332075 (Thread-1): 14:47:47 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388989 in 9.22s]
2021-12-21 07:47:47.332234 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:47:47.333618 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:47:47.333843 (MainThread): Using postgres connection "master".
2021-12-21 07:47:47.333966 (MainThread): On master: BEGIN
2021-12-21 07:47:47.334076 (MainThread): Opening a new connection, currently in state closed
2021-12-21 07:47:47.649225 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:47:47.649502 (MainThread): On master: COMMIT
2021-12-21 07:47:47.649633 (MainThread): Using postgres connection "master".
2021-12-21 07:47:47.649741 (MainThread): On master: COMMIT
2021-12-21 07:47:47.689200 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:47:47.689494 (MainThread): On master: Close
2021-12-21 07:47:47.690071 (MainThread): 14:47:47 | 
2021-12-21 07:47:47.690268 (MainThread): 14:47:47 | Finished running 3 table models in 12.58s.
2021-12-21 07:47:47.690417 (MainThread): Connection 'master' was properly closed.
2021-12-21 07:47:47.690531 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 07:47:47.697199 (MainThread): 
2021-12-21 07:47:47.697523 (MainThread): Completed successfully
2021-12-21 07:47:47.697807 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 07:47:47.698701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d661c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d661df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d661700>]}
2021-12-21 07:47:47.699314 (MainThread): Flushing usage events
2021-12-21 07:55:54.330324 (MainThread): Running with dbt=0.21.0
2021-12-21 07:55:54.430110 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:55:54.431985 (MainThread): Tracking: tracking
2021-12-21 07:55:54.449318 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120b4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120cdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e0580>]}
2021-12-21 07:55:54.462151 (MainThread): Partial parsing not enabled
2021-12-21 07:55:54.483401 (MainThread): Parsing macros/catalog.sql
2021-12-21 07:55:54.489192 (MainThread): Parsing macros/relations.sql
2021-12-21 07:55:54.490779 (MainThread): Parsing macros/adapters.sql
2021-12-21 07:55:54.514687 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 07:55:54.516489 (MainThread): Parsing macros/core.sql
2021-12-21 07:55:54.520859 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 07:55:54.528026 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 07:55:54.538224 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 07:55:54.540211 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 07:55:54.558855 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 07:55:54.592780 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 07:55:54.617029 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 07:55:54.618925 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 07:55:54.630033 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 07:55:54.650910 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 07:55:54.665608 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 07:55:54.674138 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 07:55:54.681853 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 07:55:54.685861 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 07:55:54.687336 (MainThread): Parsing macros/etc/query.sql
2021-12-21 07:55:54.688355 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 07:55:54.690092 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 07:55:54.698974 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 07:55:54.700770 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 07:55:54.703206 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 07:55:54.704779 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 07:55:54.763975 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 07:55:54.765986 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 07:55:54.767354 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 07:55:54.768745 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 07:55:54.956805 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:54.969970 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:55:55.004163 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:55.037069 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.039314 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.042768 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.044677 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.050256 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.052398 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 07:55:55.064586 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 07:55:55.071834 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86fc77f-6b29-4b86-8e72-981f2201014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121dd4c0>]}
2021-12-21 07:55:55.082591 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 07:55:55.084496 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86fc77f-6b29-4b86-8e72-981f2201014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121dd730>]}
2021-12-21 07:55:55.085131 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 07:55:55.088787 (MainThread): 
2021-12-21 07:55:55.089353 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:55:55.090686 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 07:55:55.106987 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 07:55:55.107205 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 07:55:55.107345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 07:55:55.670429 (ThreadPoolExecutor-0_0): SQL status: SELECT 190 in 0.56 seconds
2021-12-21 07:55:55.676347 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 07:55:55.679173 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:55:55.688985 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:55:55.689232 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 07:55:55.689400 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 07:55:56.000067 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:55:56.000628 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 07:55:56.000987 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 07:55:56.040155 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 07:55:56.043691 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 07:55:56.079842 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 07:55:56.086201 (MainThread): Using postgres connection "master".
2021-12-21 07:55:56.086430 (MainThread): On master: BEGIN
2021-12-21 07:55:56.086582 (MainThread): Opening a new connection, currently in state init
2021-12-21 07:55:56.399707 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 07:55:56.400006 (MainThread): Using postgres connection "master".
2021-12-21 07:55:56.400278 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 07:55:56.440121 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 07:55:56.443462 (MainThread): On master: ROLLBACK
2021-12-21 07:55:56.479845 (MainThread): Using postgres connection "master".
2021-12-21 07:55:56.480284 (MainThread): On master: BEGIN
2021-12-21 07:55:56.559829 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 07:55:56.560262 (MainThread): On master: COMMIT
2021-12-21 07:55:56.560457 (MainThread): Using postgres connection "master".
2021-12-21 07:55:56.560607 (MainThread): On master: COMMIT
2021-12-21 07:55:56.599938 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:55:56.600545 (MainThread): On master: Close
2021-12-21 07:55:56.601819 (MainThread): 14:55:56 | Concurrency: 1 threads (target='dev')
2021-12-21 07:55:56.602309 (MainThread): 14:55:56 | 
2021-12-21 07:55:56.608096 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:55:56.608699 (Thread-1): 14:55:56 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 07:55:56.609462 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:56.610211 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:55:56.613066 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:55:56.615798 (Thread-1): finished collecting timing info
2021-12-21 07:55:56.650540 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 07:55:56.651166 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:56.651317 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 07:55:56.651435 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:55:56.970065 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:55:56.970612 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:56.970962 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 07:55:57.492018 (Thread-1): SQL status: SELECT 62839 in 0.52 seconds
2021-12-21 07:55:57.505172 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:57.505516 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 07:55:57.540126 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 07:55:57.545674 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:57.545955 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 07:55:57.590314 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:55:57.611067 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:55:57.611325 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:57.611488 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 07:55:57.650212 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:55:57.661082 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 07:55:57.661388 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 07:55:57.700878 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 07:55:57.703323 (Thread-1): finished collecting timing info
2021-12-21 07:55:57.703725 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 07:55:57.704884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86fc77f-6b29-4b86-8e72-981f2201014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f8610>]}
2021-12-21 07:55:57.705436 (Thread-1): 14:55:57 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62839 in 1.10s]
2021-12-21 07:55:57.705674 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 07:55:57.705953 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:55:57.706554 (Thread-1): 14:55:57 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 07:55:57.707668 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:57.708120 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:55:57.710144 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:55:57.711149 (Thread-1): finished collecting timing info
2021-12-21 07:55:57.716354 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 07:55:57.717406 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:57.717646 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 07:55:57.717821 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:55:57.979871 (Thread-1): SQL status: BEGIN in 0.26 seconds
2021-12-21 07:55:57.980519 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:57.982414 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 07:55:58.071161 (Thread-1): SQL status: SELECT 2816 in 0.09 seconds
2021-12-21 07:55:58.076220 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:58.076572 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 07:55:58.122729 (Thread-1): SQL status: ALTER TABLE in 0.05 seconds
2021-12-21 07:55:58.126195 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:58.126422 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 07:55:58.178787 (Thread-1): SQL status: ALTER TABLE in 0.05 seconds
2021-12-21 07:55:58.180390 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:55:58.180590 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:58.180713 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 07:55:58.220037 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:55:58.224242 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 07:55:58.224549 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 07:55:58.280194 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-12-21 07:55:58.283331 (Thread-1): finished collecting timing info
2021-12-21 07:55:58.283827 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 07:55:58.284966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86fc77f-6b29-4b86-8e72-981f2201014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120803d0>]}
2021-12-21 07:55:58.285665 (Thread-1): 14:55:58 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.58s]
2021-12-21 07:55:58.286030 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 07:55:58.286375 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:55:58.286908 (Thread-1): 14:55:58 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 07:55:58.287727 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:55:58.288492 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:55:58.291026 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:55:58.291848 (Thread-1): finished collecting timing info
2021-12-21 07:55:58.296439 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 07:55:58.297504 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:55:58.297712 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 07:55:58.297873 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 07:55:58.619827 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 07:55:58.620391 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:55:58.620741 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 07:56:04.449807 (Thread-1): SQL status: SELECT 388989 in 5.83 seconds
2021-12-21 07:56:04.456289 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:56:04.456634 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 07:56:04.499665 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:56:04.507125 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:56:04.507445 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 07:56:04.549875 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 07:56:04.553411 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:56:04.553829 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:56:04.554174 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 07:56:04.599770 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 07:56:04.603872 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 07:56:04.604185 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 07:56:04.690086 (Thread-1): SQL status: DROP TABLE in 0.09 seconds
2021-12-21 07:56:04.693190 (Thread-1): finished collecting timing info
2021-12-21 07:56:04.693700 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 07:56:04.694976 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86fc77f-6b29-4b86-8e72-981f2201014d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123260a0>]}
2021-12-21 07:56:04.695632 (Thread-1): 14:56:04 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 388989 in 6.41s]
2021-12-21 07:56:04.695957 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 07:56:04.698486 (MainThread): Acquiring new postgres connection "master".
2021-12-21 07:56:04.698911 (MainThread): Using postgres connection "master".
2021-12-21 07:56:04.699174 (MainThread): On master: BEGIN
2021-12-21 07:56:04.699399 (MainThread): Opening a new connection, currently in state closed
2021-12-21 07:56:04.999315 (MainThread): SQL status: BEGIN in 0.30 seconds
2021-12-21 07:56:04.999602 (MainThread): On master: COMMIT
2021-12-21 07:56:04.999731 (MainThread): Using postgres connection "master".
2021-12-21 07:56:04.999839 (MainThread): On master: COMMIT
2021-12-21 07:56:05.039257 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 07:56:05.039555 (MainThread): On master: Close
2021-12-21 07:56:05.040099 (MainThread): 14:56:05 | 
2021-12-21 07:56:05.040279 (MainThread): 14:56:05 | Finished running 3 table models in 9.95s.
2021-12-21 07:56:05.040421 (MainThread): Connection 'master' was properly closed.
2021-12-21 07:56:05.040532 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 07:56:05.045748 (MainThread): 
2021-12-21 07:56:05.045980 (MainThread): Completed successfully
2021-12-21 07:56:05.046167 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 07:56:05.046451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112274070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112274700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122748e0>]}
2021-12-21 07:56:05.046744 (MainThread): Flushing usage events
2021-12-21 07:56:38.223367 (MainThread): Running with dbt=0.21.0
2021-12-21 07:56:38.324570 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:56:38.325674 (MainThread): Tracking: tracking
2021-12-21 07:56:38.337551 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714c580>]}
2021-12-21 07:56:38.349969 (MainThread): Partial parsing not enabled
2021-12-21 07:56:38.354559 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107117b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717ac10>]}
2021-12-21 07:56:38.354838 (MainThread): Flushing usage events
2021-12-21 07:56:40.551519 (MainThread): Encountered an error:
2021-12-21 07:56:40.551840 (MainThread): Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   tags: ['transport']
    5  |   - name: clean_transport_delivery_orders
    6  |     description: This clean layer for transport's table
    7  |     columns:
    8  |       - name: id
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 3
    did not find expected key
      in "<unicode string>", line 5, column 3
2021-12-21 07:56:40.622608 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 3
did not find expected key
  in "<unicode string>", line 5, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   tags: ['transport']
  5  |   - name: clean_transport_delivery_orders
  6  |     description: This clean layer for transport's table
  7  |     columns:
  8  |       - name: id
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 3
  did not find expected key
    in "<unicode string>", line 5, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   tags: ['transport']
    5  |   - name: clean_transport_delivery_orders
    6  |     description: This clean layer for transport's table
    7  |     columns:
    8  |       - name: id
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 3
    did not find expected key
      in "<unicode string>", line 5, column 3

2021-12-21 07:57:02.519712 (MainThread): Running with dbt=0.21.0
2021-12-21 07:57:02.596791 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 07:57:02.597634 (MainThread): Tracking: tracking
2021-12-21 07:57:02.607871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f00b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f14580>]}
2021-12-21 07:57:02.619911 (MainThread): Partial parsing not enabled
2021-12-21 07:57:02.623286 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f43c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f43be0>]}
2021-12-21 07:57:02.623536 (MainThread): Flushing usage events
2021-12-21 07:57:03.762799 (MainThread): Encountered an error:
2021-12-21 07:57:03.763265 (MainThread): Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   +tags: ['transport']
    5  |   - name: clean_transport_delivery_orders
    6  |     description: This clean layer for transport's table
    7  |     columns:
    8  |       - name: id
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 3
    did not find expected key
      in "<unicode string>", line 5, column 3
2021-12-21 07:57:03.818104 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 3
did not find expected key
  in "<unicode string>", line 5, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   +tags: ['transport']
  5  |   - name: clean_transport_delivery_orders
  6  |     description: This clean layer for transport's table
  7  |     columns:
  8  |       - name: id
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 3
  did not find expected key
    in "<unicode string>", line 5, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   +tags: ['transport']
    5  |   - name: clean_transport_delivery_orders
    6  |     description: This clean layer for transport's table
    7  |     columns:
    8  |       - name: id
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 3
    did not find expected key
      in "<unicode string>", line 5, column 3

2021-12-21 08:00:30.545195 (MainThread): Running with dbt=0.21.0
2021-12-21 08:00:30.656039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:00:30.657168 (MainThread): Tracking: tracking
2021-12-21 08:00:30.671006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107814e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107844520>]}
2021-12-21 08:00:30.684370 (MainThread): Partial parsing not enabled
2021-12-21 08:00:30.703503 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:00:30.707951 (MainThread): Parsing macros/relations.sql
2021-12-21 08:00:30.709414 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:00:30.733995 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:00:30.736331 (MainThread): Parsing macros/core.sql
2021-12-21 08:00:30.740490 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:00:30.747928 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:00:30.759064 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:00:30.761003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:00:30.780672 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:00:30.816529 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:00:30.841832 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:00:30.844009 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:00:30.855422 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:00:30.877483 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:00:30.893386 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:00:30.902104 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:00:30.910390 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:00:30.914668 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:00:30.916373 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:00:30.917457 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:00:30.919135 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:00:30.928679 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:00:30.930700 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:00:30.933415 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:00:30.935156 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:00:30.997003 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:00:30.998884 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:00:31.000203 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:00:31.001679 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:00:31.197215 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:00:31.210318 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:00:31.238345 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:00:31.266121 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.268140 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.271672 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.273599 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.278627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.280495 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:31.290656 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 08:00:31.295957 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84172a96-ef8e-4f57-9915-3b9225c1a08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107941370>]}
2021-12-21 08:00:31.303295 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:00:31.304118 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84172a96-ef8e-4f57-9915-3b9225c1a08e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079417f0>]}
2021-12-21 08:00:31.304576 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:00:31.305281 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 08:00:31.306654 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:00:31.313798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078593a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107859310>]}
2021-12-21 08:00:31.314065 (MainThread): Flushing usage events
2021-12-21 08:00:32.616883 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:00:51.205914 (MainThread): Running with dbt=0.21.0
2021-12-21 08:00:51.282502 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:00:51.283680 (MainThread): Tracking: tracking
2021-12-21 08:00:51.295164 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f848a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f864b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f87b580>]}
2021-12-21 08:00:51.307864 (MainThread): Partial parsing not enabled
2021-12-21 08:00:51.320878 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:00:51.325366 (MainThread): Parsing macros/relations.sql
2021-12-21 08:00:51.326938 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:00:51.352142 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:00:51.354086 (MainThread): Parsing macros/core.sql
2021-12-21 08:00:51.358099 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:00:51.365641 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:00:51.376134 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:00:51.377848 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:00:51.396375 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:00:51.432740 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:00:51.459457 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:00:51.461419 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:00:51.472693 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:00:51.494201 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:00:51.509463 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:00:51.518053 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:00:51.525696 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:00:51.529895 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:00:51.531431 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:00:51.532404 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:00:51.534027 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:00:51.543241 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:00:51.545140 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:00:51.547662 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:00:51.549337 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:00:51.607028 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:00:51.608917 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:00:51.610192 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:00:51.611838 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:00:51.802428 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:00:51.814907 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:00:51.847106 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:00:51.877400 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.879387 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.882608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.884332 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.889373 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.891186 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:00:51.902345 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds

2021-12-21 08:00:51.908405 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1fe8e3-abca-41bf-adff-9fe59e028926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9763d0>]}
2021-12-21 08:00:51.917180 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:00:51.918106 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1fe8e3-abca-41bf-adff-9fe59e028926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9764f0>]}
2021-12-21 08:00:51.918453 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:00:51.918863 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 08:00:51.920220 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:00:51.925857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9cff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ab490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8ab430>]}
2021-12-21 08:00:51.926164 (MainThread): Flushing usage events
2021-12-21 08:00:53.275085 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:02:37.539231 (MainThread): Running with dbt=0.21.0
2021-12-21 08:02:37.625763 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:02:37.627590 (MainThread): Tracking: tracking
2021-12-21 08:02:37.639949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edaa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0f580>]}
2021-12-21 08:02:37.651975 (MainThread): Partial parsing not enabled
2021-12-21 08:02:37.655471 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edaa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3fc40>]}
2021-12-21 08:02:37.655765 (MainThread): Flushing usage events
2021-12-21 08:02:39.534913 (MainThread): Encountered an error:
2021-12-21 08:02:39.535384 (MainThread): Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list
2021-12-21 08:02:39.565440 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list

2021-12-21 08:03:17.706078 (MainThread): Running with dbt=0.21.0
2021-12-21 08:03:17.801088 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:03:17.802953 (MainThread): Tracking: tracking
2021-12-21 08:03:17.819188 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3129a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e331ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3474f0>]}
2021-12-21 08:03:17.838093 (MainThread): Partial parsing not enabled
2021-12-21 08:03:17.845142 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3129a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e378910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e378bb0>]}
2021-12-21 08:03:17.845423 (MainThread): Flushing usage events
2021-12-21 08:03:18.978083 (MainThread): Encountered an error:
2021-12-21 08:03:18.978386 (MainThread): Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list
2021-12-21 08:03:19.003083 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list

2021-12-21 08:07:53.201985 (MainThread): Running with dbt=0.21.0
2021-12-21 08:07:53.303742 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:07:53.306330 (MainThread): Tracking: tracking
2021-12-21 08:07:53.333569 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e1580>]}
2021-12-21 08:07:53.349589 (MainThread): Partial parsing not enabled
2021-12-21 08:07:53.355741 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1139a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a113c40>]}
2021-12-21 08:07:53.356051 (MainThread): Flushing usage events
2021-12-21 08:07:55.017123 (MainThread): Encountered an error:
2021-12-21 08:07:55.017529 (MainThread): Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list
2021-12-21 08:07:55.045409 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list

2021-12-21 08:11:03.104271 (MainThread): Running with dbt=0.21.0
2021-12-21 08:11:03.210253 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:11:03.211807 (MainThread): Tracking: tracking
2021-12-21 08:11:03.227201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eddac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef3520>]}
2021-12-21 08:11:03.239578 (MainThread): Partial parsing not enabled
2021-12-21 08:11:03.244706 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f23910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f23bb0>]}
2021-12-21 08:11:03.244996 (MainThread): Flushing usage events
2021-12-21 08:11:04.897423 (MainThread): Encountered an error:
2021-12-21 08:11:04.897867 (MainThread): Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list
2021-12-21 08:11:04.929986 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/clean_transport/schema.yml is invalid because the value of 'models' is not a list

2021-12-21 08:11:45.020452 (MainThread): Running with dbt=0.21.0
2021-12-21 08:11:45.120785 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:11:45.122418 (MainThread): Tracking: tracking
2021-12-21 08:11:45.134504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036faa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037104f0>]}
2021-12-21 08:11:45.147570 (MainThread): Partial parsing not enabled
2021-12-21 08:11:45.167352 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:11:45.172534 (MainThread): Parsing macros/relations.sql
2021-12-21 08:11:45.174042 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:11:45.198337 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:11:45.200190 (MainThread): Parsing macros/core.sql
2021-12-21 08:11:45.204080 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:11:45.211082 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:11:45.221277 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:11:45.222952 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:11:45.241266 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:11:45.275937 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:11:45.302587 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:11:45.304651 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:11:45.315574 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:11:45.337397 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:11:45.352300 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:11:45.360436 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:11:45.368043 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:11:45.372014 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:11:45.373497 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:11:45.374441 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:11:45.376027 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:11:45.384983 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:11:45.386939 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:11:45.389542 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:11:45.391134 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:11:45.448881 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:11:45.450754 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:11:45.452109 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:11:45.453511 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:11:45.642534 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:11:45.655224 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:11:45.688185 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:11:45.718810 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.720650 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.723396 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.725335 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.730637 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.732422 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:11:45.743246 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders
- models.waresix_dbt.clean_odoo_delivery_orders
- models.waresix_dbt.clean_partner_delivery_orders
- seeds

2021-12-21 08:11:45.752046 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99d69d2-a7aa-419d-b9b8-95ef14d1af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10380a1f0>]}
2021-12-21 08:11:45.759918 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:11:45.760458 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99d69d2-a7aa-419d-b9b8-95ef14d1af25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10380a340>]}
2021-12-21 08:11:45.760759 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:11:45.761148 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 08:11:45.762318 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:11:45.769247 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103864fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103742370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037422e0>]}
2021-12-21 08:11:45.769537 (MainThread): Flushing usage events
2021-12-21 08:11:47.288815 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:13:57.077924 (MainThread): Running with dbt=0.21.0
2021-12-21 08:13:57.180500 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:13:57.182320 (MainThread): Tracking: tracking
2021-12-21 08:13:57.197845 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d059b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d072ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0884c0>]}
2021-12-21 08:13:57.210624 (MainThread): Partial parsing not enabled
2021-12-21 08:13:57.228905 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:13:57.233592 (MainThread): Parsing macros/relations.sql
2021-12-21 08:13:57.235027 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:13:57.260731 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:13:57.262548 (MainThread): Parsing macros/core.sql
2021-12-21 08:13:57.266509 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:13:57.275336 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:13:57.285876 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:13:57.287761 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:13:57.306839 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:13:57.341497 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:13:57.366252 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:13:57.368091 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:13:57.379117 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:13:57.400452 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:13:57.414984 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:13:57.424029 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:13:57.432516 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:13:57.437033 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:13:57.439230 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:13:57.440593 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:13:57.442554 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:13:57.453784 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:13:57.456045 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:13:57.459006 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:13:57.461208 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:13:57.526496 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:13:57.528378 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:13:57.529643 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:13:57.531089 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:13:57.727261 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:13:57.742948 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:13:57.782611 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:13:57.818749 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.821357 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.825277 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.827729 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.833911 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.836265 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:13:57.849061 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.waresix_dbt.clean_partner_delivery_orders
- models.waresix_dbt.clean_transport_delivery_orders
- models.waresix_dbt.clean_odoo_delivery_orders
- seeds

2021-12-21 08:13:57.855500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8177bf97-1de0-4760-bce2-71a8ef7b1595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1852e0>]}
2021-12-21 08:13:57.862513 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:13:57.863349 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8177bf97-1de0-4760-bce2-71a8ef7b1595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d185610>]}
2021-12-21 08:13:57.863654 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:13:57.864052 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:13:57.865328 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:13:57.871130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1dbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7310>]}
2021-12-21 08:13:57.871560 (MainThread): Flushing usage events
2021-12-21 08:13:59.514724 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:14:55.600151 (MainThread): Running with dbt=0.21.0
2021-12-21 08:14:55.705683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:14:55.707128 (MainThread): Tracking: tracking
2021-12-21 08:14:55.720309 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f67b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f694b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6a6580>]}
2021-12-21 08:14:55.732970 (MainThread): Partial parsing not enabled
2021-12-21 08:14:55.752708 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:14:55.757254 (MainThread): Parsing macros/relations.sql
2021-12-21 08:14:55.758703 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:14:55.782647 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:14:55.784576 (MainThread): Parsing macros/core.sql
2021-12-21 08:14:55.788415 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:14:55.795347 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:14:55.805802 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:14:55.807645 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:14:55.827098 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:14:55.862270 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:14:55.886482 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:14:55.888312 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:14:55.900461 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:14:55.922065 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:14:55.936936 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:14:55.945142 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:14:55.954631 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:14:55.958897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:14:55.960509 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:14:55.961541 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:14:55.963163 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:14:55.972635 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:14:55.974830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:14:55.977580 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:14:55.979384 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:14:56.038700 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:14:56.040981 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:14:56.042550 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:14:56.043940 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:14:56.236050 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:14:56.248185 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:14:56.280760 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:14:56.311246 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.313181 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.316067 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.318506 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.323668 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.325506 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:14:56.334552 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders
- models.waresix_dbt.clean_odoo_delivery_orders
- models.waresix_dbt.clean_partner_delivery_orders
- seeds

2021-12-21 08:14:56.340373 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84cb8004-5205-41be-bb66-681b554551c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a41f0>]}
2021-12-21 08:14:56.347157 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:14:56.347696 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84cb8004-5205-41be-bb66-681b554551c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a4340>]}
2021-12-21 08:14:56.348088 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:14:56.348659 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:14:56.350603 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:14:56.355367 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7fafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6d43a0>]}
2021-12-21 08:14:56.355632 (MainThread): Flushing usage events
2021-12-21 08:14:57.806064 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:27:47.682311 (MainThread): Running with dbt=0.21.0
2021-12-21 08:27:47.807061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:27:47.808239 (MainThread): Tracking: tracking
2021-12-21 08:27:47.824252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7eba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b801af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b818550>]}
2021-12-21 08:27:47.836807 (MainThread): Partial parsing not enabled
2021-12-21 08:27:47.856951 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:27:47.861942 (MainThread): Parsing macros/relations.sql
2021-12-21 08:27:47.863494 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:27:47.888827 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:27:47.890791 (MainThread): Parsing macros/core.sql
2021-12-21 08:27:47.894822 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:27:47.902116 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:27:47.913351 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:27:47.915254 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:27:47.934268 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:27:47.968906 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:27:47.992964 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:27:47.994760 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:27:48.006229 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:27:48.028263 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:27:48.043569 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:27:48.051926 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:27:48.059897 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:27:48.064054 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:27:48.065652 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:27:48.066630 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:27:48.068184 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:27:48.077296 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:27:48.079138 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:27:48.081936 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:27:48.083673 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:27:48.142920 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:27:48.144779 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:27:48.146079 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:27:48.147470 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:27:48.341258 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:27:48.354983 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:27:48.387801 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:27:48.416301 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.418339 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.421820 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.423984 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.429057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.430888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:27:48.441284 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders
- seeds

2021-12-21 08:27:48.446735 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '191ce6a8-f57e-4c3b-83e7-1aa2eaf64480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b912340>]}
2021-12-21 08:27:48.454337 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:27:48.454970 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '191ce6a8-f57e-4c3b-83e7-1aa2eaf64480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9125b0>]}
2021-12-21 08:27:48.455450 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:27:48.455900 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:27:48.457854 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:27:48.464172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b96bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b848400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b848370>]}
2021-12-21 08:27:48.464467 (MainThread): Flushing usage events
2021-12-21 08:27:50.447684 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:28:34.408199 (MainThread): Running with dbt=0.21.0
2021-12-21 08:28:34.512235 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:28:34.513313 (MainThread): Tracking: tracking
2021-12-21 08:28:34.526221 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ea4f0>]}
2021-12-21 08:28:34.538518 (MainThread): Partial parsing not enabled
2021-12-21 08:28:34.557037 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:28:34.561717 (MainThread): Parsing macros/relations.sql
2021-12-21 08:28:34.563190 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:28:34.588846 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:28:34.590734 (MainThread): Parsing macros/core.sql
2021-12-21 08:28:34.594725 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:28:34.602264 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:28:34.612552 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:28:34.614283 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:28:34.633070 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:28:34.670629 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:28:34.696285 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:28:34.698250 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:28:34.709589 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:28:34.731450 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:28:34.747251 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:28:34.756324 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:28:34.764347 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:28:34.768597 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:28:34.770210 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:28:34.771241 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:28:34.772958 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:28:34.782867 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:28:34.785059 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:28:34.787768 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:28:34.789665 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:28:34.852730 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:28:34.854654 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:28:34.856007 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:28:34.857660 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:28:35.050891 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:28:35.063402 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:28:35.096369 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:28:35.123914 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.125783 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.128614 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.130357 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.135218 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.137199 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:35.146408 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders

2021-12-21 08:28:35.152352 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75e57ddc-0fb8-4fb0-b590-88ce55141e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e30a0>]}
2021-12-21 08:28:35.159073 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:28:35.159749 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75e57ddc-0fb8-4fb0-b590-88ce55141e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e3250>]}
2021-12-21 08:28:35.160133 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:28:35.160678 (MainThread): The selection criterion 'tag:transport' does not match any nodes
2021-12-21 08:28:35.162643 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:28:35.168294 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104227fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411d2b0>]}
2021-12-21 08:28:35.168562 (MainThread): Flushing usage events
2021-12-21 08:28:36.780450 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:28:46.287717 (MainThread): Running with dbt=0.21.0
2021-12-21 08:28:46.394026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:28:46.395310 (MainThread): Tracking: tracking
2021-12-21 08:28:46.408594 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b498a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ad490>]}
2021-12-21 08:28:46.421021 (MainThread): Partial parsing not enabled
2021-12-21 08:28:46.439348 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:28:46.443894 (MainThread): Parsing macros/relations.sql
2021-12-21 08:28:46.445436 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:28:46.469871 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:28:46.471689 (MainThread): Parsing macros/core.sql
2021-12-21 08:28:46.475701 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:28:46.482847 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:28:46.493510 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:28:46.495384 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:28:46.515849 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:28:46.551695 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:28:46.576299 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:28:46.578158 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:28:46.588982 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:28:46.610051 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:28:46.624617 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:28:46.632830 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:28:46.640556 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:28:46.644775 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:28:46.646576 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:28:46.647885 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:28:46.649948 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:28:46.663875 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:28:46.666241 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:28:46.669238 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:28:46.672665 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:28:46.738965 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:28:46.740905 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:28:46.742182 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:28:46.743607 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:28:46.942814 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:28:46.958808 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:28:46.993432 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:28:47.024926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.027074 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.030185 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.032044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.036874 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.038782 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:47.048229 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders

2021-12-21 08:28:47.053679 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43458487-1e58-4bcf-87a9-a78b2462a2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a86a0>]}
2021-12-21 08:28:47.059414 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:28:47.059871 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43458487-1e58-4bcf-87a9-a78b2462a2ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5a8400>]}
2021-12-21 08:28:47.060134 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:28:47.060472 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:28:47.061471 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:28:47.066268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b601fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e03a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4e0310>]}
2021-12-21 08:28:47.066518 (MainThread): Flushing usage events
2021-12-21 08:28:48.530117 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:28:58.093661 (MainThread): Running with dbt=0.21.0
2021-12-21 08:28:58.177898 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:28:58.179155 (MainThread): Tracking: tracking
2021-12-21 08:28:58.192061 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dc550>]}
2021-12-21 08:28:58.204811 (MainThread): Partial parsing not enabled
2021-12-21 08:28:58.224049 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:28:58.228547 (MainThread): Parsing macros/relations.sql
2021-12-21 08:28:58.230123 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:28:58.256608 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:28:58.258424 (MainThread): Parsing macros/core.sql
2021-12-21 08:28:58.262737 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:28:58.270001 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:28:58.280328 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:28:58.282056 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:28:58.301378 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:28:58.336575 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:28:58.360245 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:28:58.362129 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:28:58.372813 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:28:58.394247 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:28:58.409078 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:28:58.417198 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:28:58.425073 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:28:58.429121 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:28:58.430657 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:28:58.431633 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:28:58.433294 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:28:58.442403 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:28:58.444207 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:28:58.446906 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:28:58.448501 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:28:58.507953 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:28:58.509810 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:28:58.511336 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:28:58.512746 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:28:58.734752 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:28:58.749779 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:28:58.781971 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:28:58.818906 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.821455 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.825369 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.827878 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.833978 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.836439 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:28:58.847975 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders

2021-12-21 08:28:58.854360 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f68945e-0e8c-437c-82ba-70ce3230edae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d8340>]}
2021-12-21 08:28:58.860857 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:28:58.861338 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f68945e-0e8c-437c-82ba-70ce3230edae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d8670>]}
2021-12-21 08:28:58.861638 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:28:58.862048 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:28:58.863595 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:28:58.869375 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105831f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570d2b0>]}
2021-12-21 08:28:58.869675 (MainThread): Flushing usage events
2021-12-21 08:29:00.200454 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:29:18.558200 (MainThread): Running with dbt=0.21.0
2021-12-21 08:29:18.657590 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:29:18.658866 (MainThread): Tracking: tracking
2021-12-21 08:29:18.674079 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c19490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c35a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c49490>]}
2021-12-21 08:29:18.686369 (MainThread): Partial parsing not enabled
2021-12-21 08:29:18.704892 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:29:18.709930 (MainThread): Parsing macros/relations.sql
2021-12-21 08:29:18.711430 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:29:18.736638 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:29:18.738645 (MainThread): Parsing macros/core.sql
2021-12-21 08:29:18.742580 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:29:18.750118 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:29:18.760592 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:29:18.762331 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:29:18.780826 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:29:18.818209 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:29:18.843460 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:29:18.845414 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:29:18.856161 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:29:18.877071 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:29:18.893782 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:29:18.902367 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:29:18.910326 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:29:18.914638 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:29:18.916284 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:29:18.917311 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:29:18.918879 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:29:18.928386 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:29:18.930436 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:29:18.932921 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:29:18.934508 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:29:18.994568 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:29:18.996387 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:29:18.997637 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:29:18.999040 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:29:19.190149 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:29:19.202331 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:29:19.236098 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:29:19.266125 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.268316 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.271377 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.273351 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.279483 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.282299 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:29:19.294374 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders

2021-12-21 08:29:19.305493 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f78b3eb3-d40f-41c0-85eb-97d50942a204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d422e0>]}
2021-12-21 08:29:19.315278 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:29:19.315811 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f78b3eb3-d40f-41c0-85eb-97d50942a204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d422b0>]}
2021-12-21 08:29:19.316106 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:29:19.316515 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:29:19.317703 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:29:19.325210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7e2b0>]}
2021-12-21 08:29:19.325685 (MainThread): Flushing usage events
2021-12-21 08:29:20.978859 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:31:53.652066 (MainThread): Running with dbt=0.21.0
2021-12-21 08:31:53.743525 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:31:53.744697 (MainThread): Tracking: tracking
2021-12-21 08:31:53.759068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f01b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f30520>]}
2021-12-21 08:31:53.771256 (MainThread): Partial parsing not enabled
2021-12-21 08:31:53.791786 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:31:53.797081 (MainThread): Parsing macros/relations.sql
2021-12-21 08:31:53.798788 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:31:53.824970 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:31:53.826920 (MainThread): Parsing macros/core.sql
2021-12-21 08:31:53.831119 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:31:53.838230 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:31:53.848567 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:31:53.850257 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:31:53.868923 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:31:53.903753 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:31:53.928794 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:31:53.932479 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:31:53.945429 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:31:53.967707 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:31:53.982903 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:31:53.991331 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:31:53.999276 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:31:54.003282 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:31:54.004777 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:31:54.005767 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:31:54.007271 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:31:54.016268 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:31:54.018090 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:31:54.020536 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:31:54.022128 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:31:54.082324 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:31:54.084206 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:31:54.085492 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:31:54.086940 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:31:54.276618 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:31:54.288940 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:31:54.322067 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:31:54.359999 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.362520 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.382081 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.384701 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.390039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.390423 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.392677 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.393046 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:31:54.405422 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.waresix_dbt.clean_transport_delivery_orders

2021-12-21 08:31:54.411319 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a057a50-579b-4c1c-aeb7-6c5f3e80741a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a820>]}
2021-12-21 08:31:54.417988 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:31:54.418517 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a057a50-579b-4c1c-aeb7-6c5f3e80741a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a670>]}
2021-12-21 08:31:54.418780 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-12-21 08:31:54.420012 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:31:54.425498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069335e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106933c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106933310>]}
2021-12-21 08:31:54.425818 (MainThread): Flushing usage events
2021-12-21 08:31:56.603181 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:32:15.264188 (MainThread): Running with dbt=0.21.0
2021-12-21 08:32:15.366682 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:32:15.368298 (MainThread): Tracking: tracking
2021-12-21 08:32:15.380773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112081af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112093520>]}
2021-12-21 08:32:15.393021 (MainThread): Partial parsing not enabled
2021-12-21 08:32:15.412958 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:32:15.417403 (MainThread): Parsing macros/relations.sql
2021-12-21 08:32:15.419009 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:32:15.444104 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:32:15.446041 (MainThread): Parsing macros/core.sql
2021-12-21 08:32:15.450155 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:32:15.457869 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:32:15.468134 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:32:15.469882 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:32:15.488547 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:32:15.525600 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:32:15.551215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:32:15.553426 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:32:15.564868 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:32:15.587294 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:32:15.602789 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:32:15.611637 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:32:15.619905 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:32:15.624407 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:32:15.626143 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:32:15.627390 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:32:15.629177 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:32:15.638908 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:32:15.641226 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:32:15.644030 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:32:15.645803 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:32:15.706463 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:32:15.708481 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:32:15.709869 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:32:15.711426 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:32:15.956536 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:32:15.971184 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:32:15.974988 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:32:16.033514 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.035794 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.051655 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.055403 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.060508 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.060832 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.062830 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.063130 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:16.079355 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '723dc48d-0254-4d22-995f-995cf31af1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112044a00>]}
2021-12-21 08:32:16.084975 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:32:16.085446 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '723dc48d-0254-4d22-995f-995cf31af1f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205e1f0>]}
2021-12-21 08:32:16.085783 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-12-21 08:32:16.087305 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:32:16.093337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112030c70>]}
2021-12-21 08:32:16.093883 (MainThread): Flushing usage events
2021-12-21 08:32:17.614999 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:32:49.870370 (MainThread): Running with dbt=0.21.0
2021-12-21 08:32:49.953545 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:32:49.954633 (MainThread): Tracking: tracking
2021-12-21 08:32:49.966966 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b592b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5aa580>]}
2021-12-21 08:32:49.979320 (MainThread): Partial parsing not enabled
2021-12-21 08:32:49.998849 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:32:50.003481 (MainThread): Parsing macros/relations.sql
2021-12-21 08:32:50.004992 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:32:50.029774 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:32:50.031641 (MainThread): Parsing macros/core.sql
2021-12-21 08:32:50.035757 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:32:50.043570 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:32:50.054302 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:32:50.056168 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:32:50.075680 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:32:50.111796 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:32:50.137220 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:32:50.139189 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:32:50.150759 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:32:50.172900 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:32:50.188390 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:32:50.197025 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:32:50.205088 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:32:50.209545 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:32:50.211234 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:32:50.212311 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:32:50.214023 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:32:50.223548 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:32:50.225549 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:32:50.228368 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:32:50.230616 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:32:50.291151 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:32:50.293235 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:32:50.294602 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:32:50.296102 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:32:50.501342 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:32:50.514538 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:32:50.542738 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:32:50.570392 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.572580 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.588685 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.590869 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.595568 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.595878 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.597736 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.598044 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:32:50.613628 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8eaac0f-52ae-4f0d-b1bb-e6ee4af75d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a38e0>]}
2021-12-21 08:32:50.618863 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:32:50.619490 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8eaac0f-52ae-4f0d-b1bb-e6ee4af75d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8a3a30>]}
2021-12-21 08:32:50.619765 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2021-12-21 08:32:50.621062 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:32:50.625990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a98e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acd8820>]}
2021-12-21 08:32:50.626234 (MainThread): Flushing usage events
2021-12-21 08:32:52.021324 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:33:33.861817 (MainThread): Running with dbt=0.21.0
2021-12-21 08:33:33.958322 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:33:33.959809 (MainThread): Tracking: tracking
2021-12-21 08:33:33.972726 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9e6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca06b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1f5e0>]}
2021-12-21 08:33:33.985205 (MainThread): Partial parsing not enabled
2021-12-21 08:33:34.004443 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:33:34.009407 (MainThread): Parsing macros/relations.sql
2021-12-21 08:33:34.010968 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:33:34.035293 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:33:34.037188 (MainThread): Parsing macros/core.sql
2021-12-21 08:33:34.041169 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:33:34.048493 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:33:34.058696 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:33:34.060357 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:33:34.078821 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:33:34.112686 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:33:34.137006 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:33:34.139016 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:33:34.149780 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:33:34.172027 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:33:34.187495 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:33:34.196051 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:33:34.203766 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:33:34.207763 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:33:34.209240 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:33:34.210405 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:33:34.212280 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:33:34.221968 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:33:34.223898 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:33:34.226459 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:33:34.228116 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:33:34.290506 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:33:34.292868 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:33:34.294455 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:33:34.296374 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:33:34.489389 (MainThread): 1699: statically parsed clean_partner/clean_partner_company_phones.sql
2021-12-21 08:33:34.489698 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:33:34.501194 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'af6bdaa2-9eba-42ea-9247-c2798c07087a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caf0190>]}
2021-12-21 08:33:34.502387 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:33:34.535027 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:33:34.566813 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:33:34.568715 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:33:34.576014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:33:34.577901 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:33:34.592979 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af6bdaa2-9eba-42ea-9247-c2798c07087a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb275e0>]}
2021-12-21 08:33:34.598988 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:33:34.599605 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af6bdaa2-9eba-42ea-9247-c2798c07087a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb1afd0>]}
2021-12-21 08:33:34.599957 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:33:34.600414 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:33:34.601675 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:33:34.607448 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb68b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb27d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb27910>]}
2021-12-21 08:33:34.608396 (MainThread): Flushing usage events
2021-12-21 08:33:36.248931 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:34:07.713176 (MainThread): Running with dbt=0.21.0
2021-12-21 08:34:07.787496 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:34:07.789449 (MainThread): Tracking: tracking
2021-12-21 08:34:07.801465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c40aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c421550>]}
2021-12-21 08:34:07.813125 (MainThread): Partial parsing not enabled
2021-12-21 08:34:07.826164 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:34:07.830544 (MainThread): Parsing macros/relations.sql
2021-12-21 08:34:07.832017 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:34:07.856821 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:34:07.858931 (MainThread): Parsing macros/core.sql
2021-12-21 08:34:07.862870 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:34:07.870855 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:34:07.881694 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:34:07.883532 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:34:07.903191 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:34:07.946665 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:34:07.974276 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:34:07.976386 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:34:07.987677 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:34:08.009065 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:34:08.023524 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:34:08.032129 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:34:08.039838 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:34:08.044336 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:34:08.047345 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:34:08.051204 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:34:08.052961 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:34:08.062045 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:34:08.063931 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:34:08.066497 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:34:08.068166 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:34:08.126406 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:34:08.128246 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:34:08.129460 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:34:08.130804 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:34:08.315103 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:34:08.327371 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:34:08.359698 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:34:08.390033 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:08.392164 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:08.396629 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:08.399694 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:08.412663 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ce7282-991e-44db-8af1-71808c04fd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52f7c0>]}
2021-12-21 08:34:08.418522 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:34:08.420055 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ce7282-991e-44db-8af1-71808c04fd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c51bfd0>]}
2021-12-21 08:34:08.420552 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:34:08.420996 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:34:08.422023 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:34:08.427519 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c52f6d0>]}
2021-12-21 08:34:08.427919 (MainThread): Flushing usage events
2021-12-21 08:34:09.885198 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:34:22.000354 (MainThread): Running with dbt=0.21.0
2021-12-21 08:34:22.081738 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:34:22.083087 (MainThread): Tracking: tracking
2021-12-21 08:34:22.094324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8b6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ec5e0>]}
2021-12-21 08:34:22.107146 (MainThread): Partial parsing not enabled
2021-12-21 08:34:22.119027 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:34:22.123267 (MainThread): Parsing macros/relations.sql
2021-12-21 08:34:22.124781 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:34:22.148801 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:34:22.150621 (MainThread): Parsing macros/core.sql
2021-12-21 08:34:22.155289 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:34:22.163481 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:34:22.175726 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:34:22.177835 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:34:22.199335 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:34:22.237350 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:34:22.262786 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:34:22.264749 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:34:22.276083 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:34:22.297663 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:34:22.313246 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:34:22.321621 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:34:22.329618 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:34:22.333708 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:34:22.335234 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:34:22.336334 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:34:22.338039 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:34:22.347207 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:34:22.349209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:34:22.351716 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:34:22.353334 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:34:22.411747 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:34:22.413635 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:34:22.414957 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:34:22.416350 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:34:22.606429 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:34:22.619859 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:34:22.651580 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:34:22.681111 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:22.683103 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:22.688104 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:22.691362 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:22.704715 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29d38f2b-cb6c-4187-8eec-ca857dbf3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f85b0>]}
2021-12-21 08:34:22.709861 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:34:22.710256 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29d38f2b-cb6c-4187-8eec-ca857dbf3090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f8b80>]}
2021-12-21 08:34:22.710669 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:34:22.711060 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:34:22.712078 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:34:22.718134 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f87c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f89a0>]}
2021-12-21 08:34:22.718727 (MainThread): Flushing usage events
2021-12-21 08:34:24.224610 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:34:35.552742 (MainThread): Running with dbt=0.21.0
2021-12-21 08:34:35.631405 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:34:35.633013 (MainThread): Tracking: tracking
2021-12-21 08:34:35.645622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aec7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b05bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1c610>]}
2021-12-21 08:34:35.657685 (MainThread): Partial parsing not enabled
2021-12-21 08:34:35.669320 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:34:35.672682 (MainThread): Parsing macros/relations.sql
2021-12-21 08:34:35.674172 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:34:35.699256 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:34:35.701106 (MainThread): Parsing macros/core.sql
2021-12-21 08:34:35.704978 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:34:35.712005 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:34:35.722342 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:34:35.724067 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:34:35.742458 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:34:35.777073 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:34:35.802725 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:34:35.804708 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:34:35.815951 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:34:35.837084 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:34:35.852441 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:34:35.860653 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:34:35.868331 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:34:35.872441 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:34:35.873940 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:34:35.874887 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:34:35.876563 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:34:35.885845 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:34:35.887735 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:34:35.890269 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:34:35.891953 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:34:35.950267 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:34:35.952045 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:34:35.953257 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:34:35.954615 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:34:36.144567 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:34:36.157436 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:34:36.160599 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:34:36.221014 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:36.223059 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:36.227567 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:36.229620 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:34:36.249245 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b35658a6-b9b0-4d18-b04a-0d77d6c48da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf38e0>]}
2021-12-21 08:34:36.256741 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:34:36.257297 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b35658a6-b9b0-4d18-b04a-0d77d6c48da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc40a0>]}
2021-12-21 08:34:36.257646 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:34:36.258116 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:34:36.259460 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:34:36.266085 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c703a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103526c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103526f40>]}
2021-12-21 08:34:36.266487 (MainThread): Flushing usage events
2021-12-21 08:34:37.738154 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:39:36.107771 (MainThread): Running with dbt=0.21.0
2021-12-21 08:39:36.201636 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:39:36.203350 (MainThread): Tracking: tracking
2021-12-21 08:39:36.218615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0eb520>]}
2021-12-21 08:39:36.230532 (MainThread): Partial parsing not enabled
2021-12-21 08:39:36.235772 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11bb80>]}
2021-12-21 08:39:36.236066 (MainThread): Flushing usage events
2021-12-21 08:39:37.983741 (MainThread): Encountered an error:
2021-12-21 08:39:37.984099 (MainThread): Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |       tests:
    8  |         - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14
2021-12-21 08:39:38.051175 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | sources:
  4  |   - name: clean_transport_delivery_orders
  5  |       columns:
  6  |         - name: id
  7  |       tests:
  8  |         - unique
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |       tests:
    8  |         - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14

2021-12-21 08:39:58.196455 (MainThread): Running with dbt=0.21.0
2021-12-21 08:39:58.271464 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:39:58.272745 (MainThread): Tracking: tracking
2021-12-21 08:39:58.282882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11054bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110581340>]}
2021-12-21 08:39:58.295039 (MainThread): Partial parsing not enabled
2021-12-21 08:39:58.298274 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11054bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b1d00>]}
2021-12-21 08:39:58.298510 (MainThread): Flushing usage events
2021-12-21 08:39:59.566883 (MainThread): Encountered an error:
2021-12-21 08:39:59.567333 (MainThread): Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |       tests:
    8  |         - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14
2021-12-21 08:39:59.638815 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   - name: clean_transport_delivery_orders
  5  |       columns:
  6  |         - name: id
  7  |       tests:
  8  |         - unique
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |       tests:
    8  |         - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14

2021-12-21 08:40:28.351989 (MainThread): Running with dbt=0.21.0
2021-12-21 08:40:28.467865 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:40:28.469184 (MainThread): Tracking: tracking
2021-12-21 08:40:28.483843 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e225be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e24ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e25e550>]}
2021-12-21 08:40:28.496267 (MainThread): Partial parsing not enabled
2021-12-21 08:40:28.501315 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e225be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28fbe0>]}
2021-12-21 08:40:28.501621 (MainThread): Flushing usage events
2021-12-21 08:40:29.615870 (MainThread): Encountered an error:
2021-12-21 08:40:29.616329 (MainThread): Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |           tests:
    8  |             - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14
2021-12-21 08:40:29.692154 (MainThread): Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/Library/Python/3.8/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Library/Python/3.8/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.scanner.ScannerError: mapping values are not allowed in this context
  in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Library/Python/3.8/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | 
  3  | models:
  4  |   - name: clean_transport_delivery_orders
  5  |       columns:
  6  |         - name: id
  7  |           tests:
  8  |             - unique
  
  Raw Error:
  ------------------------------
  mapping values are not allowed in this context
    in "<unicode string>", line 5, column 14

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Library/Python/3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 433, in run
    self._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 149, in _runtime_initialize
    super()._runtime_initialize()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 87, in _runtime_initialize
    self.load_manifest()
  File "/Library/Python/3.8/site-packages/dbt/task/runnable.py", line 74, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/Library/Python/3.8/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/Library/Python/3.8/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/Library/Python/3.8/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading waresix_dbt: clean_transport/schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name: clean_transport_delivery_orders
    5  |       columns:
    6  |         - name: id
    7  |           tests:
    8  |             - unique
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 14

2021-12-21 08:41:32.919265 (MainThread): Running with dbt=0.21.0
2021-12-21 08:41:33.036117 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:41:33.037316 (MainThread): Tracking: tracking
2021-12-21 08:41:33.049274 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107575ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107596ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ad520>]}
2021-12-21 08:41:33.061392 (MainThread): Partial parsing not enabled
2021-12-21 08:41:33.080597 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:41:33.086094 (MainThread): Parsing macros/relations.sql
2021-12-21 08:41:33.087616 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:41:33.111300 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:41:33.113111 (MainThread): Parsing macros/core.sql
2021-12-21 08:41:33.116982 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:41:33.124353 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:41:33.134863 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:41:33.136652 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:41:33.155103 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:41:33.190060 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:41:33.214598 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:41:33.216464 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:41:33.227387 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:41:33.248969 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:41:33.264034 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:41:33.272471 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:41:33.280298 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:41:33.284509 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:41:33.286068 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:41:33.287128 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:41:33.288675 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:41:33.297612 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:41:33.299437 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:41:33.301914 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:41:33.303674 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:41:33.361182 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:41:33.362946 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:41:33.364151 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:41:33.365582 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:41:33.550160 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:41:33.562012 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:41:33.594502 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:41:33.635140 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.638496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.642363 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.644798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.650790 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.652852 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:41:33.663128 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.clean_transport_delivery_orders

2021-12-21 08:41:33.669652 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '132035cc-f9ad-4e34-acc1-13e69abec215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076976d0>]}
2021-12-21 08:41:33.682054 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:41:33.685295 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '132035cc-f9ad-4e34-acc1-13e69abec215', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107697160>]}
2021-12-21 08:41:33.685785 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:41:33.686341 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:41:33.687933 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:41:33.695485 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cd370>]}
2021-12-21 08:41:33.695870 (MainThread): Flushing usage events
2021-12-21 08:41:35.832313 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:43:11.784017 (MainThread): Running with dbt=0.21.0
2021-12-21 08:43:11.888900 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean_transport'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:43:11.890465 (MainThread): Tracking: tracking
2021-12-21 08:43:11.904654 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdceac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdeaaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdfd4f0>]}
2021-12-21 08:43:11.917093 (MainThread): Partial parsing not enabled
2021-12-21 08:43:11.938249 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:43:11.943091 (MainThread): Parsing macros/relations.sql
2021-12-21 08:43:11.944579 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:43:11.968683 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:43:11.970779 (MainThread): Parsing macros/core.sql
2021-12-21 08:43:11.974783 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:43:11.981915 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:43:11.992452 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:43:11.994199 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:43:12.012582 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:43:12.046952 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:43:12.071782 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:43:12.073684 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:43:12.085019 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:43:12.106379 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:43:12.121179 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:43:12.129664 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:43:12.137280 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:43:12.142067 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:43:12.143891 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:43:12.144938 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:43:12.146454 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:43:12.155517 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:43:12.157405 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:43:12.160021 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:43:12.161895 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:43:12.220780 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:43:12.222579 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:43:12.223807 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:43:12.225179 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:43:12.414353 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:43:12.426954 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:43:12.460136 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:12.494563 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.497141 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.501072 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.503784 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.510465 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.513025 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:12.528940 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7f4fd26-54a1-48ce-be61-69ad4771f5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef8130>]}
2021-12-21 08:43:12.535578 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:43:12.536136 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7f4fd26-54a1-48ce-be61-69ad4771f5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef8220>]}
2021-12-21 08:43:12.536452 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:43:12.536885 (MainThread): The selection criterion 'tag:clean_transport' does not match any nodes
2021-12-21 08:43:12.538070 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:43:12.544496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff55fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe2d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe2d370>]}
2021-12-21 08:43:12.544826 (MainThread): Flushing usage events
2021-12-21 08:43:14.297288 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:43:21.816039 (MainThread): Running with dbt=0.21.0
2021-12-21 08:43:21.893436 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:stg'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:43:21.894515 (MainThread): Tracking: tracking
2021-12-21 08:43:21.904925 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c015b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c02b5e0>]}
2021-12-21 08:43:21.916847 (MainThread): Partial parsing not enabled
2021-12-21 08:43:21.928175 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:43:21.932562 (MainThread): Parsing macros/relations.sql
2021-12-21 08:43:21.934174 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:43:21.958756 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:43:21.960657 (MainThread): Parsing macros/core.sql
2021-12-21 08:43:21.964641 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:43:21.972037 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:43:21.982545 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:43:21.984352 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:43:22.004383 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:43:22.039327 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:43:22.063142 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:43:22.065105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:43:22.076249 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:43:22.097312 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:43:22.112007 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:43:22.120244 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:43:22.128593 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:43:22.132766 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:43:22.134296 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:43:22.135325 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:43:22.136893 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:43:22.146170 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:43:22.148089 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:43:22.150601 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:43:22.152218 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:43:22.210856 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:43:22.212675 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:43:22.213909 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:43:22.215332 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:43:22.403396 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:43:22.415613 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:43:22.449744 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:22.480653 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.482591 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.485386 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.487487 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.492419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.494131 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:43:22.507910 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91c9eb69-2093-4813-bc47-04510b288122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c128670>]}
2021-12-21 08:43:22.512916 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:43:22.513362 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91c9eb69-2093-4813-bc47-04510b288122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1287f0>]}
2021-12-21 08:43:22.513606 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:43:22.515388 (MainThread): 
2021-12-21 08:43:22.515899 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:43:22.516879 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 08:43:22.530348 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 08:43:22.530783 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 08:43:22.531117 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 08:43:23.284647 (ThreadPoolExecutor-0_0): SQL status: SELECT 189 in 0.75 seconds
2021-12-21 08:43:23.290590 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 08:43:23.292892 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:43:23.302761 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:43:23.302997 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 08:43:23.303160 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 08:43:23.614082 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.31 seconds
2021-12-21 08:43:23.614347 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:43:23.614489 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 08:43:23.655553 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 08:43:23.656904 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 08:43:23.693675 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 08:43:23.699237 (MainThread): Using postgres connection "master".
2021-12-21 08:43:23.699458 (MainThread): On master: BEGIN
2021-12-21 08:43:23.699594 (MainThread): Opening a new connection, currently in state init
2021-12-21 08:43:24.013818 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 08:43:24.014075 (MainThread): Using postgres connection "master".
2021-12-21 08:43:24.014196 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 08:43:24.076226 (MainThread): SQL status: SELECT 0 in 0.06 seconds
2021-12-21 08:43:24.077525 (MainThread): On master: ROLLBACK
2021-12-21 08:43:24.114224 (MainThread): Using postgres connection "master".
2021-12-21 08:43:24.114554 (MainThread): On master: BEGIN
2021-12-21 08:43:24.194446 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 08:43:24.194724 (MainThread): On master: COMMIT
2021-12-21 08:43:24.194859 (MainThread): Using postgres connection "master".
2021-12-21 08:43:24.194970 (MainThread): On master: COMMIT
2021-12-21 08:43:24.234161 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 08:43:24.234456 (MainThread): On master: Close
2021-12-21 08:43:24.234994 (MainThread): 15:43:24 | Concurrency: 1 threads (target='dev')
2021-12-21 08:43:24.235173 (MainThread): 15:43:24 | 
2021-12-21 08:43:24.238454 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:43:24.238813 (Thread-1): 15:43:24 | 1 of 1 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 08:43:24.239175 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:24.239362 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:43:24.241103 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 08:43:24.243243 (Thread-1): finished collecting timing info
2021-12-21 08:43:24.284267 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 08:43:24.285094 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:24.285454 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 08:43:24.285747 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:43:24.604201 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 08:43:24.604467 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:24.604590 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 08:43:24.973742 (Thread-1): SQL status: SELECT 62866 in 0.37 seconds
2021-12-21 08:43:24.980111 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:24.980324 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 08:43:25.024206 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 08:43:25.026697 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:25.026908 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 08:43:25.063813 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 08:43:25.074969 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 08:43:25.075205 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:25.075331 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 08:43:25.113759 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 08:43:25.118719 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:43:25.118919 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 08:43:25.163719 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 08:43:25.165083 (Thread-1): finished collecting timing info
2021-12-21 08:43:25.165325 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 08:43:25.165918 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c9eb69-2093-4813-bc47-04510b288122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c18c730>]}
2021-12-21 08:43:25.166276 (Thread-1): 15:43:25 | 1 of 1 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62866 in 0.93s]
2021-12-21 08:43:25.166446 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:43:25.167709 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:43:25.167941 (MainThread): Using postgres connection "master".
2021-12-21 08:43:25.168061 (MainThread): On master: BEGIN
2021-12-21 08:43:25.168169 (MainThread): Opening a new connection, currently in state closed
2021-12-21 08:43:25.483753 (MainThread): SQL status: BEGIN in 0.32 seconds
2021-12-21 08:43:25.483999 (MainThread): On master: COMMIT
2021-12-21 08:43:25.484129 (MainThread): Using postgres connection "master".
2021-12-21 08:43:25.484238 (MainThread): On master: COMMIT
2021-12-21 08:43:25.523822 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 08:43:25.524110 (MainThread): On master: Close
2021-12-21 08:43:25.524638 (MainThread): 15:43:25 | 
2021-12-21 08:43:25.524823 (MainThread): 15:43:25 | Finished running 1 table model in 3.01s.
2021-12-21 08:43:25.524978 (MainThread): Connection 'master' was properly closed.
2021-12-21 08:43:25.525095 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:43:25.530396 (MainThread): 
2021-12-21 08:43:25.530657 (MainThread): Completed successfully
2021-12-21 08:43:25.530849 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-12-21 08:43:25.531140 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c128f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c160d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1bff40>]}
2021-12-21 08:43:25.531447 (MainThread): Flushing usage events
2021-12-21 08:44:48.583591 (MainThread): Running with dbt=0.21.0
2021-12-21 08:44:48.686120 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:clean'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:44:48.687423 (MainThread): Tracking: tracking
2021-12-21 08:44:48.700568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba3bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba5fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba70610>]}
2021-12-21 08:44:48.712959 (MainThread): Partial parsing not enabled
2021-12-21 08:44:48.731816 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:44:48.736550 (MainThread): Parsing macros/relations.sql
2021-12-21 08:44:48.738015 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:44:48.761997 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:44:48.763801 (MainThread): Parsing macros/core.sql
2021-12-21 08:44:48.767852 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:44:48.775064 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:44:48.785076 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:44:48.786967 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:44:48.805699 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:44:48.841615 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:44:48.865919 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:44:48.867881 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:44:48.878413 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:44:48.900308 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:44:48.915307 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:44:48.923751 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:44:48.931275 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:44:48.935217 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:44:48.936695 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:44:48.937812 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:44:48.939344 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:44:48.948140 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:44:48.949921 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:44:48.952332 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:44:48.953896 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:44:49.013244 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:44:49.015094 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:44:49.016327 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:44:49.017701 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:44:49.203644 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:49.216100 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:49.249165 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:49.281013 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.282942 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.285811 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.287596 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.292276 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.293944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:44:49.308686 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee64b10a-d9b0-43e2-ac41-4b3d371e91f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb6c250>]}
2021-12-21 08:44:49.314492 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:44:49.315219 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee64b10a-d9b0-43e2-ac41-4b3d371e91f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb6c340>]}
2021-12-21 08:44:49.315513 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:44:49.317168 (MainThread): 
2021-12-21 08:44:49.317615 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:44:49.319026 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_pg_raw".
2021-12-21 08:44:49.343500 (ThreadPoolExecutor-0_0): Using postgres connection "list_pg_raw".
2021-12-21 08:44:49.343803 (ThreadPoolExecutor-0_0): On list_pg_raw: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw"} */

    select distinct nspname from pg_namespace
  
2021-12-21 08:44:49.343975 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-12-21 08:44:49.882541 (ThreadPoolExecutor-0_0): SQL status: SELECT 189 in 0.54 seconds
2021-12-21 08:44:49.888320 (ThreadPoolExecutor-0_0): On list_pg_raw: Close
2021-12-21 08:44:49.890763 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:44:49.900791 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:44:49.901037 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 08:44:49.901209 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-12-21 08:44:50.461690 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.56 seconds
2021-12-21 08:44:50.462255 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:44:50.462666 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 08:44:50.501097 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 08:44:50.502516 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 08:44:50.540967 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 08:44:50.546475 (MainThread): Using postgres connection "master".
2021-12-21 08:44:50.546826 (MainThread): On master: BEGIN
2021-12-21 08:44:50.547032 (MainThread): Opening a new connection, currently in state init
2021-12-21 08:44:50.861776 (MainThread): SQL status: BEGIN in 0.31 seconds
2021-12-21 08:44:50.862351 (MainThread): Using postgres connection "master".
2021-12-21 08:44:50.862864 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 08:44:50.901374 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 08:44:50.904657 (MainThread): On master: ROLLBACK
2021-12-21 08:44:50.941369 (MainThread): Using postgres connection "master".
2021-12-21 08:44:50.941930 (MainThread): On master: BEGIN
2021-12-21 08:44:51.021301 (MainThread): SQL status: BEGIN in 0.08 seconds
2021-12-21 08:44:51.021917 (MainThread): On master: COMMIT
2021-12-21 08:44:51.022317 (MainThread): Using postgres connection "master".
2021-12-21 08:44:51.022652 (MainThread): On master: COMMIT
2021-12-21 08:44:51.071157 (MainThread): SQL status: COMMIT in 0.05 seconds
2021-12-21 08:44:51.071764 (MainThread): On master: Close
2021-12-21 08:44:51.072903 (MainThread): 15:44:51 | Concurrency: 1 threads (target='dev')
2021-12-21 08:44:51.073371 (MainThread): 15:44:51 | 
2021-12-21 08:44:51.079687 (Thread-1): Began running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:44:51.080245 (Thread-1): 15:44:51 | 1 of 3 START table model dbt_dev.clean_odoo_purchase_order........... [RUN]
2021-12-21 08:44:51.080813 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:51.081160 (Thread-1): Compiling model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:44:51.085157 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 08:44:51.086651 (Thread-1): finished collecting timing info
2021-12-21 08:44:51.126341 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_odoo_purchase_order"
2021-12-21 08:44:51.127509 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:51.127781 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: BEGIN
2021-12-21 08:44:51.127983 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:44:51.451523 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 08:44:51.452098 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:51.452464 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */


  create  table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp"
  as (
    select
  raw_odoo.purchase_order.access_token ,
  raw_odoo.purchase_order.amount_tax ,
  raw_odoo.purchase_order.amount_total ,
  raw_odoo.purchase_order.amount_untaxed ,
  raw_odoo.purchase_order.analytic_account_id ,
  raw_odoo.purchase_order.can_create_dp ,
  raw_odoo.purchase_order.cancel_notes ,
  raw_odoo.purchase_order.client_order_ref ,
  raw_odoo.purchase_order.company_customer_pool_vehicle_id ,
  raw_odoo.purchase_order.company_id ,
  raw_odoo.purchase_order.company_pool_vehicle_id ,
  raw_odoo.purchase_order.create_date ,
  raw_odoo.purchase_order.create_uid ,
  raw_odoo.purchase_order.currency_id ,
  raw_odoo.purchase_order.currency_rate ,
  raw_odoo.purchase_order.cust_quotation_entry_id ,
  raw_odoo.purchase_order.cust_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.customer_req_id ,
  raw_odoo.purchase_order.date_approve ,
  raw_odoo.purchase_order.date_order ,
  raw_odoo.purchase_order.date_planned ,
  raw_odoo.purchase_order.delivery_orders_internal_id ,
  raw_odoo.purchase_order.delivery_orders_last_loc_id ,
  raw_odoo.purchase_order.dest_address_id ,
  raw_odoo.purchase_order.do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.do_rmb_internal_id ,
  raw_odoo.purchase_order.dp_id ,
  raw_odoo.purchase_order.dp_invoice_number ,
  raw_odoo.purchase_order.dp_state ,
  raw_odoo.purchase_order.dp_sync_date ,
  raw_odoo.purchase_order.extra_note ,
  raw_odoo.purchase_order.final_do_fee_summaries_internal_id ,
  raw_odoo.purchase_order.id ,
  raw_odoo.purchase_order.invoice_count ,
  raw_odoo.purchase_order.invoice_status ,
  raw_odoo.purchase_order.is_confirmed_to_vendor ,
  raw_odoo.purchase_order.is_dedicated ,
  raw_odoo.purchase_order.is_dp_requested ,
  raw_odoo.purchase_order.is_trade ,
  raw_odoo.purchase_order.item_quantity ,
  raw_odoo.purchase_order.license_plate ,
  raw_odoo.purchase_order.message_main_attachment_id ,
  raw_odoo.purchase_order.move_id ,
  raw_odoo.purchase_order.name ,
  raw_odoo.purchase_order.notes ,
  raw_odoo.purchase_order.order_ref ,
  raw_odoo.purchase_order.origin ,
  raw_odoo.purchase_order.partner_category ,
  raw_odoo.purchase_order.partner_id ,
  raw_odoo.purchase_order.partner_ref ,
  raw_odoo.purchase_order.payment_term_id ,
  raw_odoo.purchase_order.plate_color ,
  raw_odoo.purchase_order.processed_name ,
  raw_odoo.purchase_order.ready_to_bill ,
  raw_odoo.purchase_order.recurring_id ,
  raw_odoo.purchase_order.rev_move_id ,
  raw_odoo.purchase_order.sj_number ,
  raw_odoo.purchase_order.so_count ,
  raw_odoo.purchase_order.state ,
  raw_odoo.purchase_order.total_meter ,
  raw_odoo.purchase_order.user_id ,
  raw_odoo.purchase_order.vend_quotation_entry_id ,
  raw_odoo.purchase_order.vend_truck_rental_order_internal_id ,
  raw_odoo.purchase_order.volume ,
  raw_odoo.purchase_order.w6_crm_team_id ,
  raw_odoo.purchase_order.weight ,
  raw_odoo.purchase_order.write_date ,
  raw_odoo.purchase_order.write_uid 
from
  raw_odoo.purchase_order 
  inner join (
    select
      raw_odoo.purchase_order.id ,
      max(raw_odoo.purchase_order._sdc_extracted_at ) as earliest -- sdc_received_at
    from
      raw_odoo.purchase_order
    group by
      raw_odoo.purchase_order.id
  ) po_now on po_now.id = raw_odoo.purchase_order.id
  and po_now.earliest = raw_odoo.purchase_order._sdc_extracted_at  -- sdc_received_at
  );
2021-12-21 08:44:51.871275 (Thread-1): SQL status: SELECT 62866 in 0.42 seconds
2021-12-21 08:44:51.884307 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:51.884594 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order" rename to "clean_odoo_purchase_order__dbt_backup"
2021-12-21 08:44:52.461681 (Thread-1): SQL status: ALTER TABLE in 0.58 seconds
2021-12-21 08:44:52.464578 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:52.464775 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
alter table "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_tmp" rename to "clean_odoo_purchase_order"
2021-12-21 08:44:52.501388 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 08:44:52.520919 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 08:44:52.521282 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:52.521445 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: COMMIT
2021-12-21 08:44:52.561696 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-12-21 08:44:52.572419 (Thread-1): Using postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:44:52.572717 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_odoo_purchase_order"} */
drop table if exists "pg_raw"."dbt_dev"."clean_odoo_purchase_order__dbt_backup" cascade
2021-12-21 08:44:52.611413 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2021-12-21 08:44:52.620487 (Thread-1): finished collecting timing info
2021-12-21 08:44:52.620975 (Thread-1): On model.waresix_dbt.clean_odoo_purchase_order: Close
2021-12-21 08:44:52.623176 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee64b10a-d9b0-43e2-ac41-4b3d371e91f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbbceb0>]}
2021-12-21 08:44:52.624351 (Thread-1): 15:44:52 | 1 of 3 OK created table model dbt_dev.clean_odoo_purchase_order...... [SELECT 62866 in 1.54s]
2021-12-21 08:44:52.626128 (Thread-1): Finished running node model.waresix_dbt.clean_odoo_purchase_order
2021-12-21 08:44:52.626884 (Thread-1): Began running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 08:44:52.627592 (Thread-1): 15:44:52 | 2 of 3 START table model dbt_dev.clean_partner_company_phones........ [RUN]
2021-12-21 08:44:52.628329 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:52.628729 (Thread-1): Compiling model.waresix_dbt.clean_partner_company_phones
2021-12-21 08:44:52.632470 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 08:44:52.633832 (Thread-1): finished collecting timing info
2021-12-21 08:44:52.638351 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_partner_company_phones"
2021-12-21 08:44:52.639466 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:52.639794 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: BEGIN
2021-12-21 08:44:52.640032 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:44:52.876642 (Thread-1): SQL status: BEGIN in 0.24 seconds
2021-12-21 08:44:52.876975 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:52.877408 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */


  create  table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp"
  as (
    with cp as(
select
  raw_partner.company_phones.id ,
  raw_partner.company_phones.internal_id ,
  raw_partner.company_phones.company_id ,
  case when raw_partner.company_phones.phone  = '' then null
  when raw_partner.company_phones.phone  is null then null
	when raw_partner.company_phones.dial_code  = '021' then '+62'
	when raw_partner.company_phones.dial_code  = '' then '+62'
  when raw_partner.company_phones.dial_code  = '62' then '+62'
	else raw_partner.company_phones.dial_code  end as dial_code,
	case when raw_partner.company_phones.phone  = '' then null
	else raw_partner.company_phones.phone  end as phone,
  raw_partner.company_phones.is_primary ,
  raw_partner.company_phones.is_deleted ,
  raw_partner.company_phones.updated_at ,
  raw_partner.company_phones.updated_by ,
  row_number() over (partition by raw_partner.company_phones.company_id  order by raw_partner.company_phones.is_primary ,raw_partner.company_phones.updated_at  DESC) as row_index
from
  raw_partner.company_phones 
  inner join (
    select
      raw_partner.company_phones.id ,
      max(raw_partner.company_phones._sdc_extracted_at ) as earliest --sdc_received_at
    from
      raw_partner.company_phones
    group by
      raw_partner.company_phones.id
  ) partner_now on partner_now.id = raw_partner.company_phones.id
  and partner_now.earliest = raw_partner.company_phones._sdc_extracted_at ---sdc_received_at
where 1=1
--and raw_partner.company_phones.company_id  not in(
--    select dummy_accounts.id  from dummy_accounts
--  )
and raw_partner.company_phones.is_deleted  = false
)
select *
from cp
where cp.row_index=1
  );
2021-12-21 08:44:52.961125 (Thread-1): SQL status: SELECT 2816 in 0.08 seconds
2021-12-21 08:44:52.965962 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:52.966251 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones" rename to "clean_partner_company_phones__dbt_backup"
2021-12-21 08:44:52.991575 (Thread-1): SQL status: ALTER TABLE in 0.03 seconds
2021-12-21 08:44:52.994021 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:52.994205 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
alter table "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_tmp" rename to "clean_partner_company_phones"
2021-12-21 08:44:53.018633 (Thread-1): SQL status: ALTER TABLE in 0.02 seconds
2021-12-21 08:44:53.020182 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 08:44:53.020352 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:53.020491 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: COMMIT
2021-12-21 08:44:53.047329 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-12-21 08:44:53.051016 (Thread-1): Using postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:44:53.051353 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_partner_company_phones"} */
drop table if exists "pg_raw"."dbt_dev"."clean_partner_company_phones__dbt_backup" cascade
2021-12-21 08:44:53.082219 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-12-21 08:44:53.084552 (Thread-1): finished collecting timing info
2021-12-21 08:44:53.084922 (Thread-1): On model.waresix_dbt.clean_partner_company_phones: Close
2021-12-21 08:44:53.085844 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee64b10a-d9b0-43e2-ac41-4b3d371e91f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7bf40>]}
2021-12-21 08:44:53.086468 (Thread-1): 15:44:53 | 2 of 3 OK created table model dbt_dev.clean_partner_company_phones... [SELECT 2816 in 0.46s]
2021-12-21 08:44:53.086757 (Thread-1): Finished running node model.waresix_dbt.clean_partner_company_phones
2021-12-21 08:44:53.087043 (Thread-1): Began running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 08:44:53.087460 (Thread-1): 15:44:53 | 3 of 3 START table model dbt_dev.clean_transport_delivery_orders..... [RUN]
2021-12-21 08:44:53.088116 (Thread-1): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:53.088617 (Thread-1): Compiling model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 08:44:53.092028 (Thread-1): Writing injected SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 08:44:53.092900 (Thread-1): finished collecting timing info
2021-12-21 08:44:53.099642 (Thread-1): Writing runtime SQL for node "model.waresix_dbt.clean_transport_delivery_orders"
2021-12-21 08:44:53.100841 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:53.101033 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: BEGIN
2021-12-21 08:44:53.101193 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:44:53.383205 (Thread-1): SQL status: BEGIN in 0.28 seconds
2021-12-21 08:44:53.383770 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:53.384120 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */


  create  table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp"
  as (
    select
  rtdo.id ,
  rtdo.is_deleted,
  rtdo.internal_do_number,
  rtdo.delivery_price,
  rtdo.status,
  case
  when rtdo.status in (1, 3, 4, 5, 6, 7, 8, 16, 17, 18) then 'Preparation'
  when rtdo.status in (9, 10) then 'In Delivery'
  when rtdo.status in (11, 12, 13) then 'Unloading Process'
  when rtdo.status = 14 then 'Done'
  when rtdo.status in (2, 15) then 'Canceled'
  end as order_status_group,
  rtdo.created_at,
  rtdo.created_by,
  rtdo.customer_company_iid,
  rtdo.project_id,
  rtdo.vendor_company_iid,
  rtdo.from_customer_company_iid,
  rtdo.assign_driver_id,
  rtdo.assign_vehicle_id,
  rtdo.vehicle_model_id,
  rtdo.vehicle_load_id,
  rtdo.is_include_ppn,
  rtdo.item_description,
  rtdo.category,
  rtdo.item_quantity,
  rtdo.note,
  rtdo.accepted_at,
  rtdo.accepted_by,
  rtdo.assigned_at,
  rtdo.assigned_by,
  rtdo.done_at,
  rtdo.done_by,
  rtdo.price_agreement_id,
  rtdo.quotation_price_id,
  rtdo.quotation_entry_id,
  rtdo.driver_reject_reason,
  rtdo.cancel_reason,
  rtdo.cancel_reason_category,
  rtdo.is_dangerous_goods,
  rtdo.internal_id,
  rtdo.internal_number,
  rtdo.do_parent_id,
  rtdo.truck_rental_order_id,
  rtdo.total_meter,
  rtdo.request_type,
  rtdo.price_agreement_iid,
  rtdo.is_created_by_vendor,
  rtdo.is_request_dp,
  rtdo.assign_vendor_company_iid,
  rtdo.assign_group_company_iid,
  rtdo.is_consolidate,
  rtdo.pod_status,
  rtdo.pod_status_by,
  rtdo.pod_status_at,
  rtdo.volume,
  rtdo.weight,
  rtdo.canceled_by,
  rtdo.canceled_by_company_iid,
  rtdo.dp_due_days,
  rtdo.dp_percentage_quick_pay,
  rtdo.dp_disc,
  rtdo.payment_disc,
  rtdo.quick_pay_due_days,
  rtdo.vehicle_specification_note,
  rtdo.additional_location_price,
  rtdo.do_additional_info_id,
  rtdo.updated_at,
  rtdo.canceled_at
from
  raw_transport.delivery_orders rtdo
  inner join (
    select
      rtdo2.id ,
      max(rtdo2._sdc_extracted_at) as earliest --sdc_received_at
    from
      raw_transport.delivery_orders rtdo2
    group by
      rtdo2.id
  ) rtdo_now on rtdo_now.id = rtdo.id
  and rtdo_now.earliest = rtdo._sdc_extracted_at --sdc_received_at
where 1=1
  --and rtdo.created_by  not in (
  --  select
  --    dummy_users.users_internal_id
  --  from
  --    dummy_users
  --)
  and rtdo.id  not in (16711, 344036)
  and rtdo.from_customer_company_iid  not in (
    '740f279ca5e5fa4775d3317a3ee86d42f9ffe8338946bf5c2b3d35e15d5c1b31'
  )
  and rtdo.is_deleted  = false
  );
2021-12-21 08:44:59.211257 (Thread-1): SQL status: SELECT 389012 in 5.83 seconds
2021-12-21 08:44:59.217641 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:59.217970 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders" rename to "clean_transport_delivery_orders__dbt_backup"
2021-12-21 08:44:59.261670 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 08:44:59.269726 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:59.270079 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
alter table "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_tmp" rename to "clean_transport_delivery_orders"
2021-12-21 08:44:59.311029 (Thread-1): SQL status: ALTER TABLE in 0.04 seconds
2021-12-21 08:44:59.314483 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 08:44:59.314882 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:59.315218 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: COMMIT
2021-12-21 08:44:59.361284 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-12-21 08:44:59.365237 (Thread-1): Using postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:44:59.365618 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "model.waresix_dbt.clean_transport_delivery_orders"} */
drop table if exists "pg_raw"."dbt_dev"."clean_transport_delivery_orders__dbt_backup" cascade
2021-12-21 08:44:59.421059 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-12-21 08:44:59.424557 (Thread-1): finished collecting timing info
2021-12-21 08:44:59.425053 (Thread-1): On model.waresix_dbt.clean_transport_delivery_orders: Close
2021-12-21 08:44:59.426100 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee64b10a-d9b0-43e2-ac41-4b3d371e91f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcaa070>]}
2021-12-21 08:44:59.426721 (Thread-1): 15:44:59 | 3 of 3 OK created table model dbt_dev.clean_transport_delivery_orders [SELECT 389012 in 6.34s]
2021-12-21 08:44:59.427038 (Thread-1): Finished running node model.waresix_dbt.clean_transport_delivery_orders
2021-12-21 08:44:59.429004 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:44:59.429401 (MainThread): Using postgres connection "master".
2021-12-21 08:44:59.429645 (MainThread): On master: BEGIN
2021-12-21 08:44:59.429878 (MainThread): Opening a new connection, currently in state closed
2021-12-21 08:44:59.821353 (MainThread): SQL status: BEGIN in 0.39 seconds
2021-12-21 08:44:59.822046 (MainThread): On master: COMMIT
2021-12-21 08:44:59.822451 (MainThread): Using postgres connection "master".
2021-12-21 08:44:59.822791 (MainThread): On master: COMMIT
2021-12-21 08:44:59.861015 (MainThread): SQL status: COMMIT in 0.04 seconds
2021-12-21 08:44:59.861628 (MainThread): On master: Close
2021-12-21 08:44:59.862856 (MainThread): 15:44:59 | 
2021-12-21 08:44:59.863324 (MainThread): 15:44:59 | Finished running 3 table models in 10.55s.
2021-12-21 08:44:59.863719 (MainThread): Connection 'master' was properly closed.
2021-12-21 08:44:59.864053 (MainThread): Connection 'model.waresix_dbt.clean_transport_delivery_orders' was properly closed.
2021-12-21 08:44:59.874667 (MainThread): 
2021-12-21 08:44:59.875379 (MainThread): Completed successfully
2021-12-21 08:44:59.876134 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-12-21 08:44:59.877203 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc43250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc439a0>]}
2021-12-21 08:44:59.877788 (MainThread): Flushing usage events
2021-12-21 08:46:27.224074 (MainThread): Running with dbt=0.21.0
2021-12-21 08:46:27.339030 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:odoo'], selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-12-21 08:46:27.340282 (MainThread): Tracking: tracking
2021-12-21 08:46:27.353094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11027c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b15b0>]}
2021-12-21 08:46:27.365756 (MainThread): Partial parsing not enabled
2021-12-21 08:46:27.386051 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:46:27.391260 (MainThread): Parsing macros/relations.sql
2021-12-21 08:46:27.392735 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:46:27.416728 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:46:27.418479 (MainThread): Parsing macros/core.sql
2021-12-21 08:46:27.422453 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:46:27.429528 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:46:27.439957 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:46:27.441939 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:46:27.461420 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:46:27.497112 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:46:27.522184 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:46:27.524075 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:46:27.535007 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:46:27.555961 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:46:27.571783 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:46:27.580552 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:46:27.588334 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:46:27.592696 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:46:27.594273 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:46:27.595273 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:46:27.596949 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:46:27.606126 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:46:27.608008 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:46:27.610520 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:46:27.612198 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:46:27.670813 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:46:27.672625 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:46:27.673851 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:46:27.675240 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:46:27.867206 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:46:27.880079 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:46:27.914369 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:46:27.951217 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.953664 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.957166 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.959282 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.963756 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.965754 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:27.979585 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebbf1e78-7dc8-4f79-83d0-2b6777e12e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b0070>]}
2021-12-21 08:46:27.984471 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:46:27.984871 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebbf1e78-7dc8-4f79-83d0-2b6777e12e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b0220>]}
2021-12-21 08:46:27.985335 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:46:27.985932 (MainThread): The selection criterion 'tag:odoo' does not match any nodes
2021-12-21 08:46:27.987289 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2021-12-21 08:46:27.992647 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11040cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ca400>]}
2021-12-21 08:46:27.992989 (MainThread): Flushing usage events
2021-12-21 08:46:29.923878 (MainThread): Connection 'model.waresix_dbt.clean_odoo_purchase_order' was properly closed.
2021-12-21 08:46:52.578470 (MainThread): Running with dbt=0.21.0
2021-12-21 08:46:52.659821 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/Users/waresix/Documents/GitHub/data-dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=['tag:clean_odoo'], selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-12-21 08:46:52.660637 (MainThread): Tracking: tracking
2021-12-21 08:46:52.671325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11011b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110144b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015b580>]}
2021-12-21 08:46:52.683068 (MainThread): Partial parsing not enabled
2021-12-21 08:46:52.696688 (MainThread): Parsing macros/catalog.sql
2021-12-21 08:46:52.701787 (MainThread): Parsing macros/relations.sql
2021-12-21 08:46:52.703511 (MainThread): Parsing macros/adapters.sql
2021-12-21 08:46:52.733684 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-12-21 08:46:52.736029 (MainThread): Parsing macros/core.sql
2021-12-21 08:46:52.740754 (MainThread): Parsing macros/materializations/test.sql
2021-12-21 08:46:52.748735 (MainThread): Parsing macros/materializations/helpers.sql
2021-12-21 08:46:52.760678 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-12-21 08:46:52.762668 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-12-21 08:46:52.782770 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-12-21 08:46:52.817789 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-12-21 08:46:52.842050 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-12-21 08:46:52.843955 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-12-21 08:46:52.854834 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2021-12-21 08:46:52.875927 (MainThread): Parsing macros/materializations/common/merge.sql
2021-12-21 08:46:52.890560 (MainThread): Parsing macros/materializations/table/table.sql
2021-12-21 08:46:52.898506 (MainThread): Parsing macros/materializations/view/view.sql
2021-12-21 08:46:52.907050 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-12-21 08:46:52.911346 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-12-21 08:46:52.912918 (MainThread): Parsing macros/etc/query.sql
2021-12-21 08:46:52.913893 (MainThread): Parsing macros/etc/is_incremental.sql
2021-12-21 08:46:52.915598 (MainThread): Parsing macros/etc/datetime.sql
2021-12-21 08:46:52.924695 (MainThread): Parsing macros/etc/where_subquery.sql
2021-12-21 08:46:52.926607 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-12-21 08:46:52.929123 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-12-21 08:46:52.930708 (MainThread): Parsing macros/adapters/common.sql
2021-12-21 08:46:52.988883 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-12-21 08:46:52.990726 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-12-21 08:46:52.992007 (MainThread): Parsing macros/schema_tests/unique.sql
2021-12-21 08:46:52.993353 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-12-21 08:46:53.180663 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_partner_company_phones".
2021-12-21 08:46:53.193443 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_transport_delivery_orders".
2021-12-21 08:46:53.226437 (MainThread): Acquiring new postgres connection "model.waresix_dbt.clean_odoo_purchase_order".
2021-12-21 08:46:53.255928 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.257909 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.260902 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.262716 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.267057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.268840 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2021-12-21 08:46:53.283155 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e05b153a-3ad6-4b69-97f2-d3cd6a4d8ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102571f0>]}
2021-12-21 08:46:53.288325 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-12-21 08:46:53.288760 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e05b153a-3ad6-4b69-97f2-d3cd6a4d8ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110257580>]}
2021-12-21 08:46:53.289167 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-12-21 08:46:53.291069 (MainThread): 
2021-12-21 08:46:53.291481 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:46:53.292846 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:46:53.304653 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:46:53.304845 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: BEGIN
2021-12-21 08:46:53.304965 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-12-21 08:46:54.107276 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.80 seconds
2021-12-21 08:46:54.107844 (ThreadPoolExecutor-1_0): Using postgres connection "list_pg_raw_dbt_dev".
2021-12-21 08:46:54.108191 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "list_pg_raw_dbt_dev"} */
select
      'pg_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt_dev'
    union all
    select
      'pg_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt_dev'
  
2021-12-21 08:46:54.147352 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.04 seconds
2021-12-21 08:46:54.151309 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: ROLLBACK
2021-12-21 08:46:54.177875 (ThreadPoolExecutor-1_0): On list_pg_raw_dbt_dev: Close
2021-12-21 08:46:54.188239 (MainThread): Using postgres connection "master".
2021-12-21 08:46:54.188596 (MainThread): On master: BEGIN
2021-12-21 08:46:54.188892 (MainThread): Opening a new connection, currently in state init
2021-12-21 08:46:54.527289 (MainThread): SQL status: BEGIN in 0.34 seconds
2021-12-21 08:46:54.527854 (MainThread): Using postgres connection "master".
2021-12-21 08:46:54.528237 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-12-21 08:46:54.567143 (MainThread): SQL status: SELECT 0 in 0.04 seconds
2021-12-21 08:46:54.570351 (MainThread): On master: ROLLBACK
2021-12-21 08:46:54.607263 (MainThread): On master: Close
2021-12-21 08:46:54.608707 (MainThread): 15:46:54 | Concurrency: 1 threads (target='dev')
2021-12-21 08:46:54.609424 (MainThread): 15:46:54 | 
2021-12-21 08:46:54.614743 (Thread-1): Began running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 08:46:54.615233 (Thread-1): 15:46:54 | 1 of 2 START test not_null_clean_odoo_purchase_order_id.............. [RUN]
2021-12-21 08:46:54.615898 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 08:46:54.616242 (Thread-1): Compiling test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 08:46:54.636729 (Thread-1): Writing injected SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 08:46:54.637513 (Thread-1): finished collecting timing info
2021-12-21 08:46:54.663088 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"
2021-12-21 08:46:54.664596 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 08:46:54.664866 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: BEGIN
2021-12-21 08:46:54.665010 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:46:54.987773 (Thread-1): SQL status: BEGIN in 0.32 seconds
2021-12-21 08:46:54.988407 (Thread-1): Using postgres connection "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c".
2021-12-21 08:46:54.988804 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is null



      
    ) dbt_internal_test
2021-12-21 08:46:55.067685 (Thread-1): SQL status: SELECT 1 in 0.08 seconds
2021-12-21 08:46:55.073315 (Thread-1): finished collecting timing info
2021-12-21 08:46:55.073709 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: ROLLBACK
2021-12-21 08:46:55.117368 (Thread-1): On test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c: Close
2021-12-21 08:46:55.118831 (Thread-1): 15:46:55 | 1 of 2 PASS not_null_clean_odoo_purchase_order_id.................... [PASS in 0.50s]
2021-12-21 08:46:55.119323 (Thread-1): Finished running node test.waresix_dbt.not_null_clean_odoo_purchase_order_id.43c5bccf7c
2021-12-21 08:46:55.119795 (Thread-1): Began running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 08:46:55.120859 (Thread-1): 15:46:55 | 2 of 2 START test unique_clean_odoo_purchase_order_id................ [RUN]
2021-12-21 08:46:55.122005 (Thread-1): Acquiring new postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 08:46:55.122616 (Thread-1): Compiling test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 08:46:55.136663 (Thread-1): Writing injected SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 08:46:55.137407 (Thread-1): finished collecting timing info
2021-12-21 08:46:55.139492 (Thread-1): Writing runtime SQL for node "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"
2021-12-21 08:46:55.140153 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 08:46:55.140350 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: BEGIN
2021-12-21 08:46:55.140511 (Thread-1): Opening a new connection, currently in state closed
2021-12-21 08:46:55.467698 (Thread-1): SQL status: BEGIN in 0.33 seconds
2021-12-21 08:46:55.468258 (Thread-1): Using postgres connection "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4".
2021-12-21 08:46:55.468602 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: /* {"app": "dbt", "dbt_version": "0.21.0", "profile_name": "waresix_dbt", "target_name": "dev", "node_id": "test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "pg_raw"."dbt_dev"."clean_odoo_purchase_order"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2021-12-21 08:46:55.567170 (Thread-1): SQL status: SELECT 1 in 0.10 seconds
2021-12-21 08:46:55.571043 (Thread-1): finished collecting timing info
2021-12-21 08:46:55.571567 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: ROLLBACK
2021-12-21 08:46:55.607223 (Thread-1): On test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4: Close
2021-12-21 08:46:55.608826 (Thread-1): 15:46:55 | 2 of 2 PASS unique_clean_odoo_purchase_order_id...................... [PASS in 0.49s]
2021-12-21 08:46:55.609346 (Thread-1): Finished running node test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4
2021-12-21 08:46:55.612202 (MainThread): Acquiring new postgres connection "master".
2021-12-21 08:46:55.612917 (MainThread): 15:46:55 | 
2021-12-21 08:46:55.613262 (MainThread): 15:46:55 | Finished running 2 tests in 2.32s.
2021-12-21 08:46:55.613633 (MainThread): Connection 'master' was properly closed.
2021-12-21 08:46:55.613920 (MainThread): Connection 'test.waresix_dbt.unique_clean_odoo_purchase_order_id.98fa701ec4' was properly closed.
2021-12-21 08:46:55.624541 (MainThread): 
2021-12-21 08:46:55.625082 (MainThread): Completed successfully
2021-12-21 08:46:55.625533 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-12-21 08:46:55.625823 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110173490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101733a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb5ceb0>]}
2021-12-21 08:46:55.626215 (MainThread): Flushing usage events
